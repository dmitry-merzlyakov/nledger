<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<!-- 
Copyright (C) 2003-2018, John Wiegley.  All rights reserved.

Redistribution and use in source and binary forms, with or without
modification, are permitted provided that the following conditions are
met:


Redistributions of source code must retain the above copyright
notice, this list of conditions and the following disclaimer.

Redistributions in binary form must reproduce the above copyright
notice, this list of conditions and the following disclaimer in the
documentation and/or other materials provided with the distribution.

Neither the name of New Artisans LLC nor the names of its
contributors may be used to endorse or promote products derived from
this software without specific prior written permission.


THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
"AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 -->
<!-- Created by GNU Texinfo 5.2, http://www.gnu.org/software/texinfo/ -->
<head>
<title>Ledger: Command-Line Accounting</title>

<meta name="description" content="Ledger: Command-Line Accounting">
<meta name="keywords" content="Ledger: Command-Line Accounting">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="makeinfo">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<link href="#Top" rel="start" title="Top">
<link href="#Concepts-Index" rel="index" title="Concepts Index">
<link href="#SEC_Contents" rel="contents" title="Table of Contents">
<link href="dir.html#Top" rel="up" title="(dir)">
<style type="text/css">
<!--
a.summary-letter {text-decoration: none}
blockquote.smallquotation {font-size: smaller}
div.display {margin-left: 3.2em}
div.example {margin-left: 3.2em}
div.indentedblock {margin-left: 3.2em}
div.lisp {margin-left: 3.2em}
div.smalldisplay {margin-left: 3.2em}
div.smallexample {margin-left: 3.2em}
div.smallindentedblock {margin-left: 3.2em; font-size: smaller}
div.smalllisp {margin-left: 3.2em}
kbd {font-style:oblique}
pre.display {font-family: inherit}
pre.format {font-family: inherit}
pre.menu-comment {font-family: serif}
pre.menu-preformatted {font-family: serif}
pre.smalldisplay {font-family: inherit; font-size: smaller}
pre.smallexample {font-size: smaller}
pre.smallformat {font-family: inherit; font-size: smaller}
pre.smalllisp {font-size: smaller}
span.nocodebreak {white-space:nowrap}
span.nolinebreak {white-space:nowrap}
span.roman {font-family:serif; font-weight:normal}
span.sansserif {font-family:sans-serif; font-weight:normal}
ul.no-bullet {list-style: none}
-->
</style>


</head>

<body lang="en" bgcolor="#FFFFFF" text="#000000" link="#0000FF" vlink="#800080" alink="#FF0000">
<h1 class="settitle" align="center">Ledger: Command-Line Accounting</h1>













<a name="SEC_Contents"></a>
<h2 class="contents-heading">Table of Contents</h2>

<div class="contents">

<ul class="no-bullet">
  <li><a name="toc-Introduction-to-Ledger-1" href="#Introduction-to-Ledger">1 Introduction to Ledger</a>
  <ul class="no-bullet">
    <li><a name="toc-Fat_002dfree-Accounting-1" href="#Fat_002dfree-Accounting">1.1 Fat-free Accounting</a></li>
    <li><a name="toc-Building-the-program-1" href="#Building-the-program">1.2 Building the program</a></li>
    <li><a name="toc-Getting-help-1" href="#Getting-help">1.3 Getting help</a></li>
    <li><a name="toc-Third_002dParty-Ledger-Tutorials-1" href="#Third_002dParty-Ledger-Tutorials">1.4 Third-Party Ledger Tutorials</a></li>
  </ul></li>
  <li><a name="toc-Ledger-Tutorial-1" href="#Ledger-Tutorial">2 Ledger Tutorial</a>
  <ul class="no-bullet">
    <li><a name="toc-Start-a-Journal-File-1" href="#Start-a-Journal-File">2.1 Start a Journal File</a></li>
    <li><a name="toc-Run-a-Few-Reports-1" href="#Run-a-Few-Reports">2.2 Run a Few Reports</a>
    <ul class="no-bullet">
      <li><a name="toc-Balance-Report-1" href="#Balance-Report">2.2.1 Balance Report</a></li>
      <li><a name="toc-Register-Report-1" href="#Register-Report">2.2.2 Register Report</a></li>
      <li><a name="toc-Cleared-Report-1" href="#Cleared-Report">2.2.3 Cleared Report</a></li>
      <li><a name="toc-Using-the-Windows-Command_002dLine-1" href="#Using-the-Windows-Command_002dLine">2.2.4 Using the Windows Command-Line</a></li>
    </ul></li>
  </ul></li>
  <li><a name="toc-Principles-of-Accounting-with-Ledger-1" href="#Principles-of-Accounting-with-Ledger">3 Principles of Accounting with Ledger</a>
  <ul class="no-bullet">
    <li><a name="toc-Accounting-with-Ledger-1" href="#Accounting-with-Ledger">3.1 Accounting with Ledger</a></li>
    <li><a name="toc-Stating-where-money-goes-1" href="#Stating-where-money-goes">3.2 Stating where money goes</a></li>
    <li><a name="toc-Assets-and-Liabilities-1" href="#Assets-and-Liabilities">3.3 Assets and Liabilities</a>
    <ul class="no-bullet">
      <li><a name="toc-Tracking-reimbursable-expenses-1" href="#Tracking-reimbursable-expenses">3.3.1 Tracking reimbursable expenses</a></li>
    </ul></li>
    <li><a name="toc-Commodities-and-Currencies-1" href="#Commodities-and-Currencies">3.4 Commodities and Currencies</a>
    <ul class="no-bullet">
      <li><a name="toc-Commodity-price-histories-1" href="#Commodity-price-histories">3.4.1 Commodity price histories</a></li>
      <li><a name="toc-Commodity-equivalences-1" href="#Commodity-equivalences">3.4.2 Commodity equivalences</a></li>
    </ul></li>
    <li><a name="toc-Accounts-and-Inventories-1" href="#Accounts-and-Inventories">3.5 Accounts and Inventories</a></li>
    <li><a name="toc-Understanding-Equity-1" href="#Understanding-Equity">3.6 Understanding Equity</a></li>
    <li><a name="toc-Dealing-with-Petty-Cash-1" href="#Dealing-with-Petty-Cash">3.7 Dealing with Petty Cash</a></li>
    <li><a name="toc-Working-with-multiple-funds-and-accounts-1" href="#Working-with-multiple-funds-and-accounts">3.8 Working with multiple funds and accounts</a></li>
  </ul></li>
  <li><a name="toc-Keeping-a-Journal-1" href="#Keeping-a-Journal">4 Keeping a Journal</a>
  <ul class="no-bullet">
    <li><a name="toc-The-Most-Basic-Entry-1" href="#The-Most-Basic-Entry">4.1 The Most Basic Entry</a></li>
    <li><a name="toc-Starting-up-1" href="#Starting-up">4.2 Starting up</a></li>
    <li><a name="toc-Structuring-your-Accounts-1" href="#Structuring-your-Accounts">4.3 Structuring your Accounts</a></li>
    <li><a name="toc-Commenting-on-your-Journal-1" href="#Commenting-on-your-Journal">4.4 Commenting on your Journal</a></li>
    <li><a name="toc-Currency-and-Commodities-1" href="#Currency-and-Commodities">4.5 Currency and Commodities</a>
    <ul class="no-bullet">
      <li><a name="toc-Naming-Commodities-1" href="#Naming-Commodities">4.5.1 Naming Commodities</a></li>
      <li><a name="toc-Buying-and-Selling-Stock-1" href="#Buying-and-Selling-Stock">4.5.2 Buying and Selling Stock</a></li>
      <li><a name="toc-Fixing-Lot-Prices-1" href="#Fixing-Lot-Prices">4.5.3 Fixing Lot Prices</a></li>
      <li><a name="toc-Complete-control-over-commodity-pricing-1" href="#Complete-control-over-commodity-pricing">4.5.4 Complete control over commodity pricing</a></li>
    </ul></li>
    <li><a name="toc-Keeping-it-Consistent-1" href="#Keeping-it-Consistent">4.6 Keeping it Consistent</a></li>
    <li><a name="toc-Journal-Format-1" href="#Journal-Format">4.7 Journal Format</a>
    <ul class="no-bullet">
      <li><a name="toc-Transactions-and-Comments-1" href="#Transactions-and-Comments">4.7.1 Transactions and Comments</a></li>
      <li><a name="toc-Command-Directives-1" href="#Command-Directives">4.7.2 Command Directives</a></li>
    </ul></li>
    <li><a name="toc-Converting-from-other-formats-1" href="#Converting-from-other-formats">4.8 Converting from other formats</a></li>
    <li><a name="toc-Archiving-Previous-Years-1" href="#Archiving-Previous-Years">4.9 Archiving Previous Years</a></li>
  </ul></li>
  <li><a name="toc-Transactions-1" href="#Transactions">5 Transactions</a>
  <ul class="no-bullet">
    <li><a name="toc-Basic-format-1" href="#Basic-format">5.1 Basic format</a></li>
    <li><a name="toc-Eliding-amounts-1" href="#Eliding-amounts">5.2 Eliding amounts</a></li>
    <li><a name="toc-Auxiliary-dates-1" href="#Auxiliary-dates">5.3 Auxiliary dates</a></li>
    <li><a name="toc-Codes-1" href="#Codes">5.4 Codes</a></li>
    <li><a name="toc-Transaction-state-1" href="#Transaction-state">5.5 Transaction state</a></li>
    <li><a name="toc-Transaction-notes-1" href="#Transaction-notes">5.6 Transaction notes</a></li>
    <li><a name="toc-Metadata-1" href="#Metadata">5.7 Metadata</a>
    <ul class="no-bullet">
      <li><a name="toc-Metadata-tags-1" href="#Metadata-tags">5.7.1 Metadata tags</a>
      <ul class="no-bullet">
        <li><a name="toc-Payee-metadata-tag-1" href="#Payee-metadata-tag">5.7.1.1 Payee metadata tag</a></li>
      </ul></li>
      <li><a name="toc-Metadata-values-1" href="#Metadata-values">5.7.2 Metadata values</a></li>
      <li><a name="toc-Typed-metadata-1" href="#Typed-metadata">5.7.3 Typed metadata</a></li>
    </ul></li>
    <li><a name="toc-Virtual-postings-1" href="#Virtual-postings">5.8 Virtual postings</a></li>
    <li><a name="toc-Expression-amounts-1" href="#Expression-amounts">5.9 Expression amounts</a></li>
    <li><a name="toc-Balance-verification-1" href="#Balance-verification">5.10 Balance verification</a>
    <ul class="no-bullet">
      <li><a name="toc-Balance-assertions-1" href="#Balance-assertions">5.10.1 Balance assertions</a></li>
      <li><a name="toc-Balance-assignments-1" href="#Balance-assignments">5.10.2 Balance assignments</a></li>
      <li><a name="toc-Resetting-a-balance-1" href="#Resetting-a-balance">5.10.3 Resetting a balance</a></li>
      <li><a name="toc-Balancing-transactions-1" href="#Balancing-transactions">5.10.4 Balancing transactions</a></li>
    </ul></li>
    <li><a name="toc-Posting-cost-1" href="#Posting-cost">5.11 Posting cost</a></li>
    <li><a name="toc-Explicit-posting-costs-1" href="#Explicit-posting-costs">5.12 Explicit posting costs</a>
    <ul class="no-bullet">
      <li><a name="toc-Primary-and-secondary-commodities-1" href="#Primary-and-secondary-commodities">5.12.1 Primary and secondary commodities</a></li>
    </ul></li>
    <li><a name="toc-Posting-cost-expressions-1" href="#Posting-cost-expressions">5.13 Posting cost expressions</a></li>
    <li><a name="toc-Total-posting-costs-1" href="#Total-posting-costs">5.14 Total posting costs</a></li>
    <li><a name="toc-Virtual-posting-costs-1" href="#Virtual-posting-costs">5.15 Virtual posting costs</a></li>
    <li><a name="toc-Commodity-prices-1" href="#Commodity-prices">5.16 Commodity prices</a>
    <ul class="no-bullet">
      <li><a name="toc-Total-commodity-prices-1" href="#Total-commodity-prices">5.16.1 Total commodity prices</a></li>
    </ul></li>
    <li><a name="toc-Prices-versus-costs-1" href="#Prices-versus-costs">5.17 Prices versus costs</a></li>
    <li><a name="toc-Fixated-prices-and-costs-1" href="#Fixated-prices-and-costs">5.18 Fixated prices and costs</a></li>
    <li><a name="toc-Lot-dates-1" href="#Lot-dates">5.19 Lot dates</a></li>
    <li><a name="toc-Lot-notes-1" href="#Lot-notes">5.20 Lot notes</a></li>
    <li><a name="toc-Lot-value-expressions-1" href="#Lot-value-expressions">5.21 Lot value expressions</a></li>
    <li><a name="toc-Automated-Transactions-1" href="#Automated-Transactions">5.22 Automated Transactions</a>
    <ul class="no-bullet">
      <li><a name="toc-Amount-multipliers-1" href="#Amount-multipliers">5.22.1 Amount multipliers</a></li>
      <li><a name="toc-Accessing-the-matching-posting_0027s-amount-1" href="#Accessing-the-matching-posting_0027s-amount">5.22.2 Accessing the matching posting&rsquo;s amount</a></li>
      <li><a name="toc-Referring-to-the-matching-posting_0027s-account-1" href="#Referring-to-the-matching-posting_0027s-account">5.22.3 Referring to the matching posting&rsquo;s account</a></li>
      <li><a name="toc-Applying-metadata-to-every-matched-posting-1" href="#Applying-metadata-to-every-matched-posting">5.22.4 Applying metadata to every matched posting</a></li>
      <li><a name="toc-Applying-metadata-to-the-generated-posting-1" href="#Applying-metadata-to-the-generated-posting">5.22.5 Applying metadata to the generated posting</a></li>
      <li><a name="toc-State-flags-1" href="#State-flags">5.22.6 State flags</a></li>
      <li><a name="toc-Effective-Dates-1" href="#Effective-Dates">5.22.7 Effective Dates</a></li>
      <li><a name="toc-Periodic-Transactions-1" href="#Periodic-Transactions">5.22.8 Periodic Transactions</a></li>
      <li><a name="toc-Concrete-Example-of-Automated-Transactions-1" href="#Concrete-Example-of-Automated-Transactions">5.22.9 Concrete Example of Automated Transactions</a></li>
    </ul></li>
  </ul></li>
  <li><a name="toc-Building-Reports-1" href="#Building-Reports">6 Building Reports</a>
  <ul class="no-bullet">
    <li><a name="toc-Introduction-1" href="#Introduction">6.1 Introduction</a></li>
    <li><a name="toc-Balance-Reports-1" href="#Balance-Reports">6.2 Balance Reports</a>
    <ul class="no-bullet">
      <li><a name="toc-Controlling-the-Accounts-and-Payees-1" href="#Controlling-the-Accounts-and-Payees">6.2.1 Controlling the Accounts and Payees</a></li>
      <li><a name="toc-Controlling-Formatting-1" href="#Controlling-Formatting">6.2.2 Controlling Formatting</a></li>
    </ul></li>
    <li><a name="toc-Typical-queries-1" href="#Typical-queries">6.3 Typical queries</a>
    <ul class="no-bullet">
      <li><a name="toc-Reporting-monthly-expenses-1" href="#Reporting-monthly-expenses">6.3.1 Reporting monthly expenses</a></li>
    </ul></li>
    <li><a name="toc-Advanced-Reports-1" href="#Advanced-Reports">6.4 Advanced Reports</a>
    <ul class="no-bullet">
      <li><a name="toc-Asset-Allocation-1" href="#Asset-Allocation">6.4.1 Asset Allocation</a></li>
      <li><a name="toc-Visualizing-with-Gnuplot-1" href="#Visualizing-with-Gnuplot">6.4.2 Visualizing with Gnuplot</a></li>
    </ul></li>
  </ul></li>
  <li><a name="toc-Reporting-Commands-1" href="#Reporting-Commands">7 Reporting Commands</a>
  <ul class="no-bullet">
    <li><a name="toc-Primary-Financial-Reports-1" href="#Primary-Financial-Reports">7.1 Primary Financial Reports</a>
    <ul class="no-bullet">
      <li><a name="toc-The-balance-command-1" href="#The-balance-command">7.1.1 The <code>balance</code> command</a></li>
      <li><a name="toc-The-equity-command-1" href="#The-equity-command">7.1.2 The <code>equity</code> command</a></li>
      <li><a name="toc-The-register-command-1" href="#The-register-command">7.1.3 The <code>register</code> command</a></li>
      <li><a name="toc-The-print-command-1" href="#The-print-command">7.1.4 The <code>print</code> command</a></li>
    </ul></li>
    <li><a name="toc-Reports-in-other-Formats-1" href="#Reports-in-other-Formats">7.2 Reports in other Formats</a>
    <ul class="no-bullet">
      <li><a name="toc-Comma-Separated-Values-files-1" href="#Comma-Separated-Values-files">7.2.1 Comma Separated Values files</a>
      <ul class="no-bullet">
        <li><a name="toc-The-csv-command-1" href="#The-csv-command">7.2.1.1 The <code>csv</code> command</a></li>
        <li><a name="toc-The-convert-command-1" href="#The-convert-command">7.2.1.2 The <code>convert</code> command</a></li>
      </ul></li>
      <li><a name="toc-The-lisp-command-1" href="#The-lisp-command">7.2.2 The <code>lisp</code> command</a></li>
      <li><a name="toc-Emacs-org-Mode-1" href="#Emacs-org-Mode">7.2.3 Emacs <code>org</code> Mode</a></li>
      <li><a name="toc-Org-mode-with-Babel-1" href="#Org-mode-with-Babel">7.2.4 Org mode with Babel</a>
      <ul class="no-bullet">
        <li><a name="toc-Embedded-Ledger-example-with-single-source-block-1" href="#Embedded-Ledger-example-with-single-source-block">7.2.4.1 Embedded Ledger example with single source block</a></li>
        <li><a name="toc-Multiple-Ledger-source-blocks-with-noweb-1" href="#Multiple-Ledger-source-blocks-with-noweb">7.2.4.2 Multiple Ledger source blocks with <code>noweb</code></a></li>
        <li><a name="toc-Income-Entries-1" href="#Income-Entries">7.2.4.3 Income Entries</a></li>
        <li><a name="toc-Expenses-1" href="#Expenses">7.2.4.4 Expenses</a></li>
        <li><a name="toc-Financial-Summaries-1" href="#Financial-Summaries">7.2.4.5 Financial Summaries</a></li>
        <li><a name="toc-An-overall-balance-summary-1" href="#An-overall-balance-summary">7.2.4.6 An overall balance summary</a></li>
        <li><a name="toc-Generating-a-monthly-register-1" href="#Generating-a-monthly-register">7.2.4.7 Generating a monthly register</a></li>
        <li><a name="toc-Summary-1" href="#Summary">7.2.4.8 Summary</a></li>
      </ul></li>
      <li><a name="toc-The-pricemap-command-1" href="#The-pricemap-command">7.2.5 The <code>pricemap</code> command</a></li>
      <li><a name="toc-The-xml-command-1" href="#The-xml-command">7.2.6 The <code>xml</code> command</a></li>
      <li><a name="toc-prices-and-pricedb-commands-1" href="#prices-and-pricedb-commands">7.2.7 <code>prices</code> and <code>pricedb</code> commands</a></li>
    </ul></li>
    <li><a name="toc-Reports-about-your-Journals-1" href="#Reports-about-your-Journals">7.3 Reports about your Journals</a>
    <ul class="no-bullet">
      <li><a name="toc-accounts-1" href="#accounts">7.3.1 <code>accounts</code></a></li>
      <li><a name="toc-payees-1" href="#payees">7.3.2 <code>payees</code></a></li>
      <li><a name="toc-commodities-1" href="#commodities">7.3.3 <code>commodities</code></a></li>
      <li><a name="toc-tags-1" href="#tags">7.3.4 <code>tags</code></a></li>
      <li><a name="toc-xact-1" href="#xact">7.3.5 <code>xact</code></a></li>
      <li><a name="toc-stats-1" href="#stats">7.3.6 <code>stats</code></a></li>
      <li><a name="toc-select-1" href="#select">7.3.7 <code>select</code></a></li>
    </ul></li>
  </ul></li>
  <li><a name="toc-Command_002dLine-Syntax-1" href="#Command_002dLine-Syntax">8 Command-Line Syntax</a>
  <ul class="no-bullet">
    <li><a name="toc-Basic-Usage-1" href="#Basic-Usage">8.1 Basic Usage</a></li>
    <li><a name="toc-Command_002dLine-Quick-Reference-1" href="#Command_002dLine-Quick-Reference">8.2 Command-Line Quick Reference</a>
    <ul class="no-bullet">
      <li><a name="toc-Basic-Reporting-Commands-1" href="#Basic-Reporting-Commands">8.2.1 Basic Reporting Commands</a></li>
      <li><a name="toc-Basic-Options-1" href="#Basic-Options">8.2.2 Basic Options</a></li>
      <li><a name="toc-Report-Filtering-1" href="#Report-Filtering">8.2.3 Report Filtering</a></li>
      <li><a name="toc-Error-Checking-and-Calculation-Options-1" href="#Error-Checking-and-Calculation-Options">8.2.4 Error Checking and Calculation Options</a></li>
      <li><a name="toc-Output-Customization-1" href="#Output-Customization">8.2.5 Output Customization</a></li>
      <li><a name="toc-Grouping-Options-1" href="#Grouping-Options">8.2.6 Grouping Options</a></li>
      <li><a name="toc-Commodity-Reporting-1" href="#Commodity-Reporting">8.2.7 Commodity Reporting</a></li>
    </ul></li>
    <li><a name="toc-Detailed-Option-Description-1" href="#Detailed-Option-Description">8.3 Detailed Option Description</a>
    <ul class="no-bullet">
      <li><a name="toc-Global-Options-1" href="#Global-Options">8.3.1 Global Options</a></li>
      <li><a name="toc-Session-Options-1" href="#Session-Options">8.3.2 Session Options</a></li>
      <li><a name="toc-Report-Options-1" href="#Report-Options">8.3.3 Report Options</a></li>
      <li><a name="toc-Basic-options-1" href="#Basic-options">8.3.4 Basic options</a></li>
      <li><a name="toc-Report-filtering-1" href="#Report-filtering">8.3.5 Report filtering</a></li>
      <li><a name="toc-Output-customization-1" href="#Output-customization">8.3.6 Output customization</a></li>
      <li><a name="toc-Commodity-reporting-1" href="#Commodity-reporting">8.3.7 Commodity reporting</a></li>
      <li><a name="toc-Environment-variables-1" href="#Environment-variables">8.3.8 Environment variables</a></li>
    </ul></li>
    <li><a name="toc-Period-Expressions-1" href="#Period-Expressions">8.4 Period Expressions</a></li>
  </ul></li>
  <li><a name="toc-Budgeting-and-Forecasting-1" href="#Budgeting-and-Forecasting">9 Budgeting and Forecasting</a>
  <ul class="no-bullet">
    <li><a name="toc-Budgeting-1" href="#Budgeting">9.1 Budgeting</a></li>
    <li><a name="toc-Forecasting-1" href="#Forecasting">9.2 Forecasting</a></li>
  </ul></li>
  <li><a name="toc-Time-Keeping-1" href="#Time-Keeping">10 Time Keeping</a></li>
  <li><a name="toc-Value-Expressions-1" href="#Value-Expressions">11 Value Expressions</a>
  <ul class="no-bullet">
    <li><a name="toc-Variables-1" href="#Variables">11.1 Variables</a>
    <ul class="no-bullet">
      <li><a name="toc-Posting_002faccount-details-1" href="#Posting_002faccount-details">11.1.1 Posting/account details</a></li>
      <li><a name="toc-Calculated-totals-1" href="#Calculated-totals">11.1.2 Calculated totals</a></li>
    </ul></li>
    <li><a name="toc-Functions-1" href="#Functions">11.2 Functions</a></li>
    <li><a name="toc-Operators-1" href="#Operators">11.3 Operators</a>
    <ul class="no-bullet">
      <li><a name="toc-Unary-Operators-1" href="#Unary-Operators">11.3.1 Unary Operators</a></li>
      <li><a name="toc-Binary-Operators-1" href="#Binary-Operators">11.3.2 Binary Operators</a></li>
    </ul></li>
    <li><a name="toc-Complex-expressions-1" href="#Complex-expressions">11.4 Complex expressions</a>
    <ul class="no-bullet">
      <li><a name="toc-Miscellaneous-1" href="#Miscellaneous">11.4.1 Miscellaneous</a></li>
    </ul></li>
  </ul></li>
  <li><a name="toc-Format-Strings-1" href="#Format-Strings">12 Format Strings</a>
  <ul class="no-bullet">
    <li><a name="toc-Format-String-Basics-1" href="#Format-String-Basics">12.1 Format String Basics</a></li>
    <li><a name="toc-Format-String-Structure-1" href="#Format-String-Structure">12.2 Format String Structure</a></li>
    <li><a name="toc-Format-Expressions-1" href="#Format-Expressions">12.3 Format Expressions</a></li>
    <li><a name="toc-Balance-format-1" href="#Balance-format">12.4 Balance format</a></li>
    <li><a name="toc-Formatting-Functions-and-Codes-1" href="#Formatting-Functions-and-Codes">12.5 Formatting Functions and Codes</a>
    <ul class="no-bullet">
      <li><a name="toc-Field-Widths-1" href="#Field-Widths">12.5.1 Field Widths</a></li>
      <li><a name="toc-Colors-1" href="#Colors">12.5.2 Colors</a></li>
      <li><a name="toc-Quantities-and-Calculations-1" href="#Quantities-and-Calculations">12.5.3 Quantities and Calculations</a></li>
      <li><a name="toc-Date-Functions-1" href="#Date-Functions">12.5.4 Date Functions</a></li>
      <li><a name="toc-Date-and-Time-Format-Codes-1" href="#Date-and-Time-Format-Codes">12.5.5 Date and Time Format Codes</a>
      <ul class="no-bullet">
        <li><a name="toc-Days-1" href="#Days">12.5.5.1 Days</a></li>
        <li><a name="toc-Weekdays-1" href="#Weekdays">12.5.5.2 Weekdays</a></li>
        <li><a name="toc-Month-1" href="#Month">12.5.5.3 Month</a></li>
        <li><a name="toc-Miscellaneous-Date-Codes-1" href="#Miscellaneous-Date-Codes">12.5.5.4 Miscellaneous Date Codes</a></li>
      </ul></li>
      <li><a name="toc-Text-Formatting-1" href="#Text-Formatting">12.5.6 Text Formatting</a></li>
      <li><a name="toc-Data-File-Parsing-Information-1" href="#Data-File-Parsing-Information">12.5.7 Data File Parsing Information</a></li>
    </ul></li>
  </ul></li>
  <li><a name="toc-Extending-with-Python-1" href="#Extending-with-Python">13 Extending with Python</a>
  <ul class="no-bullet">
    <li><a name="toc-Basic-data-traversal-1" href="#Basic-data-traversal">13.1 Basic data traversal</a></li>
    <li><a name="toc-Raw-versus-Cooked-1" href="#Raw-versus-Cooked">13.2 Raw versus Cooked</a></li>
    <li><a name="toc-Queries-1" href="#Queries">13.3 Queries</a></li>
    <li><a name="toc-Embedded-Python-1" href="#Embedded-Python">13.4 Embedded Python</a></li>
    <li><a name="toc-Amounts-1" href="#Amounts">13.5 Amounts</a></li>
  </ul></li>
  <li><a name="toc-Ledger-for-Developers-1" href="#Ledger-for-Developers">14 Ledger for Developers</a>
  <ul class="no-bullet">
    <li><a name="toc-Internal-Design-1" href="#Internal-Design">14.1 Internal Design</a></li>
    <li><a name="toc-Journal-File-Format-for-Developers-1" href="#Journal-File-Format-for-Developers">14.2 Journal File Format for Developers</a>
    <ul class="no-bullet">
      <li><a name="toc-Comments-and-meta_002ddata-1" href="#Comments-and-meta_002ddata">14.2.1 Comments and meta-data</a></li>
      <li><a name="toc-Specifying-Amounts-1" href="#Specifying-Amounts">14.2.2 Specifying Amounts</a>
      <ul class="no-bullet">
        <li><a name="toc-Integer-Amounts-1" href="#Integer-Amounts">14.2.2.1 Integer Amounts</a></li>
        <li><a name="toc-Commoditized-Amounts-1" href="#Commoditized-Amounts">14.2.2.2 Commoditized Amounts</a></li>
      </ul></li>
      <li><a name="toc-Posting-costs-1" href="#Posting-costs">14.2.3 Posting costs</a></li>
      <li><a name="toc-Primary-commodities-1" href="#Primary-commodities">14.2.4 Primary commodities</a></li>
    </ul></li>
    <li><a name="toc-Developer-Commands-1" href="#Developer-Commands">14.3 Developer Commands</a>
    <ul class="no-bullet">
      <li><a name="toc-echo-1" href="#echo">14.3.1 <code>echo</code></a></li>
      <li><a name="toc-reload-1" href="#reload">14.3.2 <code>reload</code></a></li>
      <li><a name="toc-source-1" href="#source">14.3.3 <code>source</code></a></li>
      <li><a name="toc-Debug-Options-1" href="#Debug-Options">14.3.4 Debug Options</a></li>
      <li><a name="toc-Pre_002dCommands-1" href="#Pre_002dCommands">14.3.5 Pre-Commands</a></li>
    </ul></li>
    <li><a name="toc-Ledger-Development-Environment-1" href="#Ledger-Development-Environment">14.4 Ledger Development Environment</a>
    <ul class="no-bullet">
      <li><a name="toc-acprep-build-configuration-tool-1" href="#acprep-build-configuration-tool">14.4.1 <samp>acprep</samp> build configuration tool</a></li>
      <li><a name="toc-Testing-Framework-1" href="#Testing-Framework">14.4.2 Testing Framework</a>
      <ul class="no-bullet">
        <li><a name="toc-Running-Tests-1" href="#Running-Tests">14.4.2.1 Running Tests</a></li>
        <li><a name="toc-Writing-Tests-1" href="#Writing-Tests">14.4.2.2 Writing Tests</a></li>
      </ul></li>
    </ul></li>
  </ul></li>
  <li><a name="toc-Major-Changes-from-version-2_002e6-1" href="#Major-Changes-from-version-2_002e6">15 Major Changes from version 2.6</a></li>
  <li><a name="toc-Example-Journal-File-1" href="#Example-Journal-File">Appendix A Example Journal File</a></li>
  <li><a name="toc-Miscellaneous-Notes-1" href="#Miscellaneous-Notes">Appendix B Miscellaneous Notes</a>
  <ul class="no-bullet">
    <li><a name="toc-Cookbook-1" href="#Cookbook">B.1 Cookbook</a>
    <ul class="no-bullet">
      <li><a name="toc-Invoking-Ledger-1" href="#Invoking-Ledger">B.1.1 Invoking Ledger</a></li>
      <li><a name="toc-Ledger-Files-1" href="#Ledger-Files">B.1.2 Ledger Files</a></li>
    </ul></li>
  </ul></li>
  <li><a name="toc-Concepts-Index-1" href="#Concepts-Index">Concepts Index</a></li>
  <li><a name="toc-Commands-_0026-Options-Index-1" href="#Commands-_0026-Options-Index">Commands &amp; Options Index</a></li>
</ul>
</div>



<a name="Top"></a>
<div class="header">
<p>
Next: <a href="#Introduction-to-Ledger" accesskey="n" rel="next">Introduction to Ledger</a>, Previous: <a href="dir.html#Top" accesskey="p" rel="prev">(dir)</a>, Up: <a href="dir.html#Top" accesskey="u" rel="up">(dir)</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Overview"></a>
<h1 class="top">Overview</h1>

<p>Ledger is a command-line accounting tool that provides double-entry
accounting based on a text journal.  It provides no bells or whistles,
and returns the user to the days before user interfaces were even a
twinkling in their fathers&rsquo; CRTs.
</p>

<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top">&bull; <a href="#Introduction-to-Ledger" accesskey="1">Introduction to Ledger</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Ledger-Tutorial" accesskey="2">Ledger Tutorial</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Principles-of-Accounting-with-Ledger" accesskey="3">Principles of Accounting with Ledger</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Keeping-a-Journal" accesskey="4">Keeping a Journal</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Transactions" accesskey="5">Transactions</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Building-Reports" accesskey="6">Building Reports</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Reporting-Commands" accesskey="7">Reporting Commands</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Command_002dLine-Syntax" accesskey="8">Command-Line Syntax</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Budgeting-and-Forecasting" accesskey="9">Budgeting and Forecasting</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Time-Keeping">Time Keeping</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Value-Expressions">Value Expressions</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Format-Strings">Format Strings</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Extending-with-Python">Extending with Python</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Ledger-for-Developers">Ledger for Developers</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Major-Changes-from-version-2_002e6">Major Changes from version 2.6</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Example-Journal-File">Example Journal File</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Miscellaneous-Notes">Miscellaneous Notes</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Concepts-Index">Concepts Index</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Commands-_0026-Options-Index">Commands &amp; Options Index</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
</table>

<hr>
<a name="Introduction-to-Ledger"></a>
<div class="header">
<p>
Next: <a href="#Ledger-Tutorial" accesskey="n" rel="next">Ledger Tutorial</a>, Previous: <a href="#Top" accesskey="p" rel="prev">Top</a>, Up: <a href="#Top" accesskey="u" rel="up">Top</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Introduction-to-Ledger-1"></a>
<h2 class="chapter">1 Introduction to Ledger</h2>

<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top">&bull; <a href="#Fat_002dfree-Accounting" accesskey="1">Fat-free Accounting</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Building-the-program" accesskey="2">Building the program</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Getting-help" accesskey="3">Getting help</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Third_002dParty-Ledger-Tutorials" accesskey="4">Third-Party Ledger Tutorials</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
</table>

<hr>
<a name="Fat_002dfree-Accounting"></a>
<div class="header">
<p>
Next: <a href="#Building-the-program" accesskey="n" rel="next">Building the program</a>, Previous: <a href="#Introduction-to-Ledger" accesskey="p" rel="prev">Introduction to Ledger</a>, Up: <a href="#Introduction-to-Ledger" accesskey="u" rel="up">Introduction to Ledger</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Fat_002dfree-Accounting-1"></a>
<h3 class="section">1.1 Fat-free Accounting</h3>

<p>Ledger is an accounting tool with the moxie to exist.  It provides no
bells or whistles, and returns the user to the days before user
interfaces were even a twinkling in their father&rsquo;s CRT.
</p>
<p>What it does offer is a double-entry accounting journal with all the
flexibility and muscle of its modern day cousins, without any of the
fat.  Think of it as the Bran Muffin of accounting tools.
</p>
<p>To use it, you need to start keeping a journal.  This is the basis of
all accounting, and if you haven&rsquo;t started yet, now is the time to
learn.  The little booklet that comes with your checkbook is a journal,
so we&rsquo;ll describe double-entry accounting in terms of that.
</p>

<p>A checkbook journal records debits (subtractions, or withdrawals) and
credits (additions, or deposits) with reference to a single account:
the checking account.  Where the money comes from, and where it goes
to, are described in the payee field, where you write the person or
company&rsquo;s name.  The ultimate aim of keeping a checkbook journal is to
know how much money is available to spend.  That&rsquo;s really the aim of
all journals.
</p>
<a name="index-postings"></a>
<p>What computers add is the ability to walk through these postings,
and tell you things about your spending habits; to let you devise
budgets and get control over your spending; to squirrel away money
into virtual savings account without having to physically move money
around; etc.  As you keep your journal, you are recording information
about your life and habits, and sometimes that information can start
telling you things you aren&rsquo;t aware of.  Such is the aim of all good
accounting tools.
</p>
<p>The next step up from a checkbook journal, is a journal that keeps
track of all your accounts, not just checking.  In such a journal, you
record not only who gets paid&mdash;in the case of a debit&mdash;but where the
money came from.  In a checkbook journal, it&rsquo;s assumed that all the
money comes from your checking account.  But in a general journal, you
write postings in two lines: the source account and target account.
<em>There must always be a debit from at least one account for every
credit made to another account</em>.  This is what is meant by
&ldquo;double-entry&rdquo; accounting: the journal must always balance to zero,
with an equal number of debits and credits.
</p>
<p>For example, let&rsquo;s say you have a checking account and a brokerage
account, and you can write checks from both of them.  Rather than keep
two checkbooks, you decide to use one journal for both.  In this
general journal you need to record a payment to Pacific Bell for your
monthly phone bill, and a transfer (via check) from your brokerage
account to your checking account.  The Pacific Bell bill is $23.00,
let&rsquo;s say, and you want to pay it from your checking account.  In the
general journal you need to say where the money came from, in addition
to where it&rsquo;s going to.  These transactions might look like this:
</p>
<div class="smallexample">
<pre class="smallexample">9/29        Pacific Bell                $23.00     $23.00
            Checking                   $-23.00          0
9/30        Checking                   $100.00    $100.00
      (123) Brokerage                 $-100.00          0
</pre></div>

<p>The posting must balance to $0: $23 went to Pacific Bell, $23 came
from Checking.  The next entry shows check number 123 written against
your brokerage account, transferring money to your checking account.
There is nothing left over to be accounted for, since the money has
simply moved from one account to another in both cases.  This is the
basis of double-entry accounting: money never pops in or out of
existence; it is always a posting from one account to another.
</p>
<p>Keeping a general journal is the same as keeping two separate
journals: One for Pacific Bell and one for Checking.  In that case,
each time a payment is written into one, you write a corresponding
withdrawal into the other.  This makes it easier to write in
a &ldquo;running balance&rdquo;, since you don&rsquo;t have to look back at the last
time the account was referenced&mdash;but it also means having a lot of
journal books, if you deal with multiple accounts.
</p>
<a name="index-account_002c-meaning-of"></a>
<a name="index-meaning-of-account"></a>
<p>Here is a good place for an aside on the use of the word &ldquo;account&rdquo;.
Most private people consider an account to be something that holds
money at an institution for them.  Ledger uses a more general
definition of the word.  An account is anywhere money can go.  Other
finance programs use &ldquo;categories&rdquo;, Ledger uses accounts.  So, for
example, if you buy some groceries at Trader Joe&rsquo;s, then more groceries
at Whole Food Market, you might assign the transactions like this
</p>
<div class="smallexample">
<pre class="smallexample">2011/03/15   Trader Joe's
    Expenses:Groceries   $100.00
    Assets:Checking
2011/03/15   Whole Food Market
    Expenses:Groceries   $75.00
    Assets:Checking
</pre></div>

<p>In both cases the money goes to the &lsquo;<samp>Groceries</samp>&rsquo; account, even
though the payees were different.  You can set up your accounts in any
way you choose.
</p>
<p>Enter the beauty of computerized accounting.  The purpose of the
Ledger program is to make general journal accounting simple, by
keeping track of the balances for you.  Your only job is to enter the
postings.  If an individual posting does not balance, Ledger displays
an error and indicates the incorrect posting.<a name="DOCF1" href="#FOOT1"><sup>1</sup></a>
</p>
<p>In summary, there are two aspects of Ledger use: updating the journal
data file, and using the Ledger tool to view the summarized result of
your transactions.
</p>
<p>And just for the sake of example&mdash;as a starting point for those who
want to dive in head-first&mdash;here are the journal transactions from
above, formatted as the Ledger program wishes to see them:
</p>
<div class="smallexample">
<pre class="smallexample">2004/09/29 Pacific Bell
    Expenses:Pacific Bell              $23.00
    Assets:Checking
</pre></div>

<p>The account balances and registers in this file, if saved as
<samp>ledger.dat</samp>, could be reported using:
</p>
<div class="smallexample">
<pre class="smallexample">$ ledger -f ledger.dat balance
</pre></div>

<div class="smallexample">
<pre class="smallexample">             $-23.00  Assets:Checking
              $23.00  Expenses:Pacific Bell
--------------------
                   0
</pre></div>

<p>Or
</p>
<div class="smallexample">
<pre class="smallexample">$ ledger -f ledger.dat register checking
</pre></div>

<div class="smallexample">
<pre class="smallexample">04-Sep-29 Pacific Bell          Assets:Checking             $-23.00      $-23.00
</pre></div>

<p>And even:
</p>
<div class="smallexample">
<pre class="smallexample">$ ledger -f ledger.dat register Bell
</pre></div>

<div class="smallexample">
<pre class="smallexample">04-Sep-29 Pacific Bell          Expenses:Pacific Bell        $23.00       $23.00
</pre></div>

<p>An important difference between Ledger and other finance packages is
that Ledger will never alter your input file.  You can create and edit
that file in any way you prefer, but Ledger is only for analyzing the
data, not for altering it.
</p>
<hr>
<a name="Building-the-program"></a>
<div class="header">
<p>
Next: <a href="#Getting-help" accesskey="n" rel="next">Getting help</a>, Previous: <a href="#Fat_002dfree-Accounting" accesskey="p" rel="prev">Fat-free Accounting</a>, Up: <a href="#Introduction-to-Ledger" accesskey="u" rel="up">Introduction to Ledger</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Building-the-program-1"></a>
<h3 class="section">1.2 Building the program</h3>

<p>Ledger is written in ANSI C++, and should compile on any unix platform.
The easiest way to build and install ledger is to use the prepared
acprep script, that does a lot of the footwork:
</p>
<div class="smallexample">
<pre class="smallexample">    # to install missing dependencies
    ./acprep dependencies
    # building ledger
    ./acprep update
    # to run the actual installation
    make install
</pre></div>

<p>See the &lsquo;help&lsquo; subcommand to &lsquo;acprep&lsquo;, which explains some of its many
options.  You can run &lsquo;make check&lsquo; to confirm the result, and &lsquo;make
install&lsquo; to install.  If these intructions do not work for you can check the
&lsquo;INSTALL.md&lsquo; in the source directory for more up do date build instructions.
</p>
<hr>
<a name="Getting-help"></a>
<div class="header">
<p>
Previous: <a href="#Building-the-program" accesskey="p" rel="prev">Building the program</a>, Up: <a href="#Introduction-to-Ledger" accesskey="u" rel="up">Introduction to Ledger</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Getting-help-1"></a>
<h3 class="section">1.3 Getting help</h3>
<a name="index-help"></a>

<p>Ledger has a complete online help system based on GNU Info.  This manual
can be searched directly from the command-line using <code>info ledger</code>,
which will bring up this entire manual in your TTY.  Alternatively, the
shorter man page can be accessed from the command-line either via
<code>man ledger</code> or <code>ledger --help</code>
</p>
<p>If you need help on how to use Ledger, or run into problems, you can
join the Ledger mailing list at
<a href="http://groups.google.com/group/ledger-cli">http://groups.google.com/group/ledger-cli</a>.
</p>
<p>You can also find help in the <code>#ledger</code> channel on the IRC server
<code>irc.freenode.net</code>.
</p>
<hr>
<a name="Third_002dParty-Ledger-Tutorials"></a>
<div class="header">
<p>
Previous: <a href="#Getting-help" accesskey="p" rel="prev">Getting help</a>, Up: <a href="#Introduction-to-Ledger" accesskey="u" rel="up">Introduction to Ledger</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Third_002dParty-Ledger-Tutorials-1"></a>
<h3 class="section">1.4 Third-Party Ledger Tutorials</h3>

<p>There are plenty of people using Ledger for accounting applications.
Some have documented how they use Ledger&rsquo;s features to solve their
accounting problems.
</p>
<p>Once such tutorial, specifically designed for non-profit charities that seek
to use Ledger, can be found at
<a href="https://k.sfconservancy.org/npo-ledger-cli">https://k.sfconservancy.org/npo-ledger-cli</a> (with a copy on GitHub also
available at <a href="https://github.com/conservancy/npo-ledger-cli/">https://github.com/conservancy/npo-ledger-cli/</a>).  If
you&rsquo;re looking for information about how to use Ledger&rsquo;s tagging system to
handle invoicing, track expenses by program targets, and other such concepts,
you might find the tutorial useful.  (Some of the auditor reporting scripts
that relate to the aformentioned Ledger setup can be found
<var>contrib/non-profit-audit-reports/</var> in Ledger&rsquo;s own source repository.)
</p>
<hr>
<a name="Ledger-Tutorial"></a>
<div class="header">
<p>
Next: <a href="#Principles-of-Accounting-with-Ledger" accesskey="n" rel="next">Principles of Accounting with Ledger</a>, Previous: <a href="#Introduction-to-Ledger" accesskey="p" rel="prev">Introduction to Ledger</a>, Up: <a href="#Top" accesskey="u" rel="up">Top</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Ledger-Tutorial-1"></a>
<h2 class="chapter">2 Ledger Tutorial</h2>
<a name="index-tutorial"></a>

<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top">&bull; <a href="#Start-a-Journal-File" accesskey="1">Start a Journal File</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Run-a-Few-Reports" accesskey="2">Run a Few Reports</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
</table>

<hr>
<a name="Start-a-Journal-File"></a>
<div class="header">
<p>
Next: <a href="#Run-a-Few-Reports" accesskey="n" rel="next">Run a Few Reports</a>, Previous: <a href="#Ledger-Tutorial" accesskey="p" rel="prev">Ledger Tutorial</a>, Up: <a href="#Ledger-Tutorial" accesskey="u" rel="up">Ledger Tutorial</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Start-a-Journal-File-1"></a>
<h3 class="section">2.1 Start a Journal File</h3>
<a name="index-journals"></a>

<p>A journal is a record of your financial transactions and will be central
to using Ledger.  For now we just want to get a taste of what Ledger can
do.  An example journal is included with the source code distribution,
called <samp>drewr3.dat</samp> (see <a href="#Example-Journal-File">Example Journal File</a>).  Copy it
someplace convenient and open up a terminal window in that directory.
</p>
<p>If you would rather start with your own journal right away please
see <a href="#Keeping-a-Journal">Keeping a Journal</a>.
</p>
<hr>
<a name="Run-a-Few-Reports"></a>
<div class="header">
<p>
Previous: <a href="#Start-a-Journal-File" accesskey="p" rel="prev">Start a Journal File</a>, Up: <a href="#Ledger-Tutorial" accesskey="u" rel="up">Ledger Tutorial</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Run-a-Few-Reports-1"></a>
<h3 class="section">2.2 Run a Few Reports</h3>

<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top">&bull; <a href="#Balance-Report" accesskey="1">Balance Report</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Register-Report" accesskey="2">Register Report</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Cleared-Report" accesskey="3">Cleared Report</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Using-the-Windows-Command_002dLine" accesskey="4">Using the Windows Command-Line</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
</table>

<p>Please note that as a command-line program, Ledger is controlled from
your shell.  There are several different command shells that all
behave slightly differently with respect to some special characters.
In particular, the &ldquo;bash&rdquo; shell will interpret &lsquo;<samp>$</samp>&rsquo; signs
differently than ledger and they must be escaped to reach the actual
program.  Another example is &ldquo;zsh&rdquo;, which will interpret &lsquo;<samp>^</samp>&rsquo;
differently than ledger expects.  In all cases that follow you should
take that into account when entering the command-line arguments as given.
There are too many variations between shells to give concrete examples
for each.
</p>
<hr>
<a name="Balance-Report"></a>
<div class="header">
<p>
Next: <a href="#Register-Report" accesskey="n" rel="next">Register Report</a>, Previous: <a href="#Run-a-Few-Reports" accesskey="p" rel="prev">Run a Few Reports</a>, Up: <a href="#Run-a-Few-Reports" accesskey="u" rel="up">Run a Few Reports</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Balance-Report-1"></a>
<h4 class="subsection">2.2.1 Balance Report</h4>
<a name="index-balance-report"></a>
<a name="index-balance"></a>

<p>To find the balances of all of your accounts, run this command:
</p>
<div class="smallexample">
<pre class="smallexample">$ ledger -f drewr3.dat balance
</pre></div>

<p>Ledger will generate:
</p>
<div class="smallexample">
<pre class="smallexample">         $ -3,804.00  Assets
          $ 1,396.00    Checking
             $ 30.00      Business
         $ -5,200.00    Savings
         $ -1,000.00  Equity:Opening Balances
          $ 6,654.00  Expenses
          $ 5,500.00    Auto
             $ 20.00    Books
            $ 300.00    Escrow
            $ 334.00    Food:Groceries
            $ 500.00    Interest:Mortgage
         $ -2,030.00  Income
         $ -2,000.00    Salary
            $ -30.00    Sales
            $ -63.60  Liabilities
            $ -20.00    MasterCard
            $ 200.00    Mortgage:Principal
           $ -243.60    Tithe
--------------------
           $ -243.60
</pre></div>

<p>Showing you the balance of all accounts.  Options and search terms can
pare this down to show only the accounts you want.
</p>
<p>A more useful report is to show only your Assets and Liabilities:
</p>
<div class="smallexample">
<pre class="smallexample">$ ledger -f drewr3.dat balance Assets Liabilities
</pre></div>

<div class="smallexample">
<pre class="smallexample">         $ -3,804.00  Assets
          $ 1,396.00    Checking
             $ 30.00      Business
         $ -5,200.00    Savings
            $ -63.60  Liabilities
            $ -20.00    MasterCard
            $ 200.00    Mortgage:Principal
           $ -243.60    Tithe
--------------------
         $ -3,867.60
</pre></div>

<hr>
<a name="Register-Report"></a>
<div class="header">
<p>
Next: <a href="#Cleared-Report" accesskey="n" rel="next">Cleared Report</a>, Previous: <a href="#Balance-Report" accesskey="p" rel="prev">Balance Report</a>, Up: <a href="#Run-a-Few-Reports" accesskey="u" rel="up">Run a Few Reports</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Register-Report-1"></a>
<h4 class="subsection">2.2.2 Register Report</h4>
<a name="index-register-report"></a>
<a name="index-register"></a>

<p>To show all transactions and a running total:
</p>
<div class="smallexample">
<pre class="smallexample">$ ledger -f drewr3.dat register
</pre></div>

<p>Ledger will generate:
</p>
<div class="smallexample">
<pre class="smallexample">10-Dec-01 Checking balance      Assets:Checking          $ 1,000.00   $ 1,000.00
                                Equit:Opening Balances  $ -1,000.00            0
10-Dec-20 Organic Co-op         Expense:Food:Groceries      $ 37.50      $ 37.50
                                Expense:Food:Groceries      $ 37.50      $ 75.00
                                Expense:Food:Groceries      $ 37.50     $ 112.50
                                Expense:Food:Groceries      $ 37.50     $ 150.00
                                Expense:Food:Groceries      $ 37.50     $ 187.50
                                Expense:Food:Groceries      $ 37.50     $ 225.00
                                Assets:Checking           $ -225.00            0
10-Dec-28 Acme Mortgage         Lia:Mortgage:Principal     $ 200.00     $ 200.00
                                Expe:Interest:Mortgage     $ 500.00     $ 700.00
                                Expenses:Escrow            $ 300.00   $ 1,000.00
                                Assets:Checking         $ -1,000.00            0
11-Jan-02 Grocery Store         Expense:Food:Groceries      $ 65.00      $ 65.00
                                Assets:Checking            $ -65.00            0
11-Jan-05 Employer              Assets:Checking          $ 2,000.00   $ 2,000.00
                                Income:Salary           $ -2,000.00            0
                                (Liabilities:Tithe)       $ -240.00    $ -240.00
11-Jan-14 Bank                  Assets:Savings             $ 300.00      $ 60.00
                                Assets:Checking           $ -300.00    $ -240.00
11-Jan-19 Grocery Store         Expense:Food:Groceries      $ 44.00    $ -196.00
                                Assets:Checking            $ -44.00    $ -240.00
11-Jan-25 Bank                  Assets:Checking          $ 5,500.00   $ 5,260.00
                                Assets:Savings          $ -5,500.00    $ -240.00
11-Jan-25 Tom's Used Cars       Expenses:Auto            $ 5,500.00   $ 5,260.00
                                Assets:Checking         $ -5,500.00    $ -240.00
11-Jan-27 Book Store            Expenses:Books              $ 20.00    $ -220.00
                                Liabilities:MasterCard     $ -20.00    $ -240.00
11-Dec-01 Sale                  Asse:Checking:Business      $ 30.00    $ -210.00
                                Income:Sales               $ -30.00    $ -240.00
                                (Liabilities:Tithe)         $ -3.60    $ -243.60
</pre></div>

<p>To limit this to a more useful subset, simply add the accounts you are
interested in seeing transactions for:
</p>
<a name="index-accounts_002c-limiting-by"></a>
<a name="index-limiting-by-accounts"></a>

<div class="smallexample">
<pre class="smallexample">$ ledger -f drewr3.dat register Groceries
</pre></div>

<div class="smallexample">
<pre class="smallexample">10-Dec-20 Organic Co-op         Expense:Food:Groceries      $ 37.50      $ 37.50
                                Expense:Food:Groceries      $ 37.50      $ 75.00
                                Expense:Food:Groceries      $ 37.50     $ 112.50
                                Expense:Food:Groceries      $ 37.50     $ 150.00
                                Expense:Food:Groceries      $ 37.50     $ 187.50
                                Expense:Food:Groceries      $ 37.50     $ 225.00
11-Jan-02 Grocery Store         Expense:Food:Groceries      $ 65.00     $ 290.00
11-Jan-19 Grocery Store         Expense:Food:Groceries      $ 44.00     $ 334.00
</pre></div>

<p>Which matches the balance reported for the &lsquo;<samp>Groceries</samp>&rsquo; account:
</p>
<div class="smallexample">
<pre class="smallexample">$ ledger -f drewr3.dat balance Groceries
</pre></div>

<div class="smallexample">
<pre class="smallexample">            $ 334.00  Expenses:Food:Groceries
</pre></div>

<p>If you would like to find transaction to only a certain payee use
&lsquo;<samp>payee</samp>&rsquo; or &lsquo;<samp>@</samp>&rsquo;:
</p>
<div class="smallexample">
<pre class="smallexample">$ ledger -f drewr3.dat register payee &quot;Organic&quot;
</pre></div>

<div class="smallexample">
<pre class="smallexample">10-Dec-20 Organic Co-op         Expense:Food:Groceries      $ 37.50      $ 37.50
                                Expense:Food:Groceries      $ 37.50      $ 75.00
                                Expense:Food:Groceries      $ 37.50     $ 112.50
                                Expense:Food:Groceries      $ 37.50     $ 150.00
                                Expense:Food:Groceries      $ 37.50     $ 187.50
                                Expense:Food:Groceries      $ 37.50     $ 225.00
                                Assets:Checking           $ -225.00            0
</pre></div>

<hr>
<a name="Cleared-Report"></a>
<div class="header">
<p>
Next: <a href="#Using-the-Windows-Command_002dLine" accesskey="n" rel="next">Using the Windows Command-Line</a>, Previous: <a href="#Register-Report" accesskey="p" rel="prev">Register Report</a>, Up: <a href="#Run-a-Few-Reports" accesskey="u" rel="up">Run a Few Reports</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Cleared-Report-1"></a>
<h4 class="subsection">2.2.3 Cleared Report</h4>
<a name="index-cleared-report"></a>
<a name="index-cleared"></a>

<p>A very useful report is to show what your obligations are versus what
expenditures have actually been recorded.  It can take several days for
a check to clear, but you should treat it as money spent.  The
<code>cleared</code> report shows just that (note that the
<code>cleared</code> report will not format correctly for accounts that
contain multiple commodities):
</p>
<div class="smallexample">
<pre class="smallexample">$ ledger -f drewr3.dat cleared
</pre></div>

<div class="smallexample">
<pre class="smallexample">     $ -3,804.00            $ 775.00                 Assets
      $ 1,396.00            $ 775.00    10-Dec-20      Checking
         $ 30.00                   0                     Business
     $ -5,200.00                   0                   Savings
     $ -1,000.00         $ -1,000.00    10-Dec-01    Equity:Opening Balances
      $ 6,654.00            $ 225.00                 Expenses
      $ 5,500.00                   0                   Auto
         $ 20.00                   0                   Books
        $ 300.00                   0                   Escrow
        $ 334.00            $ 225.00    10-Dec-20      Food:Groceries
        $ 500.00                   0                   Interest:Mortgage
     $ -2,030.00                   0                 Income
     $ -2,000.00                   0                   Salary
        $ -30.00                   0                   Sales
        $ -63.60                   0                 Liabilities
        $ -20.00                   0                   MasterCard
        $ 200.00                   0                   Mortgage:Principal
       $ -243.60                   0                   Tithe
----------------    ----------------    ---------
       $ -243.60                   0             
</pre></div>

<p>The first column shows the outstanding balance, the second column
shows the &ldquo;cleared&rdquo; balance.
</p>
<hr>
<a name="Using-the-Windows-Command_002dLine"></a>
<div class="header">
<p>
Previous: <a href="#Cleared-Report" accesskey="p" rel="prev">Cleared Report</a>, Up: <a href="#Run-a-Few-Reports" accesskey="u" rel="up">Run a Few Reports</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Using-the-Windows-Command_002dLine-1"></a>
<h4 class="subsection">2.2.4 Using the Windows Command-Line</h4>
<a name="index-windows-cmd_002eexe"></a>
<a name="index-currency-symbol-display-on-windows"></a>

<p>Using ledger under the windows command shell has one significant
limitation.  CMD.EXE is limited to standard ASCII characters and as
such cannot display any currency symbols other than dollar signs
&lsquo;<samp>$</samp>&rsquo;.
</p>
<hr>
<a name="Principles-of-Accounting-with-Ledger"></a>
<div class="header">
<p>
Next: <a href="#Keeping-a-Journal" accesskey="n" rel="next">Keeping a Journal</a>, Previous: <a href="#Ledger-Tutorial" accesskey="p" rel="prev">Ledger Tutorial</a>, Up: <a href="#Top" accesskey="u" rel="up">Top</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Principles-of-Accounting-with-Ledger-1"></a>
<h2 class="chapter">3 Principles of Accounting with Ledger</h2>

<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top">&bull; <a href="#Accounting-with-Ledger" accesskey="1">Accounting with Ledger</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Stating-where-money-goes" accesskey="2">Stating where money goes</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Assets-and-Liabilities" accesskey="3">Assets and Liabilities</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Commodities-and-Currencies" accesskey="4">Commodities and Currencies</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Accounts-and-Inventories" accesskey="5">Accounts and Inventories</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Understanding-Equity" accesskey="6">Understanding Equity</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Dealing-with-Petty-Cash" accesskey="7">Dealing with Petty Cash</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Working-with-multiple-funds-and-accounts" accesskey="8">Working with multiple funds and accounts</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
</table>

<hr>
<a name="Accounting-with-Ledger"></a>
<div class="header">
<p>
Next: <a href="#Stating-where-money-goes" accesskey="n" rel="next">Stating where money goes</a>, Previous: <a href="#Principles-of-Accounting-with-Ledger" accesskey="p" rel="prev">Principles of Accounting with Ledger</a>, Up: <a href="#Principles-of-Accounting-with-Ledger" accesskey="u" rel="up">Principles of Accounting with Ledger</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Accounting-with-Ledger-1"></a>
<h3 class="section">3.1 Accounting with Ledger</h3>
<a name="index-double_002dentry-accounting"></a>

<p>Accounting is simply tracking your money.  It can range from nothing,
and just waiting for automatic overdraft protection to kick in, or
not, to a full-blown double-entry accounting system.  Ledger
accomplishes the latter.  With ledger you can handle your personal
finances or your business&rsquo;s.  Double-entry accounting scales.
</p>
<hr>
<a name="Stating-where-money-goes"></a>
<div class="header">
<p>
Next: <a href="#Assets-and-Liabilities" accesskey="n" rel="next">Assets and Liabilities</a>, Previous: <a href="#Accounting-with-Ledger" accesskey="p" rel="prev">Accounting with Ledger</a>, Up: <a href="#Principles-of-Accounting-with-Ledger" accesskey="u" rel="up">Principles of Accounting with Ledger</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Stating-where-money-goes-1"></a>
<h3 class="section">3.2 Stating where money goes</h3>
<a name="index-credits-and-debits"></a>

<p>Accountants will talk of &ldquo;credits&rdquo; and &ldquo;debits&rdquo;, but the meaning
is often different from the layman&rsquo;s understanding.  To avoid
confusion, Ledger uses only subtractions and additions, although the
underlying intent is the same as standard accounting principles.
</p>
<p>Recall that every posting will involve two or more accounts.
Money is transferred from one or more accounts to one or more other
accounts.  To record the posting, an amount is <em>subtracted</em>
from the source accounts, and <em>added</em> to the target accounts.
</p>
<p>In order to write a Ledger transaction correctly, you must determine
where the money comes from and where it goes to.  For example, when
you are paid a salary, you must add money to your bank account and
also subtract it from an income account:
</p>
<div class="smallexample">
<pre class="smallexample">9/29  My Employer
    Assets:Checking                           $500.00
    Income:Salary                            $-500.00
</pre></div>

<a name="index-income-is-negative"></a>
<a name="index-why-is-income-negative"></a>

<p>Why is the Income a negative figure?  When you look at the balance
totals for your ledger, you may be surprised to see that Expenses are
a positive figure, and Income is a negative figure.  It may take some
getting used to, but to properly use a general ledger you must think
in terms of how money moves.  Rather than Ledger &ldquo;fixing&rdquo; the minus
signs, let&rsquo;s understand why they are there.
</p>
<p>When you earn money, the money has to come from somewhere.  Let&rsquo;s call
that somewhere &ldquo;society&rdquo;.  In order for society to give you an
income, you must take money away (withdraw) from society in order to
put it into (make a payment to) your bank.  When you then spend that
money, it leaves your bank account (a withdrawal) and goes back to
society (a payment).  This is why Income will appear negative&mdash;it
reflects the money you have drawn from society&mdash;and why Expenses will
be positive&mdash;it is the amount you&rsquo;ve given back.  These additions and
subtractions will always cancel each other out in the end, because you
don&rsquo;t have the ability to create new money: it must always come from
somewhere, and in the end must always leave.  This is the beginning of
economy, after which the explanation gets terribly difficult.
</p>
<p>Based on that explanation, here&rsquo;s another way to look at your balance
report: every negative figure means that that account or person or
place has less money now than when you started your ledger; and every
positive figure means that that account or person or place has more
money now than when you started your ledger.  Make sense?
</p>
<hr>
<a name="Assets-and-Liabilities"></a>
<div class="header">
<p>
Next: <a href="#Commodities-and-Currencies" accesskey="n" rel="next">Commodities and Currencies</a>, Previous: <a href="#Stating-where-money-goes" accesskey="p" rel="prev">Stating where money goes</a>, Up: <a href="#Principles-of-Accounting-with-Ledger" accesskey="u" rel="up">Principles of Accounting with Ledger</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Assets-and-Liabilities-1"></a>
<h3 class="section">3.3 Assets and Liabilities</h3>
<a name="index-assets-and-liabilities"></a>
<a name="index-debts-are-liabilities"></a>

<p>Assets are money that you have, and Liabilities are money that you
owe.  &ldquo;Liabilities&rdquo; is just a more inclusive name for Debts.
</p>
<p>An Asset is typically increased by transferring money from an Income
account, such as when you get paid.  Here is a typical transaction:
</p>
<div class="smallexample">
<pre class="smallexample">2004/09/29  My Employer
    Assets:Checking               $500.00
    Income:Salary
</pre></div>

<p>Money, here, comes from an Income account belonging to &lsquo;<samp>My
Employer</samp>&rsquo;, and is transferred to your checking account.  The money is
now yours, which makes it an Asset.
</p>
<p>Liabilities track money owed to others.  This can happen when you
borrow money to buy something, or if you owe someone money.  Here is
an example of increasing a MasterCard liability by spending money with
it:
</p>
<div class="smallexample">
<pre class="smallexample">2004/09/30  Restaurant
    Expenses:Dining                $25.00
    Liabilities:MasterCard
</pre></div>

<p>The Dining account balance now shows $25 spent on Dining, and
a corresponding $25 owed on the MasterCard&mdash;and therefore shown as
$-25.00.  The MasterCard liability shows up as negative because it
offsets the value of your assets.
</p>
<p>The combined total of your Assets and Liabilities is your net worth.
So to see your current net worth, use this command:
</p>
<div class="smallexample">
<pre class="smallexample">$ ledger balance ^assets ^liabilities
</pre></div>

<div class="smallexample">
<pre class="smallexample">             $500.00  Assets:Checking
             $-25.00  Liabilities:MasterCard
--------------------
             $475.00
</pre></div>

<p>In a similar vein, your Income accounts show up negative, because they
transfer money <em>from</em> an account in order to increase your
assets.  Your Expenses show up positive because that is where the
money went to.  The combined total of Income and Expenses is your cash
flow.  A positive cash flow means you are spending more than you make,
since income is always a negative figure.  To see your current cash
flow, use this command:
</p>
<div class="smallexample">
<pre class="smallexample">$ ledger balance ^income ^expenses
</pre></div>

<div class="smallexample">
<pre class="smallexample">              $25.00  Expenses:Dining
            $-500.00  Income:Salary
--------------------
            $-475.00
</pre></div>

<p>Another common question to ask of your expenses is: How much do I
spend each month on X?  Ledger provides a simple way of displaying
monthly totals for any account.  Here is an example that summarizes
your monthly automobile expenses:
</p>
<div class="smallexample">
<pre class="smallexample">$ ledger -M register -f drewr3.dat expenses:auto
</pre></div>

<div class="smallexample">
<pre class="smallexample">11-Jan-01 - 11-Jan-31           Expenses:Auto            $ 5,500.00   $ 5,500.00
</pre></div>

<p>This assumes, of course, that you use account names like
&lsquo;<samp>Expenses:Auto:Gas</samp>&rsquo; and &lsquo;<samp>Expenses:Auto:Repair</samp>&rsquo;.
</p>
<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top">&bull; <a href="#Tracking-reimbursable-expenses" accesskey="1">Tracking reimbursable expenses</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
</table>

<hr>
<a name="Tracking-reimbursable-expenses"></a>
<div class="header">
<p>
Previous: <a href="#Assets-and-Liabilities" accesskey="p" rel="prev">Assets and Liabilities</a>, Up: <a href="#Assets-and-Liabilities" accesskey="u" rel="up">Assets and Liabilities</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Tracking-reimbursable-expenses-1"></a>
<h4 class="subsection">3.3.1 Tracking reimbursable expenses</h4>
<a name="index-reimbursable-expense-tracking"></a>

<p>Sometimes you will want to spend money on behalf of someone else, which
will eventually get repaid.  Since the money is still <em>yours</em>, it
is really an asset.  And since the expenditure was for someone else, you
don&rsquo;t want it contaminating your Expenses reports.  You will need to
keep an account for tracking reimbursements.
</p>
<p>This is fairly easy to do in ledger.  When spending the money, spend
it <em>to</em> your Assets:Reimbursements, using a different account for
each person or business that you spend money for.  For example:
</p>
<div class="smallexample">
<pre class="smallexample">2004/09/29  Circuit City
    Assets:Reimbursements:Company XYZ     $100.00
    Liabilities:MasterCard
</pre></div>

<p>This shows $100.00 spent on a MasterCard at Circuit City, with the
expense was made on behalf of Company XYZ.  Later, when Company XYZ
pays the amount back, the money will transfer from that reimbursement
account back to a regular asset account:
</p>
<div class="smallexample">
<pre class="smallexample">2004/09/29  Company XYZ
    Assets:Checking                       $100.00
    Assets:Reimbursements:Company XYZ
</pre></div>

<p>This deposits the money owed from Company XYZ into a checking account,
presumably because they paid the amount back with a check.
</p>
<p>But what to do if you run your own business, and you want to keep
track of expenses made on your own behalf, while still tracking
everything in a single ledger file?  This is more complex, because you
need to track two separate things: 1) The fact that the money should
be reimbursed to you, and 2) What the expense account was, so that you
can later determine where your company is spending its money.
</p>
<p>This kind of posting is best handled with mirrored postings in
two different files, one for your personal accounts, and one for your
company accounts.  But keeping them in one file involves the same
kinds of postings, so those are what is shown here.  First, the
personal transaction, which shows the need for reimbursement:
</p>
<div class="smallexample">
<pre class="smallexample">2004/09/29  Circuit City
    Assets:Reimbursements:Company XYZ     $100.00
    Liabilities:MasterCard
</pre></div>

<p>This is the same as above, except that you own Company XYZ, and are
keeping track of its expenses in the same ledger file.  This
transaction should be immediately followed by an equivalent
transaction, which shows the kind of expense, and also notes the fact
that $100.00 is now payable to you:
</p>
<div class="smallexample">
<pre class="smallexample">2004/09/29  Circuit City
    Company XYZ:Expenses:Computer:Software      $100.00
    Company XYZ:Accounts Payable:Your Name
</pre></div>

<p>This second transaction shows that Company XYZ has just spent $100.00
on software, and that this $100.00 came from Your Name, which must be
paid back.
</p>
<p>These two transactions can also be merged, to make things a little
clearer.  Note that all amounts must be specified now:
</p>
<div class="smallexample">
<pre class="smallexample">2004/09/29  Circuit City
    Assets:Reimbursements:Company XYZ         $100.00
    Liabilities:MasterCard                   $-100.00
    Company XYZ:Expenses:Computer:Software    $100.00
    Company XYZ:Accounts Payable:Your Name   $-100.00
</pre></div>

<p>To &ldquo;pay back&rdquo; the reimbursement, just reverse the order of
everything, except this time drawing the money from a company asset,
paying it to accounts payable, and then drawing it again from the
reimbursement account, and paying it to your personal asset account.
It&rsquo;s easier shown than said:
</p>
<div class="smallexample">
<pre class="smallexample">2004/10/15  Company XYZ
    Assets:Checking                           $100.00
    Assets:Reimbursements:Company XYZ        $-100.00
    Company XYZ:Accounts Payable:Your Name    $100.00
    Company XYZ:Assets:Checking              $-100.00
</pre></div>

<p>And now the reimbursements account is paid off, accounts payable is paid
off, and $100.00 has been effectively transferred from the company&rsquo;s
checking account to your personal checking account.  The money simply
&ldquo;waited&rdquo;&mdash;in both &lsquo;<samp>Assets:Reimbursements:Company XYZ</samp>&rsquo;, and
&lsquo;<samp>Company XYZ:Accounts Payable:Your Name</samp>&rsquo;&mdash;until such time as it
could be paid off.
</p>
<p>The value of tracking expenses from both sides like that is that you
do not contaminate your personal expense report with expenses made on
behalf of others, while at the same time making it possible to
generate accurate reports of your company&rsquo;s expenditures.  It is more
verbose than just paying for things with your personal assets, but it
gives you a very accurate information trail.
</p>
<p>The advantage to keep these doubled transactions together is that they
always stay in sync.  The advantage to keeping them apart is that it
clarifies the transfer&rsquo;s point of view.  To keep the postings in
separate files, just separate the two transactions that were joined
above.  For example, for both the expense and the pay-back shown
above, the following four transactions would be created.  Two in your
personal ledger file:
</p>
<div class="smallexample">
<pre class="smallexample">2004/09/29  Circuit City
    Assets:Reimbursements:Company XYZ     $100.00
    Liabilities:MasterCard               $-100.00

2004/10/15  Company XYZ
    Assets:Checking                       $100.00
    Assets:Reimbursements:Company XYZ    $-100.00
</pre></div>

<p>And two in your company ledger file:
</p>
<div class="smallexample">
<pre class="smallexample">apply account Company XYZ

2004/09/29  Circuit City
    Expenses:Computer:Software            $100.00
    Accounts Payable:Your Name           $-100.00

2004/10/15  Company XYZ
    Accounts Payable:Your Name            $100.00
    Assets:Checking                      $-100.00

end apply account
</pre></div>

<p>(Note: The <code>apply account</code> above means that all accounts
mentioned in the file are children of that account.  In this case it
means that all activity in the file relates to Company XYZ).
</p>
<p>After creating these transactions, you will always know that $100.00
was spent using your MasterCard on behalf of Company XYZ, and that
Company XYZ spent the money on computer software and paid it back
about two weeks later.
</p>
<div class="smallexample">
<pre class="smallexample">$ ledger balance --no-total
</pre></div>

<div class="smallexample">
<pre class="smallexample">             $100.00  Assets:Checking
                   0  Company XYZ
            $-100.00    Assets:Checking
             $100.00    Expenses:Computer:Software
            $-100.00  Liabilities:MasterCard
</pre></div>

<hr>
<a name="Commodities-and-Currencies"></a>
<div class="header">
<p>
Next: <a href="#Accounts-and-Inventories" accesskey="n" rel="next">Accounts and Inventories</a>, Previous: <a href="#Assets-and-Liabilities" accesskey="p" rel="prev">Assets and Liabilities</a>, Up: <a href="#Principles-of-Accounting-with-Ledger" accesskey="u" rel="up">Principles of Accounting with Ledger</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Commodities-and-Currencies-1"></a>
<h3 class="section">3.4 Commodities and Currencies</h3>

<p>Ledger makes no assumptions about the commodities you use; it only
requires that you specify a commodity.  The commodity may be any
non-numeric string that does not contain a period, comma, forward
slash or at-sign.  It may appear before or after the amount, although
it is assumed that symbols appearing before the amount refer to
currencies, while non-joined symbols appearing after the amount refer
to commodities.  Here are some valid currency and commodity
specifiers:
</p>
<div class="smallexample">
<pre class="smallexample">$20.00         ; currency: twenty US dollars
40 AAPL        ; commodity: 40 shares of Apple stock
60 DM          ; currency: 60 Deutsch Mark
50            ; currency: 50 British pounds
50 EUR         ; currency: 50 Euros (or use appropriate symbol)
</pre></div>

<p>Ledger will examine the first use of any commodity to determine how
that commodity should be printed on reports.  It pays attention to
whether the name of commodity was separated from the amount, whether
it came before or after, the precision used in specifying the amount,
whether thousand marks were used, etc.  This is done so that printing
the commodity looks the same as the way you use it.
</p>
<p>An account may contain multiple commodities, in which case it will
have separate totals for each.  For example, if your brokerage account
contains both cash, gold, and several stock quantities, the balance
might look like:
</p>
<div class="smallexample">
<pre class="smallexample">  $200.00
100.00 AU
  AAPL 40
 BORL 100
 FEQTX 50  Assets:Brokerage
</pre></div>

<p>This balance report shows how much of each commodity is in your
brokerage account.
</p>
<p>Sometimes, you will want to know the current street value of your
balance, and not the commodity totals.  For this to happen, you must
specify what the current price is for each commodity.  The price can
be any commodity, in which case the balance will be computed in terms
of that commodity.  The usual way to specify prices is with a price
history file, which might look like this:
</p>
<div class="smallexample">
<pre class="smallexample">P 2004/06/21 02:18:01 FEQTX $22.49
P 2004/06/21 02:18:01 BORL $6.20
P 2004/06/21 02:18:02 AAPL $32.91
P 2004/06/21 02:18:02 AU $400.00
</pre></div>

<a name="index-_002d_002dprice_002ddb-FILE"></a>
<a name="index-_002d_002dmarket"></a>
<p>Specify the price history to use with the <samp>--price-db <var>FILE</var></samp>
option, with the <samp>--market (-V)</samp> option to report in terms of
current market value:
</p>
<div class="smallexample">
<pre class="smallexample">$ ledger --price-db prices.db -V balance brokerage
</pre></div>

<p>The balance for your brokerage account will be reported in US dollars,
since the prices database uses that currency.
</p>
<div class="smallexample">
<pre class="smallexample">$40880.00  Assets:Brokerage
</pre></div>

<p>You can convert from any commodity to any other commodity.  Let&rsquo;s say
you had $5000 in your checking account, and for whatever reason you
wanted to know how many ounces of gold that would buy, in terms of the
current price of gold:
</p>
<div class="smallexample">
<pre class="smallexample">$ ledger -T &quot;{1 AU}*(O/P{1 AU})&quot; balance checking
</pre></div>

<p>Although the total expression appears complex, it is simply saying
that the reported total should be in multiples of AU units, where the
quantity is the account total divided by the price of one AU.  Without
the initial multiplication, the reported total would still use the
dollars commodity, since multiplying or dividing amounts always keeps
the left value&rsquo;s commodity.  The result of this command might be:
</p>
<div class="smallexample">
<pre class="smallexample">14.01 AU  Assets:Checking
</pre></div>

<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top">&bull; <a href="#Commodity-price-histories" accesskey="1">Commodity price histories</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Commodity-equivalences" accesskey="2">Commodity equivalences</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
</table>

<hr>
<a name="Commodity-price-histories"></a>
<div class="header">
<p>
Next: <a href="#Commodity-equivalences" accesskey="n" rel="next">Commodity equivalences</a>, Previous: <a href="#Commodities-and-Currencies" accesskey="p" rel="prev">Commodities and Currencies</a>, Up: <a href="#Commodities-and-Currencies" accesskey="u" rel="up">Commodities and Currencies</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Commodity-price-histories-1"></a>
<h4 class="subsection">3.4.1 Commodity price histories</h4>

<p>Whenever a commodity is purchased using a different commodity (such as
a share of common stock using dollars), it establishes a price for
that commodity on that day.  It is also possible, by recording price
details in a ledger file, to specify other prices for commodities at
any given time.  Such price transactions might look like those below:
</p>
<div class="smallexample">
<pre class="smallexample">P 2004/06/21 02:17:58 TWCUX $27.76
P 2004/06/21 02:17:59 AGTHX $25.41
P 2004/06/21 02:18:00 OPTFX $39.31
P 2004/06/21 02:18:01 FEQTX $22.49
P 2004/06/21 02:18:02 AAPL $32.91
</pre></div>

<p>By default, ledger will not consider commodity prices when generating
its various reports.  It will always report balances in terms of the
commodity total, rather than the current value of those commodities.
To enable pricing reports, use one of the commodity reporting options.
</p>
<hr>
<a name="Commodity-equivalences"></a>
<div class="header">
<p>
Previous: <a href="#Commodity-price-histories" accesskey="p" rel="prev">Commodity price histories</a>, Up: <a href="#Commodities-and-Currencies" accesskey="u" rel="up">Commodities and Currencies</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Commodity-equivalences-1"></a>
<h4 class="subsection">3.4.2 Commodity equivalences</h4>

<p>Sometimes a commodity has several forms which are all equivalent.  An
example of this is time.  Whether tracked in terms of minutes, hours
or days, it should be possible to convert between the various forms.
Doing this requires the use of commodity equivalences.
</p>
<p>For example, you might have the following two postings, one which
transfers an hour of time into a &lsquo;<samp>Billable</samp>&rsquo; account, and another
which decreases the same account by ten minutes.  The resulting report
will indicate that fifty minutes remain:
</p>
<div class="smallexample">
<pre class="smallexample">2005/10/01 Work done for company
    Billable:Client                 1h
    Project:XYZ

2005/10/02 Return ten minutes to the project
    Project:XYZ                    10m
    Billable:Client
</pre></div>

<p>Reporting the balance for this ledger file produces:
</p>
<div class="smallexample">
<pre class="smallexample">$ ledger --no-total balance Billable Project
</pre></div>

<div class="smallexample">
<pre class="smallexample">               50.0m  Billable:Client
              -50.0m  Project:XYZ
</pre></div>

<a name="index-C"></a>

<p>This example works because ledger already knows how to handle seconds,
minutes and hours, as part of its time tracking support.  Defining
other equivalences is simple.  The following is an example that
creates data equivalences, helpful for tracking bytes, kilobytes,
megabytes, and more:
</p>
<div class="smallexample">
<pre class="smallexample">C 1.00 Kb = 1024 b
C 1.00 Mb = 1024 Kb
C 1.00 Gb = 1024 Mb
C 1.00 Tb = 1024 Gb
</pre></div>

<p>Each of these definitions correlates a commodity (such as &lsquo;<samp>Kb</samp>&rsquo;)
and a default precision, with a certain quantity of another commodity.
In the above example, kilobytes are reported with two decimal places
of precision and each kilobyte is equal to 1024 bytes.
</p>
<p>Equivalence chains can be as long as desired.  Whenever a commodity
would report as a decimal amount (less than &lsquo;<samp>1.00</samp>&rsquo;), the next
smallest commodity is used.  If a commodity could be reported in terms
of a higher commodity without resulting to a partial fraction, then
the larger commodity is used.
</p>
<hr>
<a name="Accounts-and-Inventories"></a>
<div class="header">
<p>
Next: <a href="#Understanding-Equity" accesskey="n" rel="next">Understanding Equity</a>, Previous: <a href="#Commodities-and-Currencies" accesskey="p" rel="prev">Commodities and Currencies</a>, Up: <a href="#Principles-of-Accounting-with-Ledger" accesskey="u" rel="up">Principles of Accounting with Ledger</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Accounts-and-Inventories-1"></a>
<h3 class="section">3.5 Accounts and Inventories</h3>

<p>Since Ledger&rsquo;s accounts and commodity system is so flexible, you can
have accounts that don&rsquo;t really exist, and use commodities that no one
else recognizes.  For example, let&rsquo;s say you are buying and selling
various items in EverQuest, and want to keep track of them using a
ledger.  Just add items of whatever quantity you wish into your
EverQuest account:
</p>
<div class="smallexample">
<pre class="smallexample">9/29  Get some stuff at the Inn
    Places:Black's Tavern                   -3 Apples
    Places:Black's Tavern                   -5 Steaks
    EverQuest:Inventory
</pre></div>

<p>Now your EverQuest:Inventory has 3 apples and 5 steaks in it.  The
amounts are negative, because you are taking <em>from</em> Black&rsquo;s
Tavern in order to add to your Inventory account.  Note that you don&rsquo;t
have to use &lsquo;<samp>Places:Black's Tavern</samp>&rsquo; as the source account.  You
could use &lsquo;<samp>EverQuest:System</samp>&rsquo; to represent the fact that you
acquired them online.  The only purpose for choosing one kind of
source account over another is to generate more informative reports
later on.  The more you know, the better the analysis you can perform.
</p>
<p>If you later sell some of these items to another player, the
transaction would look like:
</p>
<div class="smallexample">
<pre class="smallexample">10/2  Sturm Brightblade
    EverQuest:Inventory                     -2 Steaks
    EverQuest:Inventory                     15 Gold
</pre></div>

<p>Now you&rsquo;ve turned 2 steaks into 15 gold, courtesy of your customer,
Sturm Brightblade.
</p>
<div class="smallexample">
<pre class="smallexample">$ ledger balance EverQuest
</pre></div>

<div class="smallexample">
<pre class="smallexample">            3 Apples
             15 Gold
            3 Steaks  EverQuest:Inventory
</pre></div>

<hr>
<a name="Understanding-Equity"></a>
<div class="header">
<p>
Next: <a href="#Dealing-with-Petty-Cash" accesskey="n" rel="next">Dealing with Petty Cash</a>, Previous: <a href="#Accounts-and-Inventories" accesskey="p" rel="prev">Accounts and Inventories</a>, Up: <a href="#Principles-of-Accounting-with-Ledger" accesskey="u" rel="up">Principles of Accounting with Ledger</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Understanding-Equity-1"></a>
<h3 class="section">3.6 Understanding Equity</h3>

<p>The most confusing transaction in any ledger will be your equity
account&mdash;because starting balances can&rsquo;t come out of nowhere.
</p>
<p>When you first start your ledger, you will likely already have money
in some of your accounts.  Let&rsquo;s say there&rsquo;s $100 in your checking
account; then add a transaction to your ledger to reflect this amount.
Where will the money come from?  The answer: your equity.
</p>
<div class="smallexample">
<pre class="smallexample">10/2  Opening Balance
    Assets:Checking                         $100.00
    Equity:Opening Balances
</pre></div>

<p>But what is equity?  You may have heard of equity when people talked
about house mortgages, as &ldquo;the part of the house that you own&rdquo;.
Basically, equity is like the value of something.  If you own a car
worth $5000, then you have $5000 in equity in that car.  In order to
turn that car (a commodity) into a cash flow, or a credit to your bank
account, you will have to debit the equity by selling it.
</p>
<p>When you start a ledger, you probably already have a net worth.
Your net worth is your current equity.  By transferring the money in
the ledger from your equity to your bank accounts, you are crediting
the ledger account based on your prior equity.  That is why, when you
look at the balance report, you will see a large negative number for
Equity that never changes: Because that is what you were worth (what
you debited from yourself in order to start the ledger) before the
money started moving around.  If the total positive value of your
assets is greater than the absolute value of your starting equity, it
means you are making money.
</p>
<p>Clear as mud?  Keep thinking about it.  Until you figure it out, put
<code>not Equity</code> at the end of your balance command, to remove the
confusing figure from the total.
</p>
<hr>
<a name="Dealing-with-Petty-Cash"></a>
<div class="header">
<p>
Next: <a href="#Working-with-multiple-funds-and-accounts" accesskey="n" rel="next">Working with multiple funds and accounts</a>, Previous: <a href="#Understanding-Equity" accesskey="p" rel="prev">Understanding Equity</a>, Up: <a href="#Principles-of-Accounting-with-Ledger" accesskey="u" rel="up">Principles of Accounting with Ledger</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Dealing-with-Petty-Cash-1"></a>
<h3 class="section">3.7 Dealing with Petty Cash</h3>

<p>Something that stops many people from keeping a ledger at all is the
insanity of tracking small cash expenses.  They rarely generate a
receipt, and there are often a lot of small postings, rather than
a few large ones, as with checks.
</p>
<p>One solution is: don&rsquo;t bother.  Move your spending to a debit card,
but in general ignore cash.  Once you withdraw it from the ATM, mark
it as already spent to an &lsquo;<samp>Expenses:Cash</samp>&rsquo; category:
</p>
<div class="smallexample">
<pre class="smallexample">2004/03/15 ATM
    Expenses:Cash                      $100.00
    Assets:Checking
</pre></div>

<p>If at some point you make a large cash expense that you want to track,
just <em>move</em> the amount of the expense from &lsquo;<samp>Expenses:Cash</samp>&rsquo;
into the target account:
</p>
<div class="smallexample">
<pre class="smallexample">2004/03/20 Somebody
    Expenses:Food                       $65.00
    Expenses:Cash
</pre></div>

<p>This way, you can still track large cash expenses, while ignoring all
of the smaller ones.
</p>
<hr>
<a name="Working-with-multiple-funds-and-accounts"></a>
<div class="header">
<p>
Previous: <a href="#Dealing-with-Petty-Cash" accesskey="p" rel="prev">Dealing with Petty Cash</a>, Up: <a href="#Principles-of-Accounting-with-Ledger" accesskey="u" rel="up">Principles of Accounting with Ledger</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Working-with-multiple-funds-and-accounts-1"></a>
<h3 class="section">3.8 Working with multiple funds and accounts</h3>

<p>There are situations when the accounts you&rsquo;re tracking are different
between your clients and the financial institutions where money is
kept.  An example of this is working as the treasurer for a religious
institution.  From the secular point of view, you might be working
with three different accounts:
</p>
<ul>
<li> Checking
</li><li> Savings
</li><li> Credit Card
</li></ul>

<p>From a religious point of view, the community expects to divide its
resources into multiple &ldquo;funds&rdquo;, from which it makes purchases or
reserves resources for later:
</p>
<ul>
<li> School fund
</li><li> Building fund
</li><li> Community fund
</li></ul>

<p>The problem with this kind of setup is that, when you spend money, it
comes from two or more places at once: the account and the fund.  And
yet, the correlation of amounts between funds and accounts is rarely
one-to-one.  What if the school fund has &lsquo;<samp>$500.00</samp>&rsquo;, but
&lsquo;<samp>$400.00</samp>&rsquo; of that comes from Checking, and &lsquo;<samp>$100.00</samp>&rsquo; from
Savings?
</p>
<p>Traditional finance packages require that the money reside in only one
place.  But there are really two &ldquo;views&rdquo; of the data: from the
account point of view and from the fund point of view&mdash;yet both sets
should reflect the same overall expenses and cash flow.  It&rsquo;s simply
where the money resides that differs.
</p>
<p>This situation can be handled in one of two ways.  The first is using
virtual postings to represent the fact that money is moving to and
from two kind of accounts at the same time:
</p>
<div class="smallexample">
<pre class="smallexample">2004/03/20 Contributions
    Assets:Checking                    $500.00
    Income:Donations

2004/03/25 Distribution of donations
    [Funds:School]                     $300.00
    [Funds:Building]                   $200.00
    [Assets:Checking]                 $-500.00
</pre></div>

<p>The use of square brackets in the second transaction ensures that the
virtual postings balance to zero.  Now money can be spent directly
from a fund at the same time as money is drawn from a physical
account:
</p>
<div class="smallexample">
<pre class="smallexample">2004/03/25 Payment for books (paid from Checking)
    Expenses:Books                    $100.00
    Assets:Checking                  $-100.00
    (Funds:School)                   $-100.00
</pre></div>

<p>When reports are generated, by default they&rsquo;ll appear in terms of the
funds.  In this case, you will likely want to mask out your
&lsquo;<samp>Assets</samp>&rsquo; account, because otherwise the balance won&rsquo;t make much
sense:
</p>
<div class="smallexample">
<pre class="smallexample">$ ledger --no-total bal not ^Assets
</pre></div>

<div class="smallexample">
<pre class="smallexample">             $100.00  Expenses:Books
             $400.00  Funds
             $200.00    Building
             $200.00    School
            $-500.00  Income:Donations
</pre></div>

<a name="index-_002d_002dreal"></a>
<p>If the <samp>--real</samp> option is used, the report will be in terms of
the real accounts:
</p>
<div class="smallexample">
<pre class="smallexample">$ ledger --real --no-total bal
</pre></div>

<div class="smallexample">
<pre class="smallexample">             $400.00  Assets:Checking
             $100.00  Expenses:Books
            $-500.00  Income:Donations
</pre></div>

<p>If more asset accounts are needed as the source of a posting, just
list them as you would normally, for example:
</p>
<div class="smallexample">
<pre class="smallexample">2004/03/25 Payment for books (paid from Checking)
    Expenses:Books                    $100.00
    Assets:Checking                   $-50.00
    Liabilities:Credit Card           $-50.00
    (Funds:School)                   $-100.00
</pre></div>

<p>The second way of tracking funds is to use transaction codes.  In this
respect the codes become like virtual accounts that embrace the entire
set of postings.  Basically, we are associating a transaction with a
fund by setting its code.  Here are two transactions that deposit money
into, and spend money from, the &lsquo;<samp>Funds:School</samp>&rsquo; fund:
</p>
<div class="smallexample">
<pre class="smallexample">2004/03/25 (Funds:School) Donations
    Assets:Checking                   $100.00
    Income:Donations

2004/03/25 (Funds:Building) Donations
    Assets:Checking                   $20.00
    Income:Donations

2004/04/25 (Funds:School) Payment for books
    Expenses:Books                     $50.00
    Assets:Checking
</pre></div>

<p>Note how the accounts now relate only to the real accounts, and any
balance or register reports will reflect this.  That the transactions
relate to a particular fund is kept only in the code.
</p>
<a name="index-_002d_002dpayee_003dcode"></a>
<a name="index-_002d_002dby_002dpayee"></a>
<p>How does this become a fund report?  By using the
<samp>--payee=code</samp> option, you can generate a register report
where the payee for each posting shows the code.  Alone, this is not
terribly interesting; but when combined with the <samp>--by-payee
(-P)</samp> option, you will now see account subtotals for any postings
related to a specific fund.  So, to see the current monetary balances of
all funds, the command would be:
</p>
<div class="smallexample">
<pre class="smallexample">$ ledger --payee=code -P reg ^Assets
</pre></div>

<div class="smallexample">
<pre class="smallexample">04-Mar-25 Funds:Building        Assets:Checking              $20.00       $20.00
04-Mar-25 Funds:School          Assets:Checking              $50.00       $70.00
</pre></div>

<p>Or to see a particular fund&rsquo;s expenses, the &lsquo;<samp>School</samp>&rsquo; fund in this
case:
</p>
<div class="smallexample">
<pre class="smallexample">$ ledger --payee=code -P reg ^Expenses and code School
</pre></div>

<div class="smallexample">
<pre class="smallexample">04-Apr-25 Funds:School          Expenses:Books               $50.00       $50.00
</pre></div>

<p>Both approaches yield different kinds of flexibility, depending on how
you prefer to think of your funds: as virtual accounts, or as tags
associated with particular transactions.  Your own tastes will decide
which is best for your situation.
</p>
<hr>
<a name="Keeping-a-Journal"></a>
<div class="header">
<p>
Next: <a href="#Transactions" accesskey="n" rel="next">Transactions</a>, Previous: <a href="#Principles-of-Accounting-with-Ledger" accesskey="p" rel="prev">Principles of Accounting with Ledger</a>, Up: <a href="#Top" accesskey="u" rel="up">Top</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Keeping-a-Journal-1"></a>
<h2 class="chapter">4 Keeping a Journal</h2>

<p>The most important part of accounting is keeping a good journal.  If
you have a good journal, tools can be written to work whatever
mathematical tricks you need to better understand your spending
patterns.  Without a good journal, no tool, however smart, can help
you.
</p>
<p>The Ledger program aims at making journal transactions as simple as
possible.  Since it is a command-line tool, it does not provide a user
interface for keeping a journal. If you require an user interface to
maintain journal transactions GnuCash is a good alternative.
</p>
<p>If you are not using GnuCash, but a text editor to maintain your
journal, read on.  Ledger has been designed to make data transactions
as simple as possible, by keeping the journal format easy, and also by
automagically determining as much information as possible based on the
nature of your transactions.
</p>
<p>For example, you do not need to tell Ledger about the accounts you
use.  Any time Ledger sees a posting involving an account it knows
nothing about, it will create it<a name="DOCF2" href="#FOOT2"><sup>2</sup></a>.  If you
use a commodity that is new to Ledger, it will create that commodity,
and determine its display characteristics (placement of the symbol
before or after the amount, display precision, etc.) based on how you
used the commodity in the posting.
</p>
<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top">&bull; <a href="#The-Most-Basic-Entry" accesskey="1">The Most Basic Entry</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Starting-up" accesskey="2">Starting up</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Structuring-your-Accounts" accesskey="3">Structuring your Accounts</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Commenting-on-your-Journal" accesskey="4">Commenting on your Journal</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Currency-and-Commodities" accesskey="5">Currency and Commodities</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Keeping-it-Consistent" accesskey="6">Keeping it Consistent</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Journal-Format" accesskey="7">Journal Format</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Converting-from-other-formats" accesskey="8">Converting from other formats</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Archiving-Previous-Years" accesskey="9">Archiving Previous Years</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
</table>

<hr>
<a name="The-Most-Basic-Entry"></a>
<div class="header">
<p>
Next: <a href="#Starting-up" accesskey="n" rel="next">Starting up</a>, Previous: <a href="#Keeping-a-Journal" accesskey="p" rel="prev">Keeping a Journal</a>, Up: <a href="#Keeping-a-Journal" accesskey="u" rel="up">Keeping a Journal</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="The-Most-Basic-Entry-1"></a>
<h3 class="section">4.1 The Most Basic Entry</h3>

<p>Here is the Pacific Bell example from above, given as a Ledger
posting, with the addition of a check number:
</p>
<div class="smallexample">
<pre class="smallexample">9/29 (1023) Pacific Bell
    Expenses:Utilities:Phone                   $23.00
    Assets:Checking                           $-23.00
</pre></div>

<p>As you can see, it is very similar to what would be written on paper,
minus the computed balance totals, and adding in account names that
work better with Ledger&rsquo;s scheme of things.  In fact, since Ledger is
smart about many things, you don&rsquo;t need to specify the balanced
amount, if it is the same as the first line:
</p>
<div class="smallexample">
<pre class="smallexample">9/29 (1023) Pacific Bell
    Expenses:Utilities:Phone                   $23.00
    Assets:Checking
</pre></div>

<p>For this transaction, Ledger will figure out that $-23.00 must come
from &lsquo;<samp>Assets:Checking</samp>&rsquo; in order to balance the transaction.
</p>
<p>Also note the structure of the account entries.  There is an implied
hierarchy established by separating with colons (see <a href="#Structuring-your-Accounts">Structuring your Accounts</a>).
</p>
<a name="index-spaces-in-postings"></a>
<a name="index-posting-format-details"></a>

<p><strong>The format is very flexible and it isn&rsquo;t necessary that you
indent and space out things exactly as shown.  The only requirements
are that the start of the transaction (the date typically) is at the
beginning of the first line of the transaction, and the accounts are
indented by at least one space.  If you omit the leading spaces in the
account lines Ledger will generate an error.  There must be at least
two spaces, or a tab, between the amount and the account.  If you do
not have adequate separation between the amount and the account Ledger
will give an error and stop calculating.</strong>
</p>
<hr>
<a name="Starting-up"></a>
<div class="header">
<p>
Next: <a href="#Structuring-your-Accounts" accesskey="n" rel="next">Structuring your Accounts</a>, Previous: <a href="#The-Most-Basic-Entry" accesskey="p" rel="prev">The Most Basic Entry</a>, Up: <a href="#Keeping-a-Journal" accesskey="u" rel="up">Keeping a Journal</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Starting-up-1"></a>
<h3 class="section">4.2 Starting up</h3>
<a name="index-initial-equity"></a>
<a name="index-beginning-ledger"></a>
<a name="index-opening-balance"></a>

<p>Unless you have recently arrived from another planet, you already have
a financial state.  You need to capture that financial state so that
Ledger has a starting point.
</p>
<p>At some convenient point in time you knew the balances and outstanding
obligation of every financial account you have.  Those amounts form the
basis of the opening entry for ledger.  For example if you chose the
beginning of 2011 as the date to start tracking finances with ledger,
your opening balance entry could look like this:
</p>
<div class="smallexample">
<pre class="smallexample">2011/01/01 * Opening Balance
    Assets:Joint Checking                   $800.14
    Assets:Other Checking                    $63.44
    Assets:Savings                         $2805.54
    Assets:Investments:401K:Deferred         100.0000 VIFSX @ $80.5227
    Assets:Investments:401K:Matching          50.0000 VIFSX @ $83.7015
    Assets:Investments:IRA                   250.0000 VTHRX @ $20.5324
    Liabilities:Mortgage                $-175634.88
    Liabilities:Car Loan                  $-3494.26
    Liabilities:Visa                      -$1762.44
    Equity:Opening Balances
</pre></div>

<p>There is nothing special about the name &ldquo;Opening Balances&rdquo; as the
payee of the account name, anything convenient that you understand will
work.
</p>
<hr>
<a name="Structuring-your-Accounts"></a>
<div class="header">
<p>
Next: <a href="#Commenting-on-your-Journal" accesskey="n" rel="next">Commenting on your Journal</a>, Previous: <a href="#Starting-up" accesskey="p" rel="prev">Starting up</a>, Up: <a href="#Keeping-a-Journal" accesskey="u" rel="up">Keeping a Journal</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Structuring-your-Accounts-1"></a>
<h3 class="section">4.3 Structuring your Accounts</h3>
<a name="index-accounts_002c-naming"></a>
<a name="index-naming-accounts"></a>

<p>There really are no requirements for how you do this, but to preserve
your sanity we suggest some very basic structure to your accounting
system.
</p>
<p>At the highest level you have five sorts of accounts:
</p>
<ol>
<li> Expenses: where money goes,
</li><li> Assets: where money sits,
</li><li> Income: where money comes from,
</li><li> Liabilities: money you owe,
</li><li> Equity: the real value of your property.
</li></ol>

<p>Starting the structure off this way will make it simpler for you to get
answers to the questions you really need to ask about your finances.
</p>
<p>Beneath these top level accounts you can have any level of detail you
desire.  For example, if you want to keep specific track of how much
you spend on burgers and fries, you could have the following:
</p>
<div class="smallexample">
<pre class="smallexample">Expenses:Food:Hamburgers and Fries
</pre></div>

<hr>
<a name="Commenting-on-your-Journal"></a>
<div class="header">
<p>
Next: <a href="#Currency-and-Commodities" accesskey="n" rel="next">Currency and Commodities</a>, Previous: <a href="#Structuring-your-Accounts" accesskey="p" rel="prev">Structuring your Accounts</a>, Up: <a href="#Keeping-a-Journal" accesskey="u" rel="up">Keeping a Journal</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Commenting-on-your-Journal-1"></a>
<h3 class="section">4.4 Commenting on your Journal</h3>
<a name="index-comments_002c-characters"></a>
<a name="index-block-comments"></a>
<a name="index-comments_002c-block"></a>

<p>Comments are generally started using a &lsquo;<samp>;</samp>&rsquo;.  However, in order to
increase compatibility with other text manipulation programs and
methods, four additional comment characters are valid if used at the
beginning of a line: &lsquo;<samp>#</samp>&rsquo;, &lsquo;<samp>|</samp>&rsquo;, and &lsquo;<samp>*</samp>&rsquo; and &lsquo;<samp>%</samp>&rsquo;.
</p>
<p>Block comments can be made by use <code>comment</code> ... <code>end
comment</code>.
</p>
<div class="smallexample">
<pre class="smallexample">; This is a single line comment,
#  and this,
%   and this,
|    and this,
*     and this.

comment
    This is a block comment with
    multiple lines
end comment
</pre></div>

<p>There are several forms of comments within a transaction, for example:
</p>
<div class="smallexample">
<pre class="smallexample">; this is a global comment that is not applied to a specific transaction
; it can start with any of the five characters but is not included in the
; output from 'print' or 'output'

2011/12/11  Something Sweet
    ; German Chocolate Cake
    ; :Broke Diet:
    Expenses:Food                  $10.00 ; Friends: The gang
    Assets:Credit Union:Checking
</pre></div>

<p>The first comment is global and Ledger will not attach it to any
specific transactions.  The comments within the transaction must all
start with &lsquo;<samp>;</samp>&rsquo; and are preserved as part of the transaction.  The
&lsquo;<samp>:</samp>&rsquo; indicates meta-data and tags (see <a href="#Metadata">Metadata</a>).
</p>
<hr>
<a name="Currency-and-Commodities"></a>
<div class="header">
<p>
Next: <a href="#Keeping-it-Consistent" accesskey="n" rel="next">Keeping it Consistent</a>, Previous: <a href="#Commenting-on-your-Journal" accesskey="p" rel="prev">Commenting on your Journal</a>, Up: <a href="#Keeping-a-Journal" accesskey="u" rel="up">Keeping a Journal</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Currency-and-Commodities-1"></a>
<h3 class="section">4.5 Currency and Commodities</h3>
<a name="index-currency"></a>
<a name="index-commodity"></a>

<p>Ledger is agnostic when it comes to how you value your accounts.
Dollars, Euros, Pounds, Francs, Shares etc. are all just &ldquo;commodities&rdquo;.
Holdings in stocks, bonds, mutual funds and other financial
instruments can be labeled using whatever is convenient for you (stock
ticker symbols are suggested for publicly traded assets).<a name="DOCF3" href="#FOOT3"><sup>3</sup></a>
</p>
<p>For the rest of this manual, we will only use the word &ldquo;commodities&rdquo;
when referring to the units on a transaction value.
</p>
<p>This is fundamentally different than many common accounting packages,
which assume the same currency throughout all of your accounts.  This
means if you typically operate in Euros, but travel to the US and have
some expenses, you would have to do the currency conversion
<em>before</em> you made the entry into your financial system.  With
ledger this is not required.  In the same journal you can have entries
in any or all commodities you actually hold.  You can use the
reporting capabilities to convert all commodities to a single
commodity for reporting purposes without ever changing the underlying
entry.
</p>
<p>For example, the following entries reflect transactions made for a
business trip to Europe from the US:
</p>
<div class="smallexample">
<pre class="smallexample">2011/09/23 Cash in Munich
    Assets:Cash                               50.00
    Assets:Checking                          $-66.00

2011/09/24 Dinner in Munich
    Expenses:Business:Travel                  35.00
    Assets:Cash
</pre></div>

<p>This says that $66.00 came out of checking and turned into 50
Euros.  The implied exchange rate was $1.32.  Then 35.00 Euros were
spent on Dinner in Munich.
</p>
<p>Running a ledger balance report shows:
</p>
<div class="smallexample">
<pre class="smallexample">$ ledger -f example.dat bal
</pre></div>

<div class="smallexample">
<pre class="smallexample">             $-66.00
              15.00  Assets
              15.00    Cash
             $-66.00    Checking
              35.00  Expenses:Business:Travel
--------------------
             $-66.00
              50.00
</pre></div>

<p>The top two lines show my current assets as $-66.00 in checking (in
this very short example I didn&rsquo;t establish opening an opening balance
for the checking account) and 15.00.  After spending on dinner I have
15.00 in my wallet.  The bottom line balances to zero, but is shown
in two lines since we haven&rsquo;t told ledger to convert commodities.
</p>
<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top">&bull; <a href="#Naming-Commodities" accesskey="1">Naming Commodities</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Buying-and-Selling-Stock" accesskey="2">Buying and Selling Stock</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Fixing-Lot-Prices" accesskey="3">Fixing Lot Prices</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Complete-control-over-commodity-pricing" accesskey="4">Complete control over commodity pricing</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
</table>

<hr>
<a name="Naming-Commodities"></a>
<div class="header">
<p>
Next: <a href="#Buying-and-Selling-Stock" accesskey="n" rel="next">Buying and Selling Stock</a>, Previous: <a href="#Currency-and-Commodities" accesskey="p" rel="prev">Currency and Commodities</a>, Up: <a href="#Currency-and-Commodities" accesskey="u" rel="up">Currency and Commodities</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Naming-Commodities-1"></a>
<h4 class="subsection">4.5.1 Naming Commodities</h4>

<p>Commodity names can have any character, including white-space.
However, if you include white-space or numeric characters, the
commodity name must be enclosed in double quotes &lsquo;<samp>&quot;</samp>&rsquo;:
</p>
<div class="smallexample">
<pre class="smallexample">1999/06/09 ! Achat
    Actif:SG PEE STK         49.957 &quot;Arcancia quilibre 454&quot;
    Actif:SG PEE STK      $-234.90

2000/12/08 ! Achat
    Actif:SG PEE STK        215.796 &quot;Arcancia quilibre 455&quot;
    Actif:SG PEE STK    $-10742.54
</pre></div>

<hr>
<a name="Buying-and-Selling-Stock"></a>
<div class="header">
<p>
Next: <a href="#Fixing-Lot-Prices" accesskey="n" rel="next">Fixing Lot Prices</a>, Previous: <a href="#Naming-Commodities" accesskey="p" rel="prev">Naming Commodities</a>, Up: <a href="#Currency-and-Commodities" accesskey="u" rel="up">Currency and Commodities</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Buying-and-Selling-Stock-1"></a>
<h4 class="subsection">4.5.2 Buying and Selling Stock</h4>
<a name="index-buying-stock"></a>

<p>Buying stock is a typical example that many will use that involves
multiple commodities in the same transaction.  The type of the share
(AAPL for Apple Inc.) and the share purchase price in the currency
unit you made the purchase in ($ for AAPL).  Yes, the typical
convention is as follows:
</p>
<div class="smallexample">
<pre class="smallexample">2004/05/01 Stock purchase
    Assets:Broker                     50 AAPL @ $30.00
    Expenses:Broker:Commissions        $19.95
    Assets:Broker                  $-1,519.95
</pre></div>

<p>This assumes you have a brokerage account that is capable of managing
both liquid and commodity assets.  Now, on the day of the sale:
</p>
<div class="smallexample">
<pre class="smallexample">2005/08/01 Stock sale
    Assets:Broker                    -50 AAPL {$30.00} @ $50.00
    Expenses:Broker:Commissions        $19.95
    Income:Capital Gains           $-1,000.00
    Assets:Broker                   $2,480.05
</pre></div>

<p>You can, of course, elide the amount of the last posting.  It is there
for clarity&rsquo;s sake.
</p>
<p>The &lsquo;<samp>{$30.00}</samp>&rsquo; is a lot price.  You can also use a lot date,
&lsquo;<samp>[2004/05/01]</samp>&rsquo;, or both, in case you have several lots of the
same price/date and your taxation model is based on
longest-held-first.
</p>
<hr>
<a name="Fixing-Lot-Prices"></a>
<div class="header">
<p>
Next: <a href="#Complete-control-over-commodity-pricing" accesskey="n" rel="next">Complete control over commodity pricing</a>, Previous: <a href="#Buying-and-Selling-Stock" accesskey="p" rel="prev">Buying and Selling Stock</a>, Up: <a href="#Currency-and-Commodities" accesskey="u" rel="up">Currency and Commodities</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Fixing-Lot-Prices-1"></a>
<h4 class="subsection">4.5.3 Fixing Lot Prices</h4>
<a name="index-fixing-lot-prices"></a>
<a name="index-consumable-commodity-pricing"></a>

<p>Commodities that you keep in order to sell at a later time have
a variable value that fluctuates with the market prices.  Commodities
that you consume should not fluctuate in value, but stay at the lot
price they were purchased at.  As an extension of &ldquo;lot pricing&rdquo;, you
can fix the per-unit price of a commodity.
</p>
<p>For example, say you buy 10 gallons of gas at $1.20.  In future
&ldquo;value&rdquo; reports, you don&rsquo;t want these gallons reported in terms of
today&rsquo;s price, but rather the price when you bought it.  At the same
time, you also want other kinds of commodities&mdash;like stocks&mdash;
reported in terms of today&rsquo;s price.
</p>
<p>This is supported as follows:
</p>
<div class="smallexample">
<pre class="smallexample">2009/01/01 Shell
    Expenses:Gasoline             11 GAL {=$2.299}
    Assets:Checking
</pre></div>

<p>This transaction actually introduces a new commodity, &lsquo;<samp>GAL
{=$2.29}</samp>&rsquo;, whose market value disregards any future changes in the
price of gasoline.
</p>
<p>If you do not want price fixing, you can specify this same transaction
in one of two ways, both equivalent (note the lack of the equal sign
compared to the transaction above):
</p>
<div class="smallexample">
<pre class="smallexample">2009/01/01 Shell
    Expenses:Gasoline             11 GAL {$2.299}
    Assets:Checking

2009/01/01 Shell
    Expenses:Gasoline             11 GAL @ $2.299
    Assets:Checking
</pre></div>

<p>There is no difference in meaning between these two forms.  Why do
both exist, you ask?  To support things like this:
</p>
<div class="smallexample">
<pre class="smallexample">2009/01/01 Shell
    Expenses:Gasoline             11 GAL {=$2.299} @ $2.30
    Assets:Checking
</pre></div>

<p>This transaction says that you bought 11 gallons priced at $2.299 per
gallon at a <em>cost to you</em> of $2.30 per gallon.  Ledger
auto-generates a balance posting in this case to Equity:Capital Losses
to reflect the 1.1 cent difference, which is then balanced by
Assets:Checking because its amount is null.
</p>
<hr>
<a name="Complete-control-over-commodity-pricing"></a>
<div class="header">
<p>
Previous: <a href="#Fixing-Lot-Prices" accesskey="p" rel="prev">Fixing Lot Prices</a>, Up: <a href="#Currency-and-Commodities" accesskey="u" rel="up">Currency and Commodities</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Complete-control-over-commodity-pricing-1"></a>
<h4 class="subsection">4.5.4 Complete control over commodity pricing</h4>
<a name="index-_002d_002dmarket-1"></a>
<a name="index-_002d_002dexchange-COMMODITY"></a>

<p>Ledger allows you to have very detailed control over how your
commodities are valued.  You can fine tune the results given using the
<samp>--market</samp> or <samp>--exchange <var>COMMODITY</var></samp> options.  There
are now several points of interception; you can specify the valuation
method:
</p>
<ol>
<li> on a commodity itself,
</li><li> on a posting, via metadata (effect is largely the same as #1),
</li><li> on an xact, which then applies to all postings in that xact,
</li><li> on any posting via an automated transaction,
</li><li> on a per-account basis,
</li><li> on a per-commodity basis,
</li><li> by changing the journal default of <code>market</code>.
</li></ol>

<p>Fixated pricing (such as &lsquo;<samp>{=$20}</samp>&rsquo;) still plays a role in this
scheme.  As far as valuation goes, it&rsquo;s shorthand for writing
&lsquo;<samp>((s,d,t -&gt; market($20,d,t)))</samp>&rsquo;.
</p>
<p>A valuation function receives three arguments:
</p>
<dl compact="compact">
<dt><code>source</code></dt>
<dd><p>A string identifying the commodity whose price is being asked for
(example: &lsquo;<samp>EUR</samp>&rsquo;).
</p>
</dd>
<dt><code>date</code></dt>
<dd><p>The reference date the price should be relative.
</p>
</dd>
<dt><code>target</code></dt>
<dd><p>A string identifying the &ldquo;target&rdquo; commodity, or the commodity the
returned price should be in.  This argument is null if <samp>--market</samp>
was used instead of <samp>--exchange <var>COMMODITY</var></samp>.
</p>
</dd>
</dl>

<p>The valuation function should return an amount.  If you&rsquo;ve written
your function in Python, you can return something like
&lsquo;<samp>Amount(&quot;$100&quot;)</samp>&rsquo;.  If the function returns an explicit value,
that value is always used, regardless of the commodity, the date, or
the desired target commodity.  For example,
</p>
<div class="smallexample">
<pre class="smallexample">define myfunc_seven(s, d, t) = 7 EUR
</pre></div>

<p>In order to specify a fixed price, but still valuate that price into
the target commodity, use something like this:
</p>
<div class="smallexample">
<pre class="smallexample">define myfunc_five(s, d, t) = market(5 EUR, d, t)
</pre></div>

<p>The <code>value</code> directive sets the valuation used for all commodities
used in the rest of the data stream.  This is the fallback, if nothing
more specific is found.
</p>
<div class="smallexample">
<pre class="smallexample">value myfunc_seven
</pre></div>

<p>You can set a specific valuation function on a per-commodity basis.
Instead of defining a function, you can also pass a lambda.
</p>
<div class="smallexample">
<pre class="smallexample">commodity $
    value s, d, t -&gt; 6 EUR
</pre></div>

<p>Each account can also provide a default valuation function for any
commodities transferred to that account.
</p>
<div class="smallexample">
<pre class="smallexample">account Expenses:Food5
    value myfunc_five
</pre></div>

<p>The metadata field &lsquo;<samp>Value</samp>&rsquo;, if found, overrides the valuation
function on a transaction-wide or per-posting basis.
</p>
<div class="smallexample">
<pre class="smallexample">= @XACT and Food
    ; Value:: 8 EUR
    (Equity)                     $1

= @POST and Dining
    (Expenses:Food9)             $1
        ; Value:: 9 EUR
</pre></div>

<p>Lastly, you can specify the valuation function/value for any specific
amount using the &lsquo;<samp>(( ))</samp>&rsquo; commodity annotation.
</p>
<div class="smallexample">
<pre class="smallexample">2012-03-02 KFC
    Expenses:Food2               $1 ((2 EUR))
    Assets:Cash2

2012-03-03 KFC
    Expenses:Food3               $1
        ; Value:: 3 EUR
    Assets:Cash3

2012-03-04 KFC
    ; Value:: 4 EUR
    Expenses:Food4               $1
    Assets:Cash4

2012-03-05 KFC
    Expenses:Food5               $1
    Assets:Cash5

2012-03-06 KFC
    Expenses:Food6               $1
    Assets:Cash6

2012-03-07 KFC
    Expenses:Food7                1 CAD
    Assets:Cash7

2012-03-08 XACT
    Expenses:Food8               $1
    Assets:Cash8

2012-03-09 POST
    Expenses:Dining9             $1
    Assets:Cash9
</pre></div>

<div class="smallexample">
<pre class="smallexample">$ ledger reg -V food
</pre></div>

<div class="smallexample">
<pre class="smallexample">12-Mar-02 KFC                   Expenses:Food2                2 EUR        2 EUR
12-Mar-03 KFC                   Expenses:Food3                3 EUR        5 EUR
12-Mar-04 KFC                   Expenses:Food4                4 EUR        9 EUR
12-Mar-05 KFC                   Expenses:Food5                   $1           $1
                                                                           9 EUR
12-Mar-06 KFC                   Expenses:Food6                   $1           $2
                                                                           9 EUR
12-Mar-07 KFC                   Expenses:Food7                1 CAD           $2
                                                                           1 CAD
                                                                           9 EUR
12-Mar-08 XACT                  Expenses:Food8                   $1           $3
                                                                           1 CAD
                                                                           9 EUR
</pre></div>

<hr>
<a name="Keeping-it-Consistent"></a>
<div class="header">
<p>
Next: <a href="#Journal-Format" accesskey="n" rel="next">Journal Format</a>, Previous: <a href="#Currency-and-Commodities" accesskey="p" rel="prev">Currency and Commodities</a>, Up: <a href="#Keeping-a-Journal" accesskey="u" rel="up">Keeping a Journal</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Keeping-it-Consistent-1"></a>
<h3 class="section">4.6 Keeping it Consistent</h3>
<a name="index-_002d_002dstrict"></a>
<a name="index-accounts"></a>

<p>Sometimes Ledger&rsquo;s flexibility can lead to difficulties.  Using a
freeform text editor to enter transactions makes it easy to keep the
data, but also easy to enter accounts or payees inconsistently or with
spelling errors.
</p>
<p>In order to combat inconsistency you can define allowable accounts and
payees.  For simplicity, create a separate text file and define accounts
and payees like
</p>
<div class="smallexample">
<pre class="smallexample">account Expenses
account Expenses:Utilities
</pre></div>

<p>Using the <samp>--strict</samp> option will cause Ledger to complain if any
accounts are not previously defined:
</p>
<div class="smallexample">
<pre class="smallexample">$ ledger bal --strict
Warning: &quot;FinanceData/Master.dat&quot;, line 6: Unknown account 'Liabilities:Tithe Owed'
Warning: &quot;FinanceData/Master.dat&quot;, line 8: Unknown account 'Liabilities:Tithe Owed'
Warning: &quot;FinanceData/Master.dat&quot;, line 15: Unknown account 'Allocation:Equities:Domestic'
</pre></div>

<p>If you have a large Ledger register already created use the
<code>accounts</code> command to get started:
</p>
<div class="smallexample">
<pre class="smallexample">$ ledger accounts &gt;&gt; Accounts.dat
</pre></div>

<p>You will have to edit this file to add the <code>account</code> directive in
front of every line.
</p>
<hr>
<a name="Journal-Format"></a>
<div class="header">
<p>
Next: <a href="#Converting-from-other-formats" accesskey="n" rel="next">Converting from other formats</a>, Previous: <a href="#Keeping-it-Consistent" accesskey="p" rel="prev">Keeping it Consistent</a>, Up: <a href="#Keeping-a-Journal" accesskey="u" rel="up">Keeping a Journal</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Journal-Format-1"></a>
<h3 class="section">4.7 Journal Format</h3>

<p>The ledger file format is quite simple, but also very flexible.  It
supports many options, though typically the user can ignore most of
them.  They are summarized below.
</p>
<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top">&bull; <a href="#Transactions-and-Comments" accesskey="1">Transactions and Comments</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Command-Directives" accesskey="2">Command Directives</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
</table>

<hr>
<a name="Transactions-and-Comments"></a>
<div class="header">
<p>
Next: <a href="#Command-Directives" accesskey="n" rel="next">Command Directives</a>, Previous: <a href="#Journal-Format" accesskey="p" rel="prev">Journal Format</a>, Up: <a href="#Journal-Format" accesskey="u" rel="up">Journal Format</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Transactions-and-Comments-1"></a>
<h4 class="subsection">4.7.1 Transactions and Comments</h4>

<p>The initial character of each line determines what the line means, and
how it should be interpreted.  Allowable initial characters are:
</p>
<dl compact="compact">
<dt><code>NUMBER</code></dt>
<dd><p>A line beginning with a number denotes a transaction.  It may be
followed by any number of lines, each beginning with white-space, to
denote the transaction&rsquo;s account postings.  The format of the first
line is:
</p>
<div class="smallexample">
<pre class="smallexample">DATE[=EDATE] [*|!] [(CODE)] DESC
</pre></div>

<p>If &lsquo;<samp>*</samp>&rsquo; appears after the date (with optional effective date), it
indicates the transaction is &ldquo;cleared&rdquo;, which can mean whatever the
user wants it to mean.  If &lsquo;<samp>!</samp>&rsquo; appears after the date, it
indicates the transaction is &ldquo;pending&rdquo;; i.e., tentatively cleared
from the user&rsquo;s point of view, but not yet actually cleared.  If
a <code>CODE</code> appears in parentheses, it may be used to indicate
a check number, or the type of the posting.  Following these is the
payee, or a description of the posting.
</p>
<p>The format of each following posting is:
</p>
<div class="smallexample">
<pre class="smallexample">  ACCOUNT  AMOUNT  [; NOTE]
</pre></div>

<p>The <code>ACCOUNT</code> may be surrounded by parentheses if it is a virtual
posting, or square brackets if it is a virtual posting that
must balance.  The <code>AMOUNT</code> can be followed by a per-unit
posting cost, by specifying <code>@ AMOUNT</code>, or a complete
posting cost with <code>@@ AMOUNT</code>.  Lastly, the <code>NOTE</code> may
specify an actual and/or effective date for the posting by using
the syntax <code>[ACTUAL_DATE]</code> or <code>[=EFFECTIVE_DATE]</code> or
<code>[ACTUAL_DATE=EFFECTIVE_DATE]</code> (see <a href="#Virtual-postings">Virtual postings</a>).
</p>
</dd>
<dt><code>P</code></dt>
<dd><a name="index-_002d_002ddownload"></a>
<a name="index-P"></a>
<a name="index-historical-prices"></a>
<p>Specifies a historical price for a commodity.  These are usually found
in a pricing history file (see the <samp>--download (-Q)</samp> option).
The syntax is:
</p>
<div class="smallexample">
<pre class="smallexample">P DATE SYMBOL PRICE
</pre></div>

</dd>
<dt><code>=</code></dt>
<dd><a name="index-_003d"></a>
<a name="index-automated-transaction"></a>
<a name="index-transaction_002c-automated"></a>
<p>An automated transaction.  A value expression must appear after the
equal sign.
</p>
<p>After this initial line there should be a set of one or more postings,
just as if it were a normal transaction.  If the amounts of the postings
have no commodity, they will be applied as multipliers to whichever real
posting is matched by the value expression (see <a href="#Automated-Transactions">Automated Transactions</a>).
</p>
</dd>
<dt><code>~</code></dt>
<dd><a name="index-_007e"></a>
<a name="index-periodic-transaction"></a>
<a name="index-transaction_002c-periodic"></a>
<p>A periodic transaction.  A period expression must appear after the tilde.
</p>
<p>After this initial line there should be a set of one or more
postings, just as if it were a normal transaction.
</p>
</dd>
<dt><code>; # % | *</code></dt>
<dd><a name="index-comment"></a>
<a name="index-comments"></a>
<p>A line beginning with a semicolon, pound, percent, bar or asterisk
indicates a comment, and is ignored.  Comments will not be returned in
a &ldquo;print&rdquo; response.
</p>
</dd>
<dt><code>indented ;</code></dt>
<dd><a name="index-tags"></a>
<p>If the semicolon is indented and occurs inside a transaction, it is
parsed as a persistent note for its preceding category.  These notes or
tags can be used to augment the reporting and filtering capabilities of
Ledger.
</p>
</dd>
</dl>

<hr>
<a name="Command-Directives"></a>
<div class="header">
<p>
Previous: <a href="#Transactions-and-Comments" accesskey="p" rel="prev">Transactions and Comments</a>, Up: <a href="#Journal-Format" accesskey="u" rel="up">Journal Format</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Command-Directives-1"></a>
<h4 class="subsection">4.7.2 Command Directives</h4>
<a name="index-_002d_002dstrict-1"></a>
<a name="index-_002d_002dpedantic"></a>

<dl compact="compact">
<dt><code>beginning of line</code></dt>
<dd><p>Command directives must occur at the beginning of a line.  Use of
&lsquo;<samp>!</samp>&rsquo; and &lsquo;<samp>@</samp>&rsquo; is deprecated.
</p>
</dd>
<dt><code>account</code></dt>
<dd><a name="index-account"></a>
<a name="index-pre_002ddeclare-account"></a>
<p>Pre-declare valid account names.  This only has an effect if
<samp>--strict</samp> or <samp>--pedantic</samp> is used (see below).  The
<code>account</code> directive supports several optional sub-directives, if
they immediately follow the account directive and if they begin with
whitespace:
</p>
<div class="smallexample">
<pre class="smallexample">account Expenses:Food
    note This account is all about the chicken!
    alias food
    payee ^(KFC|Popeyes)$
    check commodity == &quot;$&quot;
    assert commodity == &quot;$&quot;
    eval print(&quot;Hello!&quot;)
    default
</pre></div>

<p>The <code>note</code> sub-directive associates a textual note with the
account.  This can be accessed later using the <code>note</code> value
expression function in any account context.
</p>
<p>The <code>alias</code> sub-directive, which can occur multiple times, allows
the alias to be used in place of the full account name anywhere that
account names are allowed.
</p>
<p>The <code>payee</code> sub-directive, which can occur multiple times,
provides regexes that identify the account if that payee is
encountered and an account within its transaction ends in the name
&quot;Unknown&quot;.  Example:
</p>
<div class="smallexample">
<pre class="smallexample">2012-02-27 KFC
    Expenses:Unknown      $10.00  ; Read now as &quot;Expenses:Food&quot;
    Assets:Cash
</pre></div>

<p>The <code>check</code> and <code>assert</code> directives warn or raise an error
(respectively) if the given value expression evaluates to false within
the context of any posting.
</p>
<p>The <code>eval</code> directive evaluates the value expression in the
context of the account at the time of definition.  At the moment this
has little value.
</p>
<p>The <code>default</code> directive specifies that this account should be
used as the &ldquo;balancing account&rdquo; for any future transactions that
contain only a single posting.
</p>
</dd>
<dt><code>apply account</code></dt>
<dd><a name="index-apply-account"></a>
<p>Sets the root for all accounts following this directive.  Ledger
supports a hierarchical tree of accounts.  It may be convenient to
keep two &ldquo;root accounts&rdquo;.  For example you may be tracking your
personal finances and your business finances.  In order to keep them
separate you could preface all personal accounts with &lsquo;<samp>personal:</samp>&rsquo;
and all business accounts with &lsquo;<samp>business:</samp>&rsquo;.  You can easily split
out large groups of transactions without manually editing them using
the account directive.  For example:
</p>
<div class="smallexample">
<pre class="smallexample">apply account Personal
2011/11/15  Supermarket
    Expenses:Groceries      $ 50.00
    Assets:Checking
</pre></div>

<p>Would result in all postings going into
&lsquo;<samp>Personal:Expenses:Groceries</samp>&rsquo; and &lsquo;<samp>Personal:Assets:Checking</samp>&rsquo;
until an &lsquo;<samp>end apply account</samp>&rsquo; directive was found.
</p>
</dd>
<dt><code>alias</code></dt>
<dd><a name="index-alias"></a>
<a name="index-account_002c-alias"></a>
<p>Define an alias for an account name.  If you have a deeply nested tree
of accounts, it may be convenient to define an alias, for example:
</p>
<div class="smallexample">
<pre class="smallexample">alias Dining=Expenses:Entertainment:Dining
alias Checking=Assets:Credit Union:Joint Checking Account

2011/11/28 YummyPalace
    Dining        $10.00
    Checking
</pre></div>

<p>The aliases are only in effect for transactions read in after the alias
is defined and are affected by <code>account</code> directives that precede
them.
</p>
<div class="smallexample">
<pre class="smallexample">$ ledger bal --no-total ^Exp
</pre></div>

<div class="smallexample">
<pre class="smallexample">              $10.00  Expenses:Entertainment:Dining
</pre></div>

<p>With the option <samp>--recursive-aliases</samp>, aliases can refer to other
aliases, the following example produces exactly the same transactions
and account names as the preceding one:
</p>
<div class="smallexample">
<pre class="smallexample">alias Entertainment=Expenses:Entertainment
alias Dining=Entertainment:Dining
alias Checking=Assets:Credit Union:Joint Checking Account

2011/11/30 ChopChop
  Dining          $10.00
  Checking
</pre></div>

<div class="smallexample">
<pre class="smallexample">$ ledger balance --no-total --recursive-aliases ^Exp
</pre></div>

<div class="smallexample">
<pre class="smallexample">              $10.00  Expenses:Entertainment:Dining
</pre></div>

<p>The option <samp>--no-aliases</samp> completely disables alias expansion.
All accounts are read verbatim as they are in the ledger file.
</p>
</dd>
<dt><code>assert</code></dt>
<dd><a name="index-assert"></a>
<a name="index-assertions"></a>
<p>An assertion can throw an error if a condition is not met during
Ledger&rsquo;s run.
</p>
<div class="smallexample">
<pre class="smallexample">assert &lt;VALUE EXPRESSION BOOLEAN RESULT&gt;
</pre></div>

</dd>
<dt><code>bucket</code></dt>
<dd><a name="bucket"></a><a name="index-bucket-1"></a>
<a name="index-bucket"></a>
<p>Defines the default account to use for balancing transactions.
Normally, each transaction has at least two postings, which must
balance to zero.  Ledger allows you to leave one posting with no
amount and automatically balance the transaction in the
posting.  The <code>bucket</code> allows you to fill in all postings and
automatically generate an additional posting to the bucket account
balancing the transaction.  If any transaction is unbalanced, it
will automatically be balanced against the <code>bucket</code> account.
The following example sets &lsquo;<samp>Assets:Checking</samp>&rsquo; as the bucket:
</p>
<div class="smallexample">
<pre class="smallexample">bucket Assets:Checking
2011/01/25 Tom's Used Cars
    Expenses:Auto                    $ 5,500.00

2011/01/27 Book Store
    Expenses:Books                       $20.00

2011/12/01 Sale
    Assets:Checking:Business            $ 30.00
</pre></div>

</dd>
<dt><code>capture</code></dt>
<dd><a name="index-capture"></a>
<a name="index-print"></a>
<a name="index-register-1"></a>

<p>Directs Ledger to replace any account matching a regex with the given
account.  For example:
</p>
<div class="smallexample">
<pre class="smallexample">capture  Expenses:Deductible:Medical  Medical
</pre></div>

<p>Would cause any posting with &lsquo;<samp>Medical</samp>&rsquo; in its name to be replaced
with &lsquo;<samp>Expenses:Deductible:Medical</samp>&rsquo;.
</p>
<p>Ledger will display the mapped payees in <code>print</code> and
<code>register</code> reports.
</p>
</dd>
<dt><code>check</code></dt>
<dd><a name="index-check"></a>
<a name="index-assertions-1"></a>
<p>A check issues a warning if a condition is not met during Ledger&rsquo;s
run.
</p>
<div class="smallexample">
<pre class="smallexample">check &lt;VALUE EXPRESSION BOOLEAN RESULT&gt;
</pre></div>

</dd>
<dt><code>comment</code></dt>
<dd><a name="index-comment-1"></a>
<a name="index-comments-1"></a>
<p>Start a block comment, closed by <code>end comment</code>.
</p>
</dd>
<dt><code>commodity</code></dt>
<dd><a name="index-commodity-1"></a>
<a name="index-pre_002ddeclare-commodity"></a>
<p>Pre-declare commodity names.  This only has an effect if
<samp>--strict</samp> or <samp>--pedantic</samp> is used (see below).
</p>
<div class="smallexample">
<pre class="smallexample">commodity $
commodity CAD
</pre></div>

<p>The <code>commodity</code> directive supports several optional
sub-directives, if they immediately follow the commodity directive
and&mdash;if they are on successive lines&mdash;begin with whitespace:
</p>
<div class="smallexample">
<pre class="smallexample">commodity $
   note American Dollars
   format $1,000.00
   nomarket
   default
</pre></div>

<p>The <code>note</code> sub-directive associates a textual note with the
commodity.  At present this has no value other than documentation.
</p>
<p>The <code>format</code> sub-directive gives you a way to tell Ledger how to
format this commodity.  In the future, using this directive will disable
Ledger&rsquo;s observation of other ways that commodity is used, and will
provide the &ldquo;canonical&rdquo; representation.
</p>
<p>The <code>nomarket</code> sub-directive states that the commodity&rsquo;s price
should never be auto-downloaded.
</p>
<p>The <code>default</code> sub-directive marks this as the &ldquo;default&rdquo; commodity.
</p>
</dd>
<dt><code>define</code></dt>
<dd><a name="index-define"></a>
<p>Allows you to define value expressions for future use.  For example:
</p>
<div class="smallexample">
<pre class="smallexample">define var_name=$100

2011/12/01 Test
    Expenses  (var_name*4)
    Assets
</pre></div>

<p>The posting will have a cost of $400.
</p>
</dd>
<dt><code>end</code></dt>
<dd><a name="index-end"></a>
<p>Closes block commands like <code>apply</code> or <code>comment</code>.
</p>
</dd>
<dt><code>expr</code></dt>
<dd><a name="index-expr"></a>

</dd>
<dt><code>fixed</code></dt>
<dd><a name="index-fixed"></a>
<a name="index-fixated-prices"></a>

<p>A fixed block is used to set fixated prices (see <a href="#Fixated-prices-and-costs">Fixated prices and costs</a>) for a series of transactions.  It&rsquo;s purely a typing saver, for
use when entering many transactions with fixated prices.
</p>
<p>Thus, the following:
</p>
<div class="smallexample">
<pre class="smallexample">fixed CAD $0.90
2012-04-10 Lunch in Canada
    Assets:Wallet            -15.50 CAD
    Expenses:Food            15.50 CAD

2012-04-11 Second day Dinner in Canada
    Assets:Wallet            -25.75 CAD
    Expenses:Food            25.75 CAD
endfixed CAD
</pre></div>

<p>is equivalent to this:
</p>
<div class="smallexample">
<pre class="smallexample">2012-04-10 Lunch in Canada
    Assets:Wallet            -15.50 CAD {=$0.90}
    Expenses:Food            15.50 CAD  {=$0.90}

2012-04-11 Second day Dinner in Canada
    Assets:Wallet            -25.75 CAD  {=$0.90}
    Expenses:Food            25.75 CAD   {=$0.90}
</pre></div>

<p>Note that ending a <code>fixed</code> is done differently than other
directives, as <code>fixed</code> is closed with an <code>endfixed</code> (i.e.,
there is <em>no space</em> between <code>end</code> and <code>fixed</code>).
</p>
<p>For the moment, users may wish to study
<a href="http://bugs.ledger-cli.org/show_bug.cgi?id=789">Bug Report 789</a>
before using the <code>fixed</code> directive in production.
</p>
</dd>
<dt><code>include</code></dt>
<dd><a name="index-include"></a>
<p>Include the stated file as if it were part of the current file.
</p>
</dd>
<dt><code>payee</code></dt>
<dd><a name="index-payee"></a>
<a name="index-print-1"></a>
<a name="index-register-2"></a>

<p>The <code>payee</code> directive supports two optional sub-directives, if they
immediately follow the payee directive and&mdash;if it is on a successive
line&mdash;begins with whitespace:
</p>
<div class="smallexample">
<pre class="smallexample">payee KFC
    alias KENTUCKY FRIED CHICKEN
    uuid 2a2e21d434356f886c84371eebac6e44f1337fda
</pre></div>

<p>The <code>alias</code> sub-directive provides a regex which, if it matches
a parsed payee, the declared payee name is substituted:
</p>
<div class="smallexample">
<pre class="smallexample">2012-02-27 KENTUCKY FRIED CHICKEN  ; will be read as being 'KFC'
</pre></div>

<p>The <code>uuid</code> sub-directive specifies that a transaction with exactly
the uuid given should have the declared payee name substituted:
</p>
<div class="smallexample">
<pre class="smallexample">2014-05-13 UNHELPFUL PAYEE  ; will be read as being 'KFC'
    ; UUID: 2a2e21d434356f886c84371eebac6e44f1337fda
</pre></div>

<p>Ledger will display the mapped payees in <code>print</code> and
<code>register</code> reports.
</p>
</dd>
<dt><code>apply tag</code></dt>
<dd><a name="index-apply-tag"></a>
<p>Allows you to designate a block of transactions and assign the same
tag to all.  Tags can have values and may be nested.
</p>
<div class="smallexample">
<pre class="smallexample">apply tag hastag
apply tag nestedtag: true

2011/01/25 Tom's Used Cars
    Expenses:Auto                    $ 5,500.00
    ; :nobudget:
    Assets:Checking

2011/01/27 Book Store
    Expenses:Books                       $20.00
    Liabilities:MasterCard

end apply tag

2011/12/01 Sale
    Assets:Checking:Business            $ 30.00
    Income:Sales

end apply tag
</pre></div>

<p>is the equivalent of:
</p>
<div class="smallexample">
<pre class="smallexample">2011/01/25 Tom's Used Cars
    ; :hastag:
    ; nestedtag: true
    Expenses:Auto                    $ 5,500.00
    ; :nobudget:
    Assets:Checking

2011/01/27 Book Store
    ; :hastag:
    ; nestedtag: true
    Expenses:Books                       $20.00
    Liabilities:MasterCard

2011/12/01 Sale
    ; :hastag:
    Assets:Checking:Business            $ 30.00
    Income:Sales
</pre></div>



</dd>
<dt><code>tag</code></dt>
<dd><a name="index-tag"></a>
<a name="index-pre_002ddeclare-tag"></a>
<p>Pre-declares tag names.  This only has an effect if <samp>--strict</samp> or
<samp>--pedantic</samp> is used (see below).
</p>
<div class="smallexample">
<pre class="smallexample">tag Receipt
tag CSV
</pre></div>

<p>The <code>tag</code> directive supports two optional sub-directives, if they
immediately follow the tag directive and&mdash;if on a successive
line&mdash;begin with whitespace:
</p>
<div class="smallexample">
<pre class="smallexample">tag Receipt
  check value =~ /pattern/
  assert value != &quot;foobar&quot;
</pre></div>

<p>The <code>check</code> and <code>assert</code> sub-directives warn or error
(respectively) if the given value expression evaluates to false within
the context of any use of the related tag.  In such a context,
&ldquo;value&rdquo; is bound to the value of the tag (which may be something else
but a string if typed metadata is used!).  Such checks or assertions are
not called if no value is given.
</p>
</dd>
<dt><code>test</code></dt>
<dd><a name="index-test"></a>
<a name="index-comments-2"></a>
<p>This is a synonym for <code>comment</code> and must be closed by an
<code>end</code> tag.
</p>
</dd>
<dt><code>year</code></dt>
<dd><a name="index-year"></a>
<a name="year"></a><p>Denotes the year used for all subsequent transactions that give a date
without a year.  The year should appear immediately after the
directive, for example: <code>year 2004</code>.  This is useful at the
beginning of a file, to specify the year for that file.  If all
transactions specify a year, however, this command has no effect.
</p>
</dd>
</dl>

<p>The following single letter commands may be at the beginning of a line
alone, for backwards compatibility with older Ledger versions.
</p>
<dl compact="compact">
<dt><code>A</code></dt>
<dd><a name="index-A"></a>
<a name="index-bucket-2"></a>
<p>See <a href="#bucket">bucket</a>.
</p>
</dd>
<dt><code>Y</code></dt>
<dd><a name="index-Y"></a>
<a name="index-year-1"></a>
<p>See <a href="#year">year</a>.
</p>
</dd>
<dt><code>N SYMBOL</code></dt>
<dd><a name="index-N"></a>
<p>Indicates that pricing information is to be ignored for a given
symbol, nor will quotes ever be downloaded for that symbol.  Useful
with a home currency, such as the dollar &lsquo;<samp>$</samp>&rsquo;.  It is recommended
that these pricing options be set in the price database file, which
defaults to <samp>~/.pricedb</samp>.  The syntax for this command is:
</p>
<div class="smallexample">
<pre class="smallexample">N SYMBOL
</pre></div>

</dd>
<dt><code>D AMOUNT</code></dt>
<dd><a name="index-xact"></a>
<a name="index-D"></a>
<p>Specifies the default commodity to use, by specifying an amount in the
expected format.  The <code>xact</code> command will use this commodity as
the default when none other can be determined.  This command may be used
multiple times, to set the default flags for different commodities;
whichever is seen last is used as the default commodity.  For example,
to set US dollars as the default commodity, while also setting the
thousands flag and decimal flag for that commodity, use:
</p>
<div class="smallexample">
<pre class="smallexample">D $1,000.00
</pre></div>

</dd>
<dt><code>C AMOUNT1 = AMOUNT2</code></dt>
<dd><a name="index-C-1"></a>
<p>Specifies a commodity conversion, where the first amount is given to
be equivalent to the second amount.  The first amount should use the
decimal precision desired during reporting:
</p>
<div class="smallexample">
<pre class="smallexample">C 1.00 Kb = 1024 bytes
</pre></div>

</dd>
<dt><code>I, i, O, o, b, h</code></dt>
<dd><a name="index-I"></a>
<a name="index-i"></a>
<a name="index-O"></a>
<a name="index-o"></a>
<a name="index-b"></a>
<a name="index-h"></a>
<p>These four relate to timeclock support, which permits Ledger to read
timelog files.  See timeclock&rsquo;s documentation for more info on the
syntax of its timelog files.
</p>
</dd>
</dl>

<hr>
<a name="Converting-from-other-formats"></a>
<div class="header">
<p>
Next: <a href="#Archiving-Previous-Years" accesskey="n" rel="next">Archiving Previous Years</a>, Previous: <a href="#Journal-Format" accesskey="p" rel="prev">Journal Format</a>, Up: <a href="#Keeping-a-Journal" accesskey="u" rel="up">Keeping a Journal</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Converting-from-other-formats-1"></a>
<h3 class="section">4.8 Converting from other formats</h3>
<a name="index-csv-importing"></a>

<p>There are numerous tools to help convert various formats to a Ledger
file.  Most banks will generate a comma separated values file that can
easily be parsed into Ledger format using one of those tools.  Some of
the most popular tools are:
</p>
<ul>
<li> <code>ledger convert download.csv</code>
</li><li> <code>hledger -f checking.csv print</code>
</li><li> <a href="https://github.com/quentinsf/icsv2ledger"><code>icsv2ledger</code></a>
</li><li> <a href="https://github.com/tazzben/csvToLedger"><code>csvToLedger</code></a>
</li><li> <a href="https://launchpad.net/csv2ledger"><code>CSV2Ledger</code></a>
</li></ul>

<p>Directly pulling information from banks is outside the scope of
Ledger&rsquo;s function.
</p>
<hr>
<a name="Archiving-Previous-Years"></a>
<div class="header">
<p>
Previous: <a href="#Converting-from-other-formats" accesskey="p" rel="prev">Converting from other formats</a>, Up: <a href="#Keeping-a-Journal" accesskey="u" rel="up">Keeping a Journal</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Archiving-Previous-Years-1"></a>
<h3 class="section">4.9 Archiving Previous Years</h3>
<a name="index-equity"></a>
<a name="index-print-2"></a>

<p>After a while, your journal can get to be pretty large.  While this
will not slow down Ledger&mdash;it&rsquo;s designed to process journals very
quickly&mdash;things can start to feel &ldquo;messy&rdquo;; and it&rsquo;s a universal
complaint that when finances feel messy, people avoid them.
</p>
<p>Thus, archiving the data from previous years into their own files can
offer a sense of completion, and freedom from the past.  But how to
best accomplish this with the ledger program?  There are two commands
that make it very simple: <code>print</code>, and <code>equity</code>.
</p>
<p>Let&rsquo;s take an example file, with data ranging from year 2000 until
2004.  We want to archive years 2000 and 2001 to their own file,
leaving 2002&ndash;2004 in the current file.  So, use <code>print</code> to
output all the earlier transactions to a file called
<samp>ledger-old.dat</samp>:
</p>
<div class="smallexample">
<pre class="smallexample">$ ledger -f ledger.dat -b 2000 -e 2002 print &gt; ledger-old.dat
</pre></div>

<p>Note that <samp>-e</samp> limits output to transactions <em>before</em> the
date specified.
</p>
<p>To delete older data from the current ledger file, use <code>print</code>
again, this time specifying year 2002 as the starting date:
</p>
<div class="smallexample">
<pre class="smallexample">$ ledger -f ledger.dat -b 2002 print &gt; x
$ mv x ledger.dat
</pre></div>

<p>However, now the current file contains <em>only</em> postings from 2002
onward, which will not yield accurate present-day balances, because the
net income from previous years is no longer being tallied.  To
compensate for this, we must append an equity report for the old ledger
at the beginning of the new one:
</p>
<div class="smallexample">
<pre class="smallexample">$ ledger -f ledger-old.dat equity &gt; equity.dat
$ cat equity.dat ledger.dat &gt; x
$ mv x ledger.dat
$ rm equity.dat
</pre></div>

<p>Now the balances reported from <samp>ledger.dat</samp> are identical to what
they were before the data was split.
</p>
<p>How often should you split your ledger?  You never need to, if you
don&rsquo;t want to.  Even eighty years of data will not slow down ledger
much, and that&rsquo;s just using present day hardware!  Or, you can keep
the previous and current year in one file, and each year before that
in its own file.  It&rsquo;s really up to you, and how you want to organize
your finances.  For those who also keep an accurate paper trail, it
might be useful to archive the older years to their own files, then
burn those files to a CD to keep with the paper records&mdash;along with
any electronic statements received during the year.  In the arena of
organization, just keep in mind this maxim: Do whatever keeps you
doing it.
</p>
<hr>
<a name="Transactions"></a>
<div class="header">
<p>
Next: <a href="#Building-Reports" accesskey="n" rel="next">Building Reports</a>, Previous: <a href="#Keeping-a-Journal" accesskey="p" rel="prev">Keeping a Journal</a>, Up: <a href="#Top" accesskey="u" rel="up">Top</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Transactions-1"></a>
<h2 class="chapter">5 Transactions</h2>

<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top">&bull; <a href="#Basic-format" accesskey="1">Basic format</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Eliding-amounts" accesskey="2">Eliding amounts</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Auxiliary-dates" accesskey="3">Auxiliary dates</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Codes" accesskey="4">Codes</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Transaction-state" accesskey="5">Transaction state</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Transaction-notes" accesskey="6">Transaction notes</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Metadata" accesskey="7">Metadata</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Virtual-postings" accesskey="8">Virtual postings</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Expression-amounts" accesskey="9">Expression amounts</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Balance-verification">Balance verification</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Posting-cost">Posting cost</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Explicit-posting-costs">Explicit posting costs</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Posting-cost-expressions">Posting cost expressions</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Total-posting-costs">Total posting costs</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Virtual-posting-costs">Virtual posting costs</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Commodity-prices">Commodity prices</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Prices-versus-costs">Prices versus costs</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Fixated-prices-and-costs">Fixated prices and costs</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Lot-dates">Lot dates</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Lot-notes">Lot notes</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Lot-value-expressions">Lot value expressions</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Automated-Transactions">Automated Transactions</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
</table>

<hr>
<a name="Basic-format"></a>
<div class="header">
<p>
Next: <a href="#Eliding-amounts" accesskey="n" rel="next">Eliding amounts</a>, Previous: <a href="#Transactions" accesskey="p" rel="prev">Transactions</a>, Up: <a href="#Transactions" accesskey="u" rel="up">Transactions</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Basic-format-1"></a>
<h3 class="section">5.1 Basic format</h3>

<p>The most basic form of transaction is:
</p>
<div class="smallexample">
<pre class="smallexample">2012-03-10 KFC
    Expenses:Food                $20.00
    Assets:Cash                 $-20.00
</pre></div>

<p>This transaction has a date, a payee or description, a target account
(the first posting), and a source account (the second posting).  Each
posting specifies what action is taken related to that account.
</p>
<p>A transaction can have any number of postings:
</p>
<div class="smallexample">
<pre class="smallexample">2012-03-10 KFC
    Expenses:Food                $20.00
    Assets:Cash                 $-10.00
    Liabilities:Credit          $-10.00
</pre></div>

<hr>
<a name="Eliding-amounts"></a>
<div class="header">
<p>
Next: <a href="#Auxiliary-dates" accesskey="n" rel="next">Auxiliary dates</a>, Previous: <a href="#Basic-format" accesskey="p" rel="prev">Basic format</a>, Up: <a href="#Transactions" accesskey="u" rel="up">Transactions</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Eliding-amounts-1"></a>
<h3 class="section">5.2 Eliding amounts</h3>

<p>The first thing you can do to make things easier is elide amounts.
That is, if exactly one posting has no amount specified, Ledger will
infer the inverse of the other postings&rsquo; amounts:
</p>
<div class="smallexample">
<pre class="smallexample">2012-03-10 KFC
    Expenses:Food                $20.00
    Assets:Cash                 $-10.00
    Liabilities:Credit                   ; same as specifying $-10
</pre></div>

<p>If the other postings use multiple commodities, Ledger will copy the
empty posting N times and fill in the negated values of the various
commodities:
</p>
<div class="smallexample">
<pre class="smallexample">2012-03-10 KFC
    Expenses:Food                $20.00
    Expenses:Tips                 $2.00
    Assets:Cash              EUR -10.00
    Assets:Cash              GBP -10.00
    Liabilities:Credit
</pre></div>

<p>This transaction is identical to writing:
</p>
<div class="smallexample">
<pre class="smallexample">2012-03-10 KFC
    Expenses:Food                $20.00
    Expenses:Tips                 $2.00
    Assets:Cash              EUR -10.00
    Assets:Cash              GBP -10.00
    Liabilities:Credit          $-22.00
    Liabilities:Credit        EUR 10.00
    Liabilities:Credit        GBP 10.00
</pre></div>

<hr>
<a name="Auxiliary-dates"></a>
<div class="header">
<p>
Next: <a href="#Codes" accesskey="n" rel="next">Codes</a>, Previous: <a href="#Eliding-amounts" accesskey="p" rel="prev">Eliding amounts</a>, Up: <a href="#Transactions" accesskey="u" rel="up">Transactions</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Auxiliary-dates-1"></a>
<h3 class="section">5.3 Auxiliary dates</h3>
<a name="index-_002d_002daux_002ddate"></a>

<p>You can associate a second date with a transaction by following the
primary date with an equals sign:
</p>
<div class="smallexample">
<pre class="smallexample">2012-03-10=2012-03-08 KFC
    Expenses:Food                $20.00
    Assets:Cash                 $-20.00
</pre></div>

<p>What this auxiliary date means is entirely up to you.  The only use
Ledger has for it is that if you specify <samp>--aux-date</samp>, then all
reports and calculations (including pricing) will use the auxiliary
date as if it were the primary date.
</p>
<hr>
<a name="Codes"></a>
<div class="header">
<p>
Next: <a href="#Transaction-state" accesskey="n" rel="next">Transaction state</a>, Previous: <a href="#Auxiliary-dates" accesskey="p" rel="prev">Auxiliary dates</a>, Up: <a href="#Transactions" accesskey="u" rel="up">Transactions</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Codes-1"></a>
<h3 class="section">5.4 Codes</h3>

<p>A transaction can have a textual &ldquo;code&rdquo;.  This has no meaning and is
only displayed by the print command.  Checking accounts often use
codes like DEP, XFER, etc., as well as check numbers.  This is to give
you a place to put those codes:
</p>
<div class="smallexample">
<pre class="smallexample">2012-03-10 (#100) KFC
    Expenses:Food                $20.00
    Assets:Checking
</pre></div>

<hr>
<a name="Transaction-state"></a>
<div class="header">
<p>
Next: <a href="#Transaction-notes" accesskey="n" rel="next">Transaction notes</a>, Previous: <a href="#Codes" accesskey="p" rel="prev">Codes</a>, Up: <a href="#Transactions" accesskey="u" rel="up">Transactions</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Transaction-state-1"></a>
<h3 class="section">5.5 Transaction state</h3>
<a name="index-_002d_002dcleared"></a>
<a name="index-_002d_002duncleared"></a>
<a name="index-_002d_002dpending"></a>

<p>A transaction can have a &ldquo;state&rdquo;: cleared, pending, or uncleared.  The
default is uncleared.  To mark a transaction cleared, put an asterisk
&lsquo;<samp>*</samp>&rsquo; before the payee, after the date or code:
</p>
<div class="smallexample">
<pre class="smallexample">2012-03-10 * KFC
    Expenses:Food                $20.00
    Assets:Cash
</pre></div>

<p>To mark it pending, use a &lsquo;<samp>!</samp>&rsquo;:
</p>
<div class="smallexample">
<pre class="smallexample">2012-03-10 ! KFC
    Expenses:Food                $20.00
    Assets:Cash
</pre></div>

<p>What these mean is entirely up to you.  The <samp>--cleared</samp> option
limits reports to only cleared items, while <samp>--uncleared</samp>
shows both uncleared and pending items, and <samp>--pending</samp> shows
only pending items.
</p>
<p>I use cleared to mean that I&rsquo;ve reconciled the transaction with my
bank statement, and pending to mean that I&rsquo;m in the middle of
a reconciliation.
</p>
<p>When you clear a transaction, that&rsquo;s really just shorthand for
clearing all of its postings.  That is:
</p>
<div class="smallexample">
<pre class="smallexample">2012-03-10 * KFC
    Expenses:Food                $20.00
    Assets:Cash
</pre></div>

<p>Is the same as writing:
</p>
<div class="smallexample">
<pre class="smallexample">2012-03-10 KFC
    * Expenses:Food                $20.00
    * Assets:Cash
</pre></div>

<p>You can mark individual postings as cleared or pending, in case one
&ldquo;side&rdquo; of the transaction has cleared, but the other hasn&rsquo;t yet:
</p>
<div class="smallexample">
<pre class="smallexample">2012-03-10 KFC
    Liabilities:Credit            $100.00
    * Assets:Checking
</pre></div>

<hr>
<a name="Transaction-notes"></a>
<div class="header">
<p>
Next: <a href="#Metadata" accesskey="n" rel="next">Metadata</a>, Previous: <a href="#Transaction-state" accesskey="p" rel="prev">Transaction state</a>, Up: <a href="#Transactions" accesskey="u" rel="up">Transactions</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Transaction-notes-1"></a>
<h3 class="section">5.6 Transaction notes</h3>

<p>After the payee, and after at least one tab or two spaces (or a space
and a tab), which Ledger calls a &ldquo;hard separator&rdquo;, you may
introduce a note about the transaction using the &lsquo;<samp>;</samp>&rsquo; character:
</p>
<div class="smallexample">
<pre class="smallexample">2012-03-10 * KFC                ; yum, chicken...
    Expenses:Food                $20.00
    Assets:Cash
</pre></div>

<p>Notes can also appear on the next line, so long as that line begins
with whitespace:
</p>
<div class="smallexample">
<pre class="smallexample">2012-03-10 * KFC                ; yum, chicken...
    ; and more notes...
    Expenses:Food                $20.00
    Assets:Cash

2012-03-10 * KFC
    ; just these notes...
    Expenses:Food                $20.00
    Assets:Cash
</pre></div>

<p>A transaction&rsquo;s note is shared by all its postings.  This becomes
significant when querying for metadata (see below).  To specify that
a note belongs only to one posting, place it after a hard separator
after the amount, or on its own line preceded by whitespace:
</p>
<div class="smallexample">
<pre class="smallexample">2012-03-10 * KFC
    Expenses:Food                $20.00  ; posting #1 note
    Assets:Cash
      ; posting #2 note, extra indentation is optional
</pre></div>

<hr>
<a name="Metadata"></a>
<div class="header">
<p>
Next: <a href="#Virtual-postings" accesskey="n" rel="next">Virtual postings</a>, Previous: <a href="#Transaction-notes" accesskey="p" rel="prev">Transaction notes</a>, Up: <a href="#Transactions" accesskey="u" rel="up">Transactions</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Metadata-1"></a>
<h3 class="section">5.7 Metadata</h3>

<p>One of Ledger&rsquo;s more powerful features is the ability to associate
typed metadata with postings and transactions (by which I mean all of
a transaction&rsquo;s postings).  This metadata can be queried, displayed,
and used in calculations.
</p>
<p>The are two forms of metadata: plain tags, and tag/value pairs.
</p>
<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top">&bull; <a href="#Metadata-tags" accesskey="1">Metadata tags</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Metadata-values" accesskey="2">Metadata values</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Typed-metadata" accesskey="3">Typed metadata</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
</table>

<hr>
<a name="Metadata-tags"></a>
<div class="header">
<p>
Next: <a href="#Metadata-values" accesskey="n" rel="next">Metadata values</a>, Previous: <a href="#Metadata" accesskey="p" rel="prev">Metadata</a>, Up: <a href="#Metadata" accesskey="u" rel="up">Metadata</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Metadata-tags-1"></a>
<h4 class="subsection">5.7.1 Metadata tags</h4>

<p>To tag an item, put any word not containing whitespace between two
colons inside a comment:
</p>
<div class="smallexample">
<pre class="smallexample">2012-03-10 * KFC
    Expenses:Food                $20.00
    Assets:Cash
      ; :TAG:
</pre></div>

<p>You can gang up multiple tags by sharing colons:
</p>
<div class="smallexample">
<pre class="smallexample">2012-03-10 * KFC
    Expenses:Food                $20.00
    Assets:Cash
      ; :TAG1:TAG2:TAG3:
</pre></div>

<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top">&bull; <a href="#Payee-metadata-tag" accesskey="1">Payee metadata tag</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
</table>

<hr>
<a name="Payee-metadata-tag"></a>
<div class="header">
<p>
Previous: <a href="#Metadata-tags" accesskey="p" rel="prev">Metadata tags</a>, Up: <a href="#Metadata-tags" accesskey="u" rel="up">Metadata tags</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Payee-metadata-tag-1"></a>
<h4 class="subsubsection">5.7.1.1 Payee metadata tag</h4>
<a name="index-Payee-metadata-tag"></a>
<a name="index-register-3"></a>
<a name="index-payees"></a>
<a name="index-_002d_002dby_002dpayee-1"></a>

<p>&ldquo;Payee&rdquo; is a special metadata field.  If set on a posting, it will be
used as the payee name for that posting.  This affects the
<code>register</code> report, the <code>payees</code> report, and the
<samp>--by-payee</samp> option.
</p>
<p>This is useful when for example you deposit 4 checks at a time to the
bank.  On the bank statement, there is just one amount &lsquo;<samp>$400</samp>&rsquo;, but
you can specify from whom each check came, as shown by example
below:
</p>
<div class="smallexample">
<pre class="smallexample">2010-06-17 Sample
    Assets:Bank        $400.00
    Income:Check1     $-100.00  ; Payee: Person One
    Income:Check2     $-100.00  ; Payee: Person Two
    Income:Check3     $-100.00  ; Payee: Person Three
    Income:Check4     $-100.00  ; Payee: Person Four
</pre></div>

<p>When reporting with
</p>
<div class="smallexample">
<pre class="smallexample">$ ledger reg
</pre></div>

<p>it appears as:
</p>
<div class="smallexample">
<pre class="smallexample">10-Jun-17 Sample                Assets:Bank                 $400.00      $400.00
          Person One            Income:Check1              $-100.00      $300.00
          Person Two            Income:Check2              $-100.00      $200.00
          Person Three          Income:Check3              $-100.00      $100.00
          Person Four           Income:Check4              $-100.00            0
</pre></div>

<p>This shows that they are all in the same transaction (which is why the
date is not repeated), but they have different payees now.
</p>
<hr>
<a name="Metadata-values"></a>
<div class="header">
<p>
Next: <a href="#Typed-metadata" accesskey="n" rel="next">Typed metadata</a>, Previous: <a href="#Metadata-tags" accesskey="p" rel="prev">Metadata tags</a>, Up: <a href="#Metadata" accesskey="u" rel="up">Metadata</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Metadata-values-1"></a>
<h4 class="subsection">5.7.2 Metadata values</h4>

<p>To associate a value with a tag, use the syntax &ldquo;Key: Value&rdquo;, where
the value can be any string of characters.  Whitespace is needed after
the colon, and cannot appear in the Key:
</p>
<div class="smallexample">
<pre class="smallexample">2012-03-10 * KFC
    Expenses:Food                $20.00
    Assets:Cash
      ; MyTag: This is just a bogus value for MyTag
</pre></div>

<hr>
<a name="Typed-metadata"></a>
<div class="header">
<p>
Previous: <a href="#Metadata-values" accesskey="p" rel="prev">Metadata values</a>, Up: <a href="#Metadata" accesskey="u" rel="up">Metadata</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Typed-metadata-1"></a>
<h4 class="subsection">5.7.3 Typed metadata</h4>

<p>If a metadata tag ends in ::, its value will be parsed as a value
expression and stored internally as a value rather than as a string.
For example, although I can specify a date textually like so:
</p>
<div class="smallexample">
<pre class="smallexample">2012-03-10 * KFC
    Expenses:Food                $20.00
    Assets:Cash
      ; AuxDate: 2012/02/30
</pre></div>

<p>This date is just a string, and won&rsquo;t be parsed as a date unless its
value is used in a date-context (at which time the string is parsed
into a date automatically every time it is needed as a date).  If on
the other hand I write this:
</p>
<div class="smallexample">
<pre class="smallexample">2012-03-10 * KFC
    Expenses:Food                $20.00
    Assets:Cash
      ; AuxDate:: [2012/02/30]
</pre></div>

<p>Then it is parsed as a date only once, and during parsing of the
journal file, which would let me know right away that it is an invalid
date.
</p>
<hr>
<a name="Virtual-postings"></a>
<div class="header">
<p>
Next: <a href="#Expression-amounts" accesskey="n" rel="next">Expression amounts</a>, Previous: <a href="#Metadata" accesskey="p" rel="prev">Metadata</a>, Up: <a href="#Transactions" accesskey="u" rel="up">Transactions</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Virtual-postings-1"></a>
<h3 class="section">5.8 Virtual postings</h3>
<a name="index-_002d_002dreal-1"></a>

<p>Ordinarily, the amounts of all postings in a transaction must balance
to zero.  This is non-negotiable.  It&rsquo;s what double-entry accounting
is all about!  But there are some tricks up Ledger&rsquo;s sleeve...
</p>
<p>You can use virtual accounts to transfer amounts to an account on the
sly, bypassing the balancing requirement.  The trick is that these
postings are not considered &ldquo;real&rdquo;, and can be removed from all
reports using <samp>--real</samp>.
</p>
<p>To specify a virtual account, surround the account name with
parentheses:
</p>
<div class="smallexample">
<pre class="smallexample">2012-03-10 * KFC
    Expenses:Food                $20.00
    Assets:Cash
    (Budget:Food)               $-20.00
</pre></div>

<p>If you want, you can state that virtual postings <em>should</em> balance
against one or more other virtual postings by using brackets (which
look &ldquo;harder&rdquo;) rather than parentheses:
</p>
<div class="smallexample">
<pre class="smallexample">2012-03-10 * KFC
    Expenses:Food                $20.00
    Assets:Cash
    [Budget:Food]               $-20.00
    [Equity:Budgets]             $20.00
</pre></div>

<hr>
<a name="Expression-amounts"></a>
<div class="header">
<p>
Next: <a href="#Balance-verification" accesskey="n" rel="next">Balance verification</a>, Previous: <a href="#Virtual-postings" accesskey="p" rel="prev">Virtual postings</a>, Up: <a href="#Transactions" accesskey="u" rel="up">Transactions</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Expression-amounts-1"></a>
<h3 class="section">5.9 Expression amounts</h3>

<p>An amount is usually a numerical figure with an (optional) commodity,
but it can also be any value expression.  To indicate this, surround
the amount expression with parentheses:
</p>
<div class="smallexample">
<pre class="smallexample">2012-03-10 * KFC
    Expenses:Food      ($10.00 + $20.00)  ; Ledger adds it up for you
    Assets:Cash
</pre></div>

<hr>
<a name="Balance-verification"></a>
<div class="header">
<p>
Next: <a href="#Posting-cost" accesskey="n" rel="next">Posting cost</a>, Previous: <a href="#Expression-amounts" accesskey="p" rel="prev">Expression amounts</a>, Up: <a href="#Transactions" accesskey="u" rel="up">Transactions</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Balance-verification-1"></a>
<h3 class="section">5.10 Balance verification</h3>
<a name="index-_002d_002dpermissive"></a>

<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top">&bull; <a href="#Balance-assertions" accesskey="1">Balance assertions</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Balance-assignments" accesskey="2">Balance assignments</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Resetting-a-balance" accesskey="3">Resetting a balance</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Balancing-transactions" accesskey="4">Balancing transactions</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
</table>

<p>If at the end of a posting&rsquo;s amount (and after the cost too, if there
is one) there is an equals sign, then Ledger will verify that the
total value for that account as of that posting matches the amount
specified.  See <samp>--permissive</samp> option to relax the balance assertions checks.
</p>
<p>There are two forms of this features: balance assertions, and balance
assignments.
</p>
<hr>
<a name="Balance-assertions"></a>
<div class="header">
<p>
Next: <a href="#Balance-assignments" accesskey="n" rel="next">Balance assignments</a>, Previous: <a href="#Balance-verification" accesskey="p" rel="prev">Balance verification</a>, Up: <a href="#Balance-verification" accesskey="u" rel="up">Balance verification</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Balance-assertions-1"></a>
<h4 class="subsection">5.10.1 Balance assertions</h4>

<p>A balance assertion has this general form:
</p>
<div class="smallexample">
<pre class="smallexample">2012-03-10 KFC
    Expenses:Food                $20.00
    Assets:Cash                 $-20.00 = $500.00
</pre></div>

<p>This simply asserts that after subtracting $20.00 from Assets:Cash,
that the resulting total matches $500.00.  If not, it is an error.
</p>
<hr>
<a name="Balance-assignments"></a>
<div class="header">
<p>
Next: <a href="#Resetting-a-balance" accesskey="n" rel="next">Resetting a balance</a>, Previous: <a href="#Balance-assertions" accesskey="p" rel="prev">Balance assertions</a>, Up: <a href="#Balance-verification" accesskey="u" rel="up">Balance verification</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Balance-assignments-1"></a>
<h4 class="subsection">5.10.2 Balance assignments</h4>

<p>A balance assignment has this form:
</p>
<div class="smallexample">
<pre class="smallexample">2012-03-10 KFC
    Expenses:Food                $20.00
    Assets:Cash                         = $500.00
</pre></div>

<p>This sets the amount of the second posting to whatever it would need to
be for the total in &lsquo;<samp>Assets:Cash</samp>&rsquo; to be $500.00 after the posting.
If the resulting amount is not $-20.00 in this case, it is an error.
</p>
<hr>
<a name="Resetting-a-balance"></a>
<div class="header">
<p>
Next: <a href="#Balancing-transactions" accesskey="n" rel="next">Balancing transactions</a>, Previous: <a href="#Balance-assignments" accesskey="p" rel="prev">Balance assignments</a>, Up: <a href="#Balance-verification" accesskey="u" rel="up">Balance verification</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Resetting-a-balance-1"></a>
<h4 class="subsection">5.10.3 Resetting a balance</h4>

<p>Say your book-keeping has gotten a bit out of date, and your Ledger
balance no longer matches your bank balance.  You can create an
adjustment transaction using balance assignments:
</p>
<div class="smallexample">
<pre class="smallexample">2012-03-10 Adjustment
    Assets:Cash                         = $500.00
    Equity:Adjustments
</pre></div>

<p>Since the second posting is also null, its value will become the
inverse of whatever amount is generated for the first posting.
</p>
<p>This is the only time in ledger when more than one posting&rsquo;s amount
may be empty&mdash;and then only because it&rsquo;s not truly empty, it is
indirectly provided by the balance assignment&rsquo;s value.
</p>
<hr>
<a name="Balancing-transactions"></a>
<div class="header">
<p>
Previous: <a href="#Resetting-a-balance" accesskey="p" rel="prev">Resetting a balance</a>, Up: <a href="#Balance-verification" accesskey="u" rel="up">Balance verification</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Balancing-transactions-1"></a>
<h4 class="subsection">5.10.4 Balancing transactions</h4>
<a name="index-_002d_002dempty"></a>

<p>As a consequence of all the above, consider the following transaction:
</p>
<div class="smallexample">
<pre class="smallexample">2012-03-10 My Broker
    [Assets:Brokerage]            = 10 AAPL
</pre></div>

<p>What this says is: set the amount of the posting to whatever value is
needed so that &lsquo;<samp>Assets:Brokerage</samp>&rsquo; contains 10 AAPL.  Then, because
this posting must balance, ensure that its value is zero.  This can only
be true if Assets:Brokerage does indeed contain 10 AAPL at that point in
the input file.
</p>
<p>A balanced virtual transaction is used simply to indicate to Ledger that
this is not a &ldquo;real&rdquo; transaction.  It won&rsquo;t appear in any reports
anyway (unless you use a register report with <samp>--empty</samp>).
</p>
<hr>
<a name="Posting-cost"></a>
<div class="header">
<p>
Next: <a href="#Explicit-posting-costs" accesskey="n" rel="next">Explicit posting costs</a>, Previous: <a href="#Balance-verification" accesskey="p" rel="prev">Balance verification</a>, Up: <a href="#Transactions" accesskey="u" rel="up">Transactions</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Posting-cost-1"></a>
<h3 class="section">5.11 Posting cost</h3>

<p>When you transfer a commodity from one account to another, sometimes
it gets transformed during the transaction.  This happens when you
spend money on gas, for example, which transforms dollars into gallons
of gasoline, or dollars into stocks in a company.
</p>
<p>In those cases, Ledger will remember the &ldquo;cost&rdquo; of that transaction
for you, and can use it during reporting in various ways.  Here&rsquo;s an
example of a stock purchase:
</p>
<div class="smallexample">
<pre class="smallexample">2012-03-10 My Broker
    Assets:Brokerage             10 AAPL
    Assets:Brokerage:Cash       $-500.00
</pre></div>

<p>This is different from transferring 10 AAPL shares from one account to
another, in this case you are <em>exchanging</em> one commodity for
another.  The resulting posting&rsquo;s cost is $50.00 per share.
</p>
<hr>
<a name="Explicit-posting-costs"></a>
<div class="header">
<p>
Next: <a href="#Posting-cost-expressions" accesskey="n" rel="next">Posting cost expressions</a>, Previous: <a href="#Posting-cost" accesskey="p" rel="prev">Posting cost</a>, Up: <a href="#Transactions" accesskey="u" rel="up">Transactions</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Explicit-posting-costs-1"></a>
<h3 class="section">5.12 Explicit posting costs</h3>

<p>You can make any posting&rsquo;s cost explicit using the &lsquo;<samp>@</samp>&rsquo; symbol
after the amount or amount expression:
</p>
<div class="smallexample">
<pre class="smallexample">2012-03-10 My Broker
    Assets:Brokerage             10 AAPL @ $50.00
    Assets:Brokerage:Cash       $-500.00
</pre></div>

<p>When you do this, since Ledger can now figure out the balancing amount
from the first posting&rsquo;s cost, you can elide the other amount:
</p>
<div class="smallexample">
<pre class="smallexample">2012-03-10 My Broker
    Assets:Brokerage             10 AAPL @ $50.00
    Assets:Brokerage:Cash
</pre></div>

<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top">&bull; <a href="#Primary-and-secondary-commodities" accesskey="1">Primary and secondary commodities</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
</table>

<hr>
<a name="Primary-and-secondary-commodities"></a>
<div class="header">
<p>
Previous: <a href="#Explicit-posting-costs" accesskey="p" rel="prev">Explicit posting costs</a>, Up: <a href="#Explicit-posting-costs" accesskey="u" rel="up">Explicit posting costs</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Primary-and-secondary-commodities-1"></a>
<h4 class="subsection">5.12.1 Primary and secondary commodities</h4>
<a name="index-_002d_002dmarket-2"></a>
<a name="index-_002d_002dexchange-COMMODITY-1"></a>

<p>It is a general convention within Ledger that the &ldquo;top&rdquo; postings in
a transaction contain the target accounts, while the final posting
contains the source account.  Whenever a commodity is exchanged like
this, the commodity moved to the target account is considered
&ldquo;secondary&rdquo;, while the commodity used for purchasing and tracked in
the cost is &ldquo;primary&rdquo;.
</p>
<p>Said another way, whenever Ledger sees a posting cost of the form
&quot;AMOUNT @ AMOUNT&quot;, the commodity used in the second amount is marked
&ldquo;primary&rdquo;.
</p>
<p>The only meaning a primary commodity has is that the <samp>--market
(-V)</samp> flag will never convert a primary commodity into any other
commodity.  <samp>--exchange <var>COMMODITY</var> (-X)</samp> still will,
however.
</p>
<hr>
<a name="Posting-cost-expressions"></a>
<div class="header">
<p>
Next: <a href="#Total-posting-costs" accesskey="n" rel="next">Total posting costs</a>, Previous: <a href="#Explicit-posting-costs" accesskey="p" rel="prev">Explicit posting costs</a>, Up: <a href="#Transactions" accesskey="u" rel="up">Transactions</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Posting-cost-expressions-1"></a>
<h3 class="section">5.13 Posting cost expressions</h3>

<p>Just as you can have amount expressions, you can have posting
expressions:
</p>
<div class="smallexample">
<pre class="smallexample">2012-03-10 My Broker
    Assets:Brokerage             10 AAPL @ ($500.00 / 10)
    Assets:Brokerage:Cash
</pre></div>

<p>You can even have both:
</p>
<div class="smallexample">
<pre class="smallexample">2012-03-10 My Broker
    Assets:Brokerage             (5 AAPL * 2) @ ($500.00 / 10)
    Assets:Brokerage:Cash
</pre></div>

<hr>
<a name="Total-posting-costs"></a>
<div class="header">
<p>
Next: <a href="#Virtual-posting-costs" accesskey="n" rel="next">Virtual posting costs</a>, Previous: <a href="#Posting-cost-expressions" accesskey="p" rel="prev">Posting cost expressions</a>, Up: <a href="#Transactions" accesskey="u" rel="up">Transactions</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Total-posting-costs-1"></a>
<h3 class="section">5.14 Total posting costs</h3>

<p>The cost figure following the &lsquo;<samp>@</samp>&rsquo; character specifies the
<em>per-unit</em> price for the commodity being transferred.  If you&rsquo;d
like to specify the total cost instead, use &lsquo;<samp>@@</samp>&rsquo;:
</p>
<div class="smallexample">
<pre class="smallexample">2012-03-10 My Broker
    Assets:Brokerage             10 AAPL @@ $500.00
    Assets:Brokerage:Cash
</pre></div>

<p>Ledger reads this as if you had written:
</p>
<div class="smallexample">
<pre class="smallexample">2012-03-10 My Broker
    Assets:Brokerage             10 AAPL @ ($500.00 / 10)
    Assets:Brokerage:Cash
</pre></div>

<hr>
<a name="Virtual-posting-costs"></a>
<div class="header">
<p>
Next: <a href="#Commodity-prices" accesskey="n" rel="next">Commodity prices</a>, Previous: <a href="#Total-posting-costs" accesskey="p" rel="prev">Total posting costs</a>, Up: <a href="#Transactions" accesskey="u" rel="up">Transactions</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Virtual-posting-costs-1"></a>
<h3 class="section">5.15 Virtual posting costs</h3>

<p>Normally whenever a commodity exchange like this happens, the price of
the exchange (such as $50 per share of AAPL, above) is recorded in
Ledger&rsquo;s internal price history database.  To prevent this from
happening in the case of an exceptional transaction, surround the
&lsquo;<samp>@</samp>&rsquo; or &lsquo;<samp>@@</samp>&rsquo; with parentheses:
</p>
<div class="smallexample">
<pre class="smallexample">2012-03-10 My Brother
    Assets:Brokerage            1000 AAPL (@) $1
    Income:Gifts Received
</pre></div>

<hr>
<a name="Commodity-prices"></a>
<div class="header">
<p>
Next: <a href="#Prices-versus-costs" accesskey="n" rel="next">Prices versus costs</a>, Previous: <a href="#Virtual-posting-costs" accesskey="p" rel="prev">Virtual posting costs</a>, Up: <a href="#Transactions" accesskey="u" rel="up">Transactions</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Commodity-prices-1"></a>
<h3 class="section">5.16 Commodity prices</h3>
<a name="index-_002d_002dlot_002dprices"></a>

<p>When a transaction occurs that exchanges one commodity for another,
Ledger records that commodity price not only within its internal price
database, but also attached to the commodity itself.  Usually this fact
remains invisible to the user, unless you turn on <samp>--lot-prices</samp>
to show these hidden price figures.
</p>
<p>For example, consider the stock sale given above:
</p>
<div class="smallexample">
<pre class="smallexample">2012-03-10 My Broker
    Assets:Brokerage             10 AAPL @ $50.00
    Assets:Brokerage:Cash
</pre></div>

<p>The commodity transferred into &lsquo;<samp>Assets:Brokerage</samp>&rsquo; is not actually 10
AAPL, but rather 10 AAPL {$50.00}.  The figure in braces after the
amount is called the &ldquo;lot price&rdquo;.  It&rsquo;s Ledger&rsquo;s way of remembering
that this commodity was transferred through an exchange, and that
$50.00 was the price of that exchange.
</p>
<p>This becomes significant if you later sell that commodity again.  For
example, you might write this:
</p>
<div class="smallexample">
<pre class="smallexample">2012-04-10 My Broker
    Assets:Brokerage:Cash
    Assets:Brokerage            -10 AAPL @ $75.00
</pre></div>

<p>And that would be perfectly fine, but how do you track the capital
gains on the sale?  It could be done with a virtual posting:
</p>
<div class="smallexample">
<pre class="smallexample">2012-04-10 My Broker
    Assets:Brokerage:Cash
    Assets:Brokerage            -10 AAPL @ $75.00
    (Income:Capital Gains)      $-250.00
</pre></div>

<p>But this gets messy since capital gains income is very real, and not
quite appropriate for a virtual posting.
</p>
<p>Instead, if you reference that same hidden price annotation, Ledger
will figure out that the price of the shares you&rsquo;re selling, and the
cost you&rsquo;re selling them at, don&rsquo;t balance:
</p>
<div class="smallexample">
<pre class="smallexample">2012-04-10 My Broker
    Assets:Brokerage:Cash       $750.00
    Assets:Brokerage            -10 AAPL {$50.00} @ $75.00
</pre></div>

<p>This transaction will fail because the $250.00 price difference
between the price you bought those shares at, and the cost you&rsquo;re
selling them for, does not match.  The lot price also identifies which
shares you purchased on that prior date.
</p>
<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top">&bull; <a href="#Total-commodity-prices" accesskey="1">Total commodity prices</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
</table>

<hr>
<a name="Total-commodity-prices"></a>
<div class="header">
<p>
Previous: <a href="#Commodity-prices" accesskey="p" rel="prev">Commodity prices</a>, Up: <a href="#Commodity-prices" accesskey="u" rel="up">Commodity prices</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Total-commodity-prices-1"></a>
<h4 class="subsection">5.16.1 Total commodity prices</h4>

<p>As a shorthand, you can specify the total price instead of the
per-share price in doubled braces.  This goes well with total costs,
but is not required to be used with them:
</p>
<div class="smallexample">
<pre class="smallexample">2012-04-10 My Broker
    Assets:Brokerage:Cash       $750.00
    Assets:Brokerage            -10 AAPL {{$500.00}} @@ $750.00
    Income:Capital Gains       $-250.00
</pre></div>

<p>It should be noted that this is a convenience only for cases where you
buy and sell whole lots.  The {{$500.00}} is <em>not</em> an attribute
of the commodity, whereas {$50.00} is.  In fact, when you write
{{$500.00}}, Ledger just divides that value by 10 and sees
{$50.00}.  So if you use the print command to look at this
transaction, you&rsquo;ll see the single braces form in the output.  The
double braces price form is a shorthand only.
</p>
<p>Plus, it comes with dangers.  This works fine:
</p>
<div class="smallexample">
<pre class="smallexample">2012-04-10 My Broker
    Assets:Brokerage            10 AAPL @ $50.00
    Assets:Brokerage:Cash      $-500.00

2012-04-10 My Broker
    Assets:Brokerage:Cash       $375.00
    Assets:Brokerage            -5 AAPL {$50.00} @ $375.00
    Income:Capital Gains       $-125.00

2012-04-10 My Broker
    Assets:Brokerage:Cash       $375.00
    Assets:Brokerage            -5 AAPL {$50.00} @ $375.00
    Income:Capital Gains       $-125.00
</pre></div>

<p>But this does not do what you might expect:
</p>
<div class="smallexample">
<pre class="smallexample">2012-04-10 My Broker
    Assets:Brokerage            10 AAPL @ $50.00
    Assets:Brokerage:Cash      $-500.00

2012-04-10 My Broker
    Assets:Brokerage:Cash       $375.00
    Assets:Brokerage            -5 AAPL {{$500.00}} @ $375.00
    Income:Capital Gains       $-125.00

2012-04-10 My Broker
    Assets:Brokerage:Cash       $375.00
    Assets:Brokerage            -5 AAPL {{$500.00}} @ $375.00
    Income:Capital Gains       $-125.00
</pre></div>

<p>And in cases where the amounts do not divide into whole figures and
must be rounded, the capital gains figure could be off by a cent.  Use
with caution.
</p>
<hr>
<a name="Prices-versus-costs"></a>
<div class="header">
<p>
Next: <a href="#Fixated-prices-and-costs" accesskey="n" rel="next">Fixated prices and costs</a>, Previous: <a href="#Commodity-prices" accesskey="p" rel="prev">Commodity prices</a>, Up: <a href="#Transactions" accesskey="u" rel="up">Transactions</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Prices-versus-costs-1"></a>
<h3 class="section">5.17 Prices versus costs</h3>

<p>Because lot pricing provides enough information to infer the cost, the
following two transactions are equivalent:
</p>
<div class="smallexample">
<pre class="smallexample">2012-04-10 My Broker
    Assets:Brokerage            10 AAPL @ $50.00
    Assets:Brokerage:Cash      $-500.00

2012-04-10 My Broker
    Assets:Brokerage            10 AAPL {$50.00}
    Assets:Brokerage:Cash      $-500.00
</pre></div>

<p>However, note that what you see in some reports may differ, for
example in the print report.  Functionally, however, there is no
difference, and neither the register nor the balance report are
sensitive to this difference.
</p>
<hr>
<a name="Fixated-prices-and-costs"></a>
<div class="header">
<p>
Next: <a href="#Lot-dates" accesskey="n" rel="next">Lot dates</a>, Previous: <a href="#Prices-versus-costs" accesskey="p" rel="prev">Prices versus costs</a>, Up: <a href="#Transactions" accesskey="u" rel="up">Transactions</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Fixated-prices-and-costs-1"></a>
<h3 class="section">5.18 Fixated prices and costs</h3>

<p>If you bought a stock last year, and ask for its value today, Ledger
will consult its price database to see what the most recent price for
that stock is.  You can short-circuit this lookup by &ldquo;fixing&rdquo; the
price at the time of a transaction.  This is done using
&lsquo;<samp>{=AMOUNT}</samp>&rsquo;:
</p>
<div class="smallexample">
<pre class="smallexample">2012-04-10 My Broker
    Assets:Brokerage            10 AAPL {=$50.00}
    Assets:Brokerage:Cash      $-500.00
</pre></div>

<p>These 10 AAPL will now always be reported as being worth $50, no
matter what else happens to the stock in the meantime.
</p>
<p>Fixated prices are a special case of using lot valuation expressions
(see below) to fix the value of a commodity lot.
</p>
<p>Since price annotations and costs are largely interchangeable and
a matter of preference, there is an equivalent syntax for specified
fixated prices by way of the cost:
</p>
<div class="smallexample">
<pre class="smallexample">2012-04-10 My Broker
    Assets:Brokerage            10 AAPL @ =$50.00
    Assets:Brokerage:Cash      $-500.00
</pre></div>

<p>This is the same as the previous transaction, with the same caveats
found in <a href="#Prices-versus-costs">Prices versus costs</a>.
</p>
<hr>
<a name="Lot-dates"></a>
<div class="header">
<p>
Next: <a href="#Lot-notes" accesskey="n" rel="next">Lot notes</a>, Previous: <a href="#Fixated-prices-and-costs" accesskey="p" rel="prev">Fixated prices and costs</a>, Up: <a href="#Transactions" accesskey="u" rel="up">Transactions</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Lot-dates-1"></a>
<h3 class="section">5.19 Lot dates</h3>
<a name="index-_002d_002dlot_002ddates"></a>

<p>In addition to lot prices, you can specify lot dates and reveal them
with <samp>--lot-dates</samp>.  Other than that, however, they have no
special meaning to Ledger.  They are specified after the amount in
square brackets (the same way that dates are parsed in value
expressions):
</p>
<div class="smallexample">
<pre class="smallexample">2012-04-10 My Broker
    Assets:Brokerage:Cash       $375.00
    Assets:Brokerage            -5 AAPL {$50.00} [2012-04-10] @ $375.00
    Income:Capital Gains       $-125.00
</pre></div>

<hr>
<a name="Lot-notes"></a>
<div class="header">
<p>
Next: <a href="#Lot-value-expressions" accesskey="n" rel="next">Lot value expressions</a>, Previous: <a href="#Lot-dates" accesskey="p" rel="prev">Lot dates</a>, Up: <a href="#Transactions" accesskey="u" rel="up">Transactions</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Lot-notes-1"></a>
<h3 class="section">5.20 Lot notes</h3>
<a name="index-_002d_002dlot_002dnotes"></a>
<a name="index-_002d_002dlots"></a>

<p>You can also associate arbitrary notes for your own record keeping in
parentheses, and reveal them with <samp>--lot-notes</samp>.  One caveat is
that the note cannot begin with an &lsquo;<samp>@</samp>&rsquo; character, as that would
indicate a virtual cost:
</p>
<div class="smallexample">
<pre class="smallexample">2012-04-10 My Broker
    Assets:Brokerage:Cash       $375.00
    Assets:Brokerage            -5 AAPL {$50.00} [2012-04-10] (Oh my!) @ $375.00
    Income:Capital Gains       $-125.00
</pre></div>

<p>You can specify any combination of lot prices, dates or notes, in any
order.  They are all optional.
</p>
<p>To show all lot information in a report, use <samp>--lots</samp>.
</p>
<hr>
<a name="Lot-value-expressions"></a>
<div class="header">
<p>
Next: <a href="#Automated-Transactions" accesskey="n" rel="next">Automated Transactions</a>, Previous: <a href="#Lot-notes" accesskey="p" rel="prev">Lot notes</a>, Up: <a href="#Transactions" accesskey="u" rel="up">Transactions</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Lot-value-expressions-1"></a>
<h3 class="section">5.21 Lot value expressions</h3>

<p>Normally when you ask Ledger to display the values of commodities held,
it uses a value expression called &ldquo;market&rdquo; to determine the most
recent value from its price database&mdash;even downloading prices from the
Internet, if <samp>--download (-Q)</samp> was specified and a suitable
<samp>getquote</samp> script is found on your system.
</p>
<p>However, you can override this valuation logic by providing
a commodity valuation expression in doubled parentheses.  This
expression must result in one of two values: either an amount to
always be used as the per-share price for that commodity; or
a function taking three arguments, which is called to determine that
price.
</p>
<p>If you use the functional form, you can either specify a function
name, or a lambda expression.  Here&rsquo;s a function that yields the price
as $10 in whatever commodity is being requested:
</p>
<div class="smallexample">
<pre class="smallexample">define ten_dollars(s, date, t) = market($10, date, t)
</pre></div>

<p>I can now use that in a lot value expression as follows:
</p>
<div class="smallexample">
<pre class="smallexample">2012-04-10 My Broker
    Assets:Brokerage:Cash       $375.00
    Assets:Brokerage            -5 AAPL {$50.00} ((ten_dollars)) @@ $375.00
    Income:Capital Gains       $-125.00
</pre></div>

<p>Alternatively, I could do the same thing without pre-defining
a function by using a lambda expression taking three arguments:
</p>
<div class="smallexample">
<pre class="smallexample">2012-04-10 My Broker
    A:B:Cash       $375.00
    A:B     -5 AAPL {$50.00} ((s, d, t -&gt; market($10, date, t))) @@ $375.00
    Income:Capital Gains       $-125.00
</pre></div>

<p>The arguments passed to these functions have the following meaning:
</p>
<ul>
<li> source
The source commodity string, or an amount object.  If it is a string,
the return value must be an amount representing the price of the
commodity identified by that string (example: &lsquo;<samp>$</samp>&rsquo;).  If it is an
amount, return the value of that amount as a new amount (usually
calculated as commodity price times source amount).

</li><li> date
The date to use for determining the value.  If null, it means no date
was specified, which can mean whatever you want it to mean.

</li><li> target
If not null, a string representing the desired target commodity that the
commodity price, or repriced amount, should be valued in.  Note that
this string can be a comma-separated list, and that some or all of the
commodities in that list may be suffixed with an exclamation mark, to
indicate what is being desired.

</li></ul>

<p>In most cases, it is simplest to either use explicit amounts in your
valuation expressions, or just pass the arguments down to &lsquo;<samp>market</samp>&rsquo;
after modifying them to suit your needs.
</p>
<hr>
<a name="Automated-Transactions"></a>
<div class="header">
<p>
Previous: <a href="#Lot-value-expressions" accesskey="p" rel="prev">Lot value expressions</a>, Up: <a href="#Transactions" accesskey="u" rel="up">Transactions</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Automated-Transactions-1"></a>
<h3 class="section">5.22 Automated Transactions</h3>

<p>An automated transaction is a special kind of transaction which adds
its postings to other transactions any time one of that other
transactions&rsquo; postings matches its predicate.  The predicate uses the
same query syntax as the Ledger command-line.
</p>
<p>Consider this posting:
</p>
<div class="smallexample">
<pre class="smallexample">2012-03-10 KFC
    Expenses:Food                $20.00
    Assets:Cash
</pre></div>

<p>If I write this automated transaction before it in the file:
</p>
<div class="smallexample">
<pre class="smallexample">= expr true
    Foo                          $50.00
    Bar                         $-50.00
</pre></div>

<p>Then the first transaction will be modified during parsing as if I&rsquo;d
written this:
</p>
<div class="smallexample">
<pre class="smallexample">2012-03-10 KFC
    Expenses:Food                $20.00
    Foo                          $50.00
    Bar                         $-50.00
    Assets:Cash                 $-20.00
    Foo                          $50.00
    Bar                         $-50.00
</pre></div>

<p>Despite this fancy logic, automated transactions themselves follow
most of the same rules as regular transactions: their postings must
balance (unless you use a virtual posting), you can have metadata,
etc.
</p>
<p>One thing you cannot do, however, is elide amounts in an automated
transaction.
</p>
<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top">&bull; <a href="#Amount-multipliers" accesskey="1">Amount multipliers</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Accessing-the-matching-posting_0027s-amount" accesskey="2">Accessing the matching posting's amount</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Referring-to-the-matching-posting_0027s-account" accesskey="3">Referring to the matching posting's account</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Applying-metadata-to-every-matched-posting" accesskey="4">Applying metadata to every matched posting</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Applying-metadata-to-the-generated-posting" accesskey="5">Applying metadata to the generated posting</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#State-flags" accesskey="6">State flags</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Effective-Dates" accesskey="7">Effective Dates</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Periodic-Transactions" accesskey="8">Periodic Transactions</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Concrete-Example-of-Automated-Transactions" accesskey="9">Concrete Example of Automated Transactions</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
</table>

<hr>
<a name="Amount-multipliers"></a>
<div class="header">
<p>
Next: <a href="#Accessing-the-matching-posting_0027s-amount" accesskey="n" rel="next">Accessing the matching posting's amount</a>, Previous: <a href="#Automated-Transactions" accesskey="p" rel="prev">Automated Transactions</a>, Up: <a href="#Automated-Transactions" accesskey="u" rel="up">Automated Transactions</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Amount-multipliers-1"></a>
<h4 class="subsection">5.22.1 Amount multipliers</h4>

<p>As a special case, if an automated transaction&rsquo;s posting&rsquo;s amount
(phew) has no commodity, it is taken as a multiplier upon the matching
posting&rsquo;s cost.  For example:
</p>
<div class="smallexample">
<pre class="smallexample">= expr true
    Foo                           50.00
    Bar                          -50.00

2012-03-10 KFC
    Expenses:Food                $20.00
    Assets:Cash
</pre></div>

<p>Then the latter transaction turns into this during parsing:
</p>
<div class="smallexample">
<pre class="smallexample">2012-03-10 KFC
    Expenses:Food                $20.00
    Foo                        $1000.00
    Bar                       $-1000.00
    Assets:Cash                 $-20.00
    Foo                        $1000.00
    Bar                       $-1000.00
</pre></div>

<hr>
<a name="Accessing-the-matching-posting_0027s-amount"></a>
<div class="header">
<p>
Next: <a href="#Referring-to-the-matching-posting_0027s-account" accesskey="n" rel="next">Referring to the matching posting's account</a>, Previous: <a href="#Amount-multipliers" accesskey="p" rel="prev">Amount multipliers</a>, Up: <a href="#Automated-Transactions" accesskey="u" rel="up">Automated Transactions</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Accessing-the-matching-posting_0027s-amount-1"></a>
<h4 class="subsection">5.22.2 Accessing the matching posting&rsquo;s amount</h4>

<p>If you use an amount expression for an automated transaction&rsquo;s
posting, that expression has access to all the details of the matched
posting.  For example, you can refer to that posting&rsquo;s amount using
the &ldquo;amount&rdquo; value expression variable:
</p>
<div class="smallexample">
<pre class="smallexample">= expr true
    (Foo)                  (amount * 2)  ; same as just &quot;2&quot; in this case

2012-03-10 KFC
    Expenses:Food                $20.00
    Assets:Cash
</pre></div>

<p>This becomes:
</p>
<div class="smallexample">
<pre class="smallexample">2012-03-10 KFC
    Expenses:Food                $20.00
    (Foo)                        $40.00
    Assets:Cash                 $-20.00
    (Foo)                       $-40.00
</pre></div>

<hr>
<a name="Referring-to-the-matching-posting_0027s-account"></a>
<div class="header">
<p>
Next: <a href="#Applying-metadata-to-every-matched-posting" accesskey="n" rel="next">Applying metadata to every matched posting</a>, Previous: <a href="#Accessing-the-matching-posting_0027s-amount" accesskey="p" rel="prev">Accessing the matching posting's amount</a>, Up: <a href="#Automated-Transactions" accesskey="u" rel="up">Automated Transactions</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Referring-to-the-matching-posting_0027s-account-1"></a>
<h4 class="subsection">5.22.3 Referring to the matching posting&rsquo;s account</h4>

<p>Sometimes you want to refer to the account that was matched
in some way within the automated transaction itself.  This is
done by using the string &lsquo;<samp>$account</samp>&rsquo;, anywhere within the
account part of the automated posting:
</p>
<div class="smallexample">
<pre class="smallexample">= food
    (Budget:$account)                10

2012-03-10 KFC
    Expenses:Food                $20.00
    Assets:Cash
</pre></div>

<p>Becomes:
</p>
<div class="smallexample">
<pre class="smallexample">2012-03-10 KFC
    Expenses:Food                $20.00
    (Budget:Expenses:Food)      $200.00
    Assets:Cash                 $-20.00
</pre></div>

<hr>
<a name="Applying-metadata-to-every-matched-posting"></a>
<div class="header">
<p>
Next: <a href="#Applying-metadata-to-the-generated-posting" accesskey="n" rel="next">Applying metadata to the generated posting</a>, Previous: <a href="#Referring-to-the-matching-posting_0027s-account" accesskey="p" rel="prev">Referring to the matching posting's account</a>, Up: <a href="#Automated-Transactions" accesskey="u" rel="up">Automated Transactions</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Applying-metadata-to-every-matched-posting-1"></a>
<h4 class="subsection">5.22.4 Applying metadata to every matched posting</h4>

<p>If the automated transaction has a transaction note, that note is
copied (along with any metadata) to every posting that matches the
predicate:
</p>
<div class="smallexample">
<pre class="smallexample">= food
    ; Foo: Bar
    (Budget:$account)                10

2012-03-10 KFC
    Expenses:Food                $20.00
    Assets:Cash
</pre></div>

<p>Becomes:
</p>
<div class="smallexample">
<pre class="smallexample">2012-03-10 KFC
    Expenses:Food                $20.00
      ; Foo: Bar
    (Budget:Expenses:Food)      $200.00
    Assets:Cash                 $-20.00
</pre></div>

<hr>
<a name="Applying-metadata-to-the-generated-posting"></a>
<div class="header">
<p>
Next: <a href="#State-flags" accesskey="n" rel="next">State flags</a>, Previous: <a href="#Applying-metadata-to-every-matched-posting" accesskey="p" rel="prev">Applying metadata to every matched posting</a>, Up: <a href="#Automated-Transactions" accesskey="u" rel="up">Automated Transactions</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Applying-metadata-to-the-generated-posting-1"></a>
<h4 class="subsection">5.22.5 Applying metadata to the generated posting</h4>

<p>If the automated transaction&rsquo;s posting has a note, that note is
carried to the generated posting within the matched transaction:
</p>
<div class="smallexample">
<pre class="smallexample">= food
    (Budget:$account)                10
      ; Foo: Bar

2012-03-10 KFC
    Expenses:Food                $20.00
    Assets:Cash
</pre></div>

<p>Becomes:
</p>
<div class="smallexample">
<pre class="smallexample">2012-03-10 KFC
    Expenses:Food                $20.00
    (Budget:Expenses:Food)      $200.00
      ; Foo: Bar
    Assets:Cash                 $-20.00
</pre></div>

<p>This is slightly different from the rules for regular transaction
notes, in that an automated transaction&rsquo;s note does not apply to every
posting within the automated transaction itself, but rather to every
posting it matches.
</p>
<hr>
<a name="State-flags"></a>
<div class="header">
<p>
Next: <a href="#Effective-Dates" accesskey="n" rel="next">Effective Dates</a>, Previous: <a href="#Applying-metadata-to-the-generated-posting" accesskey="p" rel="prev">Applying metadata to the generated posting</a>, Up: <a href="#Automated-Transactions" accesskey="u" rel="up">Automated Transactions</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="State-flags-1"></a>
<h4 class="subsection">5.22.6 State flags</h4>

<p>Although you cannot mark an automated transaction as a whole as
cleared or pending, you can mark its postings with a &lsquo;<samp>*</samp>&rsquo; or
&lsquo;<samp>!</samp>&rsquo; before the account name, and that state flag gets carried to
the generated posting.
</p>
<hr>
<a name="Effective-Dates"></a>
<div class="header">
<p>
Next: <a href="#Periodic-Transactions" accesskey="n" rel="next">Periodic Transactions</a>, Previous: <a href="#State-flags" accesskey="p" rel="prev">State flags</a>, Up: <a href="#Automated-Transactions" accesskey="u" rel="up">Automated Transactions</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Effective-Dates-1"></a>
<h4 class="subsection">5.22.7 Effective Dates</h4>
<a name="index-effective-dates"></a>
<a name="index-_002d_002deffective"></a>

<p>In the real world, transactions do not take place instantaneously.
Purchases can take several days to post to a bank account.  And you may
pay ahead for something for which you want to distribute costs.  With
Ledger you can control every aspect of the timing of a transaction.
</p>
<p>Say you&rsquo;re in business.  If you bill a customer, you can enter
something like
</p>
<a name="index-effective-date-of-invoice"></a>

<div class="smallexample">
<pre class="smallexample">2008/01/01=2008/01/14 Client invoice  ;  estimated date you'll be paid
    Assets:Accounts Receivable            $100.00
    Income: Client name
</pre></div>

<p>Then, when you receive the payment, you change it to
</p>
<div class="smallexample">
<pre class="smallexample">2008/01/01=2008/01/15 Client invoice ;  actual date money received
    Assets:Accounts Receivable            $100.00
    Income: Client name
</pre></div>

<p>and add something like
</p>
<div class="smallexample">
<pre class="smallexample">2008/01/15 Client payment
    Assets:Checking                       $100.00
    Assets:Accounts Receivable
</pre></div>

<p>Now
</p>
<div class="smallexample">
<pre class="smallexample">$ ledger --begin 2008/01/01 --end 2008/01/14 bal Income
</pre></div>

<p>gives you your accrued income in the first two weeks of the year, and
</p>
<div class="smallexample">
<pre class="smallexample">$ ledger --effective --begin 2008/01/01 --end 2008/01/14 bal Income
</pre></div>

<p>gives you your cash basis income in the same two weeks.
</p>
<p>Another use is distributing costs out in time.  As an example, suppose
you just prepaid into a local vegetable co-op that sustains you
through the winter.  It costs $225 to join the program, so you write
a check.  You don&rsquo;t want your October grocery budget to be blown
because you bought food ahead, however.  What you really want is for
the money to be evenly distributed over the next six months so that
your monthly budgets gradually take a hit for the vegetables you&rsquo;ll
pick up from the co-op, even though you&rsquo;ve already paid for them.
</p>
<div class="smallexample">
<pre class="smallexample">2008/10/16 * (2090) Bountiful Blessings Farm
    Expenses:Food:Groceries                  $ 37.50  ; [=2008/10/01]
    Expenses:Food:Groceries                  $ 37.50  ; [=2008/11/01]
    Expenses:Food:Groceries                  $ 37.50  ; [=2008/12/01]
    Expenses:Food:Groceries                  $ 37.50  ; [=2009/01/01]
    Expenses:Food:Groceries                  $ 37.50  ; [=2009/02/01]
    Expenses:Food:Groceries                  $ 37.50  ; [=2009/03/01]
    Assets:Checking
</pre></div>

<p>This entry accomplishes this.  Every month you&rsquo;ll see an
automatic $37.50 deficit like you should, while your checking account
really knows that it debited $225 this month.
</p>
<p>And using the <samp>--effective</samp> option, the initial date will be
overridden by the effective dates.
</p>
<div class="smallexample">
<pre class="smallexample">$ ledger --effective register Groceries
</pre></div>

<div class="smallexample">
<pre class="smallexample">08-Oct-01 Bountiful Blessings.. Expense:Food:Groceries      $ 37.50      $ 37.50
08-Nov-01 Bountiful Blessings.. Expense:Food:Groceries      $ 37.50      $ 75.00
08-Dec-01 Bountiful Blessings.. Expense:Food:Groceries      $ 37.50     $ 112.50
09-Jan-01 Bountiful Blessings.. Expense:Food:Groceries      $ 37.50     $ 150.00
09-Feb-01 Bountiful Blessings.. Expense:Food:Groceries      $ 37.50     $ 187.50
09-Mar-01 Bountiful Blessings.. Expense:Food:Groceries      $ 37.50     $ 225.00
</pre></div>

<hr>
<a name="Periodic-Transactions"></a>
<div class="header">
<p>
Next: <a href="#Concrete-Example-of-Automated-Transactions" accesskey="n" rel="next">Concrete Example of Automated Transactions</a>, Previous: <a href="#Effective-Dates" accesskey="p" rel="prev">Effective Dates</a>, Up: <a href="#Automated-Transactions" accesskey="u" rel="up">Automated Transactions</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Periodic-Transactions-1"></a>
<h4 class="subsection">5.22.8 Periodic Transactions</h4>
<a name="index-_002d_002dbudget"></a>

<p>A periodic transaction starts with a tilde &lsquo;<samp>~</samp>&rsquo; followed by a period
expression (see <a href="#Period-Expressions">Period Expressions</a>).  Periodic transactions are used for budgeting and
forecasting only, they have no effect without the <samp>--budget</samp>
option specified.  For examples and details, see <a href="#Budgeting-and-Forecasting">Budgeting and Forecasting</a>.
</p>
<hr>
<a name="Concrete-Example-of-Automated-Transactions"></a>
<div class="header">
<p>
Previous: <a href="#Periodic-Transactions" accesskey="p" rel="prev">Periodic Transactions</a>, Up: <a href="#Automated-Transactions" accesskey="u" rel="up">Automated Transactions</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Concrete-Example-of-Automated-Transactions-1"></a>
<h4 class="subsection">5.22.9 Concrete Example of Automated Transactions</h4>

<p>As a Bah&rsquo;, I need to compute Huqqu&rsquo;llh whenever I acquire assets.
It is similar to tithing for Jews and Christians, or to Zakt for
Muslims.  The exact details of computing Huqqu&rsquo;llh are somewhat
complex, but if you have further interest, please consult the Web.
</p>
<p>Ledger makes this otherwise difficult law very easy.  Just set up an
automated posting at the top of your ledger file:
</p>
<div class="smallexample">
<pre class="smallexample">; This automated transaction will compute Huqqu'llh based on this
; journal's postings.  Any accounts that match will affect the
; Liabilities:Huququ'llah account by 19% of the value of that posting.

= /^(?:Income:|Expenses:(?:Business|Rent$|Furnishings|Taxes|Insurance))/
  (Liabilities:Huququ'llah)               0.19
</pre></div>

<p>This automated posting works by looking at each posting in the
ledger file.  If any match the given value expression, 19% of the
posting&rsquo;s value is applied to the &lsquo;<samp>Liabilities:Huququ'llah</samp>&rsquo;
account.  So, if $1000 is earned from &lsquo;<samp>Income:Salary</samp>&rsquo;, $190 is
added to &lsquo;<samp>Liabilities:Huqqu'llh</samp>&rsquo;; if $1000 is spent on Rent,
$190 is subtracted.
</p>
<div class="smallexample">
<pre class="smallexample">2003/01/01 (99) Salary
  Income:Salary  -$1000
  Assets:Checking

2003/01/01 (100) Rent
  Expenses:Rent  $500
  Assets:Checking
</pre></div>

<p>The ultimate balance of Huqqu&rsquo;llh reflects how
much is owed in order to fulfill one&rsquo;s obligation to Huqqu&rsquo;llh.
When ready to pay, just write a check to cover the amount shown in
&lsquo;<samp>Liabilities:Huququ'llah</samp>&rsquo;.  That transaction would look like:
</p>
<div class="smallexample">
<pre class="smallexample">2003/01/01 (101) Baha'i Huqqu'llh Trust
    Liabilities:Huququ'llah          $1,000.00
    Assets:Checking
</pre></div>

<p>That&rsquo;s it.  To see how much Huqq is currently owed based on your
ledger transactions, use:
</p>
<div class="smallexample">
<pre class="smallexample">$ ledger balance Liabilities:Huquq
</pre></div>

<div class="smallexample">
<pre class="smallexample">                $-95  Liabilities:Huququ'llah
</pre></div>

<p>This works fine, but omits one aspect of the law: that Huqq is only
due once the liability exceeds the value of 19 mithqls of gold (which
is roughly 2.22 ounces).  So what we want is for the liability to
appear in the balance report only when it exceeds the present day
value of 2.22 ounces of gold.  This can be accomplished using the
command:
</p>
<div class="smallexample">
<pre class="smallexample">$ ledger -Q -t &quot;/Liab.*Huquq/?(a/P{2.22 AU}&lt;={-1.0}&amp;a):a&quot; bal liab
</pre></div>

<p>With this command, the current price for gold is downloaded, and the
Huqqu&rsquo;llh is reported only if its value exceeds that of 2.22 ounces
of gold.  If you wish the liability to be reflected in the parent
subtotal either way, use this instead:
</p>
<div class="smallexample">
<pre class="smallexample">$ ledger -Q -T &quot;/Liab.*Huquq/?(O/P{2.22 AU}&lt;={-1.0}&amp;O):O&quot; bal liab
</pre></div>

<p>In some cases, you may wish to refer to the account of whichever posting
matched your automated transaction&rsquo;s value expression.  To do this, use
the special account name &lsquo;<samp>$account</samp>&rsquo;:
</p>
<div class="smallexample">
<pre class="smallexample">= /^Some:Long:Account:Name/
    [$account]  -0.10
    [Savings]    0.10
</pre></div>

<p>This example causes 10% of the matching account&rsquo;s total to be deferred
to the &lsquo;<samp>Savings</samp>&rsquo; account&mdash;as a balanced virtual posting, which
may be excluded from reports by using <samp>--real</samp>.
</p>
<hr>
<a name="Building-Reports"></a>
<div class="header">
<p>
Next: <a href="#Reporting-Commands" accesskey="n" rel="next">Reporting Commands</a>, Previous: <a href="#Transactions" accesskey="p" rel="prev">Transactions</a>, Up: <a href="#Top" accesskey="u" rel="up">Top</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Building-Reports-1"></a>
<h2 class="chapter">6 Building Reports</h2>

<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top">&bull; <a href="#Introduction" accesskey="1">Introduction</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Balance-Reports" accesskey="2">Balance Reports</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Typical-queries" accesskey="3">Typical queries</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Advanced-Reports" accesskey="4">Advanced Reports</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
</table>

<hr>
<a name="Introduction"></a>
<div class="header">
<p>
Next: <a href="#Balance-Reports" accesskey="n" rel="next">Balance Reports</a>, Previous: <a href="#Building-Reports" accesskey="p" rel="prev">Building Reports</a>, Up: <a href="#Building-Reports" accesskey="u" rel="up">Building Reports</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Introduction-1"></a>
<h3 class="section">6.1 Introduction</h3>

<p>The power of Ledger comes from the incredible flexibility in its
reporting commands, combined with formatting commands.  Some options
control what is included in the calculations, and formatting controls
how it is displayed.  The combinations are infinite.  This chapter will
show you the basics of combining various options and commands.  In the
next chapters you will find details about the specific commands and
options.
</p>
<hr>
<a name="Balance-Reports"></a>
<div class="header">
<p>
Next: <a href="#Typical-queries" accesskey="n" rel="next">Typical queries</a>, Previous: <a href="#Introduction" accesskey="p" rel="prev">Introduction</a>, Up: <a href="#Building-Reports" accesskey="u" rel="up">Building Reports</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Balance-Reports-1"></a>
<h3 class="section">6.2 Balance Reports</h3>

<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top">&bull; <a href="#Controlling-the-Accounts-and-Payees" accesskey="1">Controlling the Accounts and Payees</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Controlling-Formatting" accesskey="2">Controlling Formatting</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
</table>

<hr>
<a name="Controlling-the-Accounts-and-Payees"></a>
<div class="header">
<p>
Next: <a href="#Controlling-Formatting" accesskey="n" rel="next">Controlling Formatting</a>, Previous: <a href="#Balance-Reports" accesskey="p" rel="prev">Balance Reports</a>, Up: <a href="#Balance-Reports" accesskey="u" rel="up">Balance Reports</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Controlling-the-Accounts-and-Payees-1"></a>
<h4 class="subsection">6.2.1 Controlling the Accounts and Payees</h4>

<p>The balance report is the most commonly used report.  The simplest
invocation is:
</p>
<div class="smallexample">
<pre class="smallexample">$ ledger balance -f drewr3.dat
</pre></div>

<p>which will print the balances of every account in your journal.
</p>
<div class="smallexample">
<pre class="smallexample">         $ -3,804.00  Assets
          $ 1,396.00    Checking
             $ 30.00      Business
         $ -5,200.00    Savings
         $ -1,000.00  Equity:Opening Balances
          $ 6,654.00  Expenses
          $ 5,500.00    Auto
             $ 20.00    Books
            $ 300.00    Escrow
            $ 334.00    Food:Groceries
            $ 500.00    Interest:Mortgage
         $ -2,030.00  Income
         $ -2,000.00    Salary
            $ -30.00    Sales
            $ -63.60  Liabilities
            $ -20.00    MasterCard
            $ 200.00    Mortgage:Principal
           $ -243.60    Tithe
--------------------
           $ -243.60
</pre></div>

<p>Most times, this is more than you want.  Limiting the results to
specific accounts is as easy as entering the names of the accounts
after the command:
</p>
<div class="smallexample">
<pre class="smallexample">$ ledger balance -f drewr3.dat Auto MasterCard
</pre></div>

<div class="smallexample">
<pre class="smallexample">          $ 5,500.00  Expenses:Auto
            $ -20.00  Liabilities:MasterCard
--------------------
          $ 5,480.00
</pre></div>

<p>Note the implicit logical or between &lsquo;<samp>Auto</samp>&rsquo; and
&lsquo;<samp>Mastercard</samp>&rsquo;.
</p>
<p>If you want the entire contents of a branch of your account tree, use
the highest common name in the branch:
</p>
<div class="smallexample">
<pre class="smallexample">$ ledger balance -f drewr3.dat Income
</pre></div>

<div class="smallexample">
<pre class="smallexample">         $ -2,030.00  Income
         $ -2,000.00    Salary
            $ -30.00    Sales
--------------------
         $ -2,030.00
</pre></div>

<p>You can use general regular expressions in nearly any place Ledger
needs a string:
</p>
<div class="smallexample">
<pre class="smallexample">$ ledger balance -f drewr3.dat ^Bo
</pre></div>

<p>This first example looks for any account starting with &lsquo;<samp>Bo</samp>&rsquo;, of
which there are none.
</p>
<div class="smallexample">
<pre class="smallexample">$ ledger balance -f drewr3.dat Bo
</pre></div>

<div class="smallexample">
<pre class="smallexample">             $ 20.00  Expenses:Books
</pre></div>

<p>This second example looks for any account containing &lsquo;<samp>Bo</samp>&rsquo;, which is
&lsquo;<samp>Expenses:Books</samp>&rsquo;.
</p>
<a name="index-limit-by-payees"></a>
<a name="index-_002d_002dlimit-EXPR"></a>

<p>If you want to know exactly how much you have spent in a particular
account on a particular payee, the following are equivalent:
</p>
<div class="smallexample">
<pre class="smallexample">$ ledger balance Auto:Fuel and Chevron
</pre></div>

<div class="smallexample">
<pre class="smallexample">$ ledger balance --limit 'account=~/Fuel/' and 'payee=~/Chev/'
</pre></div>

<p>will show you the amount expended on gasoline at Chevron.  The second
example is the first example of the very powerful expression language
available to shape reports.  The first example may be easier to
remember, but learning to use the second will open up far more
possibilities.
</p>
<p>If you want to exclude specific accounts from the report, you can
exclude multiple accounts with parentheses:
</p>
<div class="smallexample">
<pre class="smallexample">$ ledger bal Expenses and not (Expenses:Drinks or Expenses:Candy or Expenses:Gifts)
</pre></div>

<hr>
<a name="Controlling-Formatting"></a>
<div class="header">
<p>
Previous: <a href="#Controlling-the-Accounts-and-Payees" accesskey="p" rel="prev">Controlling the Accounts and Payees</a>, Up: <a href="#Balance-Reports" accesskey="u" rel="up">Balance Reports</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Controlling-Formatting-1"></a>
<h4 class="subsection">6.2.2 Controlling Formatting</h4>

<p>These examples all use the default formatting for the balance
report.  Customizing the formatting can easily allowing to see only what
you want, or interface Ledger with other programs.
</p>
<hr>
<a name="Typical-queries"></a>
<div class="header">
<p>
Next: <a href="#Advanced-Reports" accesskey="n" rel="next">Advanced Reports</a>, Previous: <a href="#Balance-Reports" accesskey="p" rel="prev">Balance Reports</a>, Up: <a href="#Building-Reports" accesskey="u" rel="up">Building Reports</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Typical-queries-1"></a>
<h3 class="section">6.3 Typical queries</h3>

<p>A query such as the following shows all expenses since last
October, sorted by total:
</p>
<div class="smallexample">
<pre class="smallexample">$ ledger -b &quot;last oct&quot; -S T bal ^expenses
</pre></div>

<p>From left to right the options mean: Show transactions since last
October; sort by the absolute value of the total; and report the balance
for all accounts that begin with &lsquo;<samp>expenses</samp>&rsquo;.
</p>
<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top">&bull; <a href="#Reporting-monthly-expenses" accesskey="1">Reporting monthly expenses</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
</table>

<hr>
<a name="Reporting-monthly-expenses"></a>
<div class="header">
<p>
Previous: <a href="#Typical-queries" accesskey="p" rel="prev">Typical queries</a>, Up: <a href="#Typical-queries" accesskey="u" rel="up">Typical queries</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Reporting-monthly-expenses-1"></a>
<h4 class="subsection">6.3.1 Reporting monthly expenses</h4>
<a name="index-_002d_002dmonthly"></a>
<a name="index-_002d_002ddisplay-EXPR"></a>
<a name="index-_002d_002dperiod_002dsort-VEXPR"></a>
<a name="index-_002d_002drelated"></a>
<a name="index-_002d_002dsubtotal"></a>

<p>The following query makes it easy to see monthly expenses, with each
month&rsquo;s expenses sorted by the amount:
</p>
<div class="smallexample">
<pre class="smallexample">$ ledger -M --period-sort &quot;(amount)&quot; reg ^expenses
</pre></div>

<p>Now, you might wonder where the money came from to pay for these things.
To see that report, add <samp>--related (-r)</samp>, which shows the
&ldquo;related account&rdquo; postings:
</p>
<div class="smallexample">
<pre class="smallexample">$ ledger -M --period-sort &quot;(amount)&quot; -r reg ^expenses
</pre></div>

<p>But maybe this prints too much information.  You might just want to
see how much you&rsquo;re spending with your MasterCard.  That kind of query
requires the use of a display predicate, since the postings
calculated must match &lsquo;<samp>^expenses</samp>&rsquo;, while the postings
displayed must match &lsquo;<samp>mastercard</samp>&rsquo;.  The command would be:
</p>
<div class="smallexample">
<pre class="smallexample">$ ledger -M -r --display 'account=~/mastercard/' reg ^expenses
</pre></div>

<p>This query says: Report monthly subtotals; report the &ldquo;related
account&rdquo; postings; display only related postings whose
account matches &lsquo;<samp>mastercard</samp>&rsquo;, and base the calculation on
postings matching &lsquo;<samp>^expenses</samp>&rsquo;.
</p>
<p>This works just as well for reporting the overall total, too:
</p>
<div class="smallexample">
<pre class="smallexample">$ ledger -s -r --display &quot;account=~/mastercard/&quot; reg ^expenses
</pre></div>

<p>The <samp>--subtotal (-s)</samp> option subtotals all postings, just as
<samp>--monthly (-M)</samp> subtotaled by the month.  The running total in
both cases is off, however, since a display expression is being used.
</p>
<hr>
<a name="Advanced-Reports"></a>
<div class="header">
<p>
Previous: <a href="#Typical-queries" accesskey="p" rel="prev">Typical queries</a>, Up: <a href="#Building-Reports" accesskey="u" rel="up">Building Reports</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Advanced-Reports-1"></a>
<h3 class="section">6.4 Advanced Reports</h3>

<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top">&bull; <a href="#Asset-Allocation" accesskey="1">Asset Allocation</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Visualizing-with-Gnuplot" accesskey="2">Visualizing with Gnuplot</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
</table>

<hr>
<a name="Asset-Allocation"></a>
<div class="header">
<p>
Next: <a href="#Visualizing-with-Gnuplot" accesskey="n" rel="next">Visualizing with Gnuplot</a>, Previous: <a href="#Advanced-Reports" accesskey="p" rel="prev">Advanced Reports</a>, Up: <a href="#Advanced-Reports" accesskey="u" rel="up">Advanced Reports</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Asset-Allocation-1"></a>
<h4 class="subsection">6.4.1 Asset Allocation</h4>

<p>A very popular method of managing portfolios is to control the
percent allocation of assets by certain categories.  The mix of
categories and the weights applied to them vary by investing
philosophy, but most follow a similar pattern.  Tracking asset
allocation in ledger is not difficult but does require some additional
effort to describe how the various assets you own contribute to the
asset classes you want to track.
</p>
<p>In our simple example we assume you want to apportion your assets into
the general categories of domestic and international equities (stocks)
and a combined category of bonds and cash.  For illustrative purposes,
we will use several publicly available mutual funds from Vanguard.
The three funds we will track are the Vanguard 500 IDX FD Signal
(VIFSX), the Vanguard Target Retirement 2030 (VTHRX), and the Vanguard
Short Term Federal Fund (VSGBX).  Each of these funds allocates assets
to different categories of the investment universe and in different
proportions.  When you buy a share of VTHRX, that share is partially
invested in equities, and partially invested in bonds and cash.  Below
is the asset allocation for each of the instruments listed above:
</p>
<table>
<tr><td width="20%"></td><td width="20%">Domestic</td><td width="30%">Global</td><td width="30%"></td></tr>
<tr><td width="20%">Symbol</td><td width="20%">Equity</td><td width="30%">Equity</td><td width="30%">bonds/cash</td></tr>
<tr><td width="20%">VIFSX</td><td width="20%">100%</td><td width="30%"></td><td width="30%"></td></tr>
<tr><td width="20%">VTHRX</td><td width="20%">24.0%</td><td width="30%">56.3%</td><td width="30%">19.7%</td></tr>
<tr><td width="20%">VSGBX</td><td width="20%"></td><td width="30%"></td><td width="30%">100%</td></tr>
</table>

<p>These numbers are available from the prospectus of any publicly
available mutual fund.  Of course a single stock issue is 100% equity
and a single bond issue is 100% bonds.
</p>
<p>We track purchases of specific investments using the symbol of that
investment as its commodity.  How do we tell Ledger that a share of
VTHRX is 24% Domestic equity?  Enter automatic transactions and
virtual accounts.
</p>
<p>At the top of our ledger we enter automatic transactions that describe
these proportions to Ledger.  In the same entries we set up virtual
accounts that let us separate these abstract calculations from our
actual balances.
</p>
<p>For the three instruments listed above, those automatic transactions
would look like:
</p>
<div class="smallexample">
<pre class="smallexample">= expr ( commodity == 'VIFSX' )
    (Allocation:Equities:Domestic)             1.000

= expr ( commodity == 'VTHRX' )
    (Allocation:Equities:Global)               0.240
    (Allocation:Equities:Domestic)             0.563
    (Allocation:Bonds/Cash)                    0.197

= expr ( commodity == 'VBMFX')
    (Allocation:Bonds/Cash)                    1.000

2015-01-01 Buy VIFSX
    Assets:Broker                                100 VIFSX
    Assets:Cash                              $-10000

2015-01-01 Buy VTHRX
    Assets:Broker                                 10 VTHRX
    Assets:Cash                              $-10000

2015-01-01 Buy VBMFX
    Assets:Broker                                  1 VBMFX
    Assets:Cash                              $-10000
</pre></div>

<p>How do these work? First the &lsquo;<samp>=</samp>&rsquo; sign at the beginning of the
line tells ledger this is an automatic transaction to be applied when
the condition following the &lsquo;<samp>=</samp>&rsquo; is true.  After the &lsquo;<samp>=</samp>&rsquo; sign
is a value expression (see <a href="#Value-Expressions">Value Expressions</a>) that returns true
any time a posting contains the commodity of interest.
</p>
<p>The following line gives the proportions (not percentages) of each unit
of commodity that belongs to each asset class.  Whenever Ledger sees a
buy or sell of a particular commodity it will credit or debit these
virtual accounts with that proportion of the number of shares moved.
</p>
<p>Now that Ledger understands how to distribute the commodities amongst
the various asset classes how do we get a report that tells us our
current allocation?  Using the balance command and some tricky
formatting!
</p>
<div class="smallexample">
<pre class="smallexample">ledger bal Allocation --current --format &quot;\
        %-17((depth_spacer)+(partial_account))\
        %10(percent(market(display_total), market(parent.total)))\
        %16(market(display_total))\n%/&quot;
</pre></div>

<p>Which yields:
</p>
<div class="smallexample">
<pre class="smallexample">        Allocation                  100.00%                  $30000
          Bonds/Cash                 39.90%                  $11970
          Equities                   60.10%                  $18030
            Domestic                 86.69%                  $15630
            Global                   13.31%                   $2400
</pre></div>

<p>Let&rsquo;s look at the Ledger invocation a bit closer.  The command above is
split into lines for clarity.  The first line is very vanilla Ledger
asking for the current balances of the account in the &ldquo;Allocation&rdquo;
tree, using a special formatter.
</p>
<a name="index-depth_005fspacer"></a>
<a name="index-display_005ftotal"></a>
<a name="index-parent_002etotal"></a>
<p>The magic is in the formatter.  The second line simply tells Ledger to
print the partial account name indented by its depth in the tree.  The
third line is where we calculate and display the percentages.  The
<code>display_total</code> command gives the values of the total calculated
for the account in this line.  The <code>parent.total</code> command gives
the total for the next level up in the tree.  <code>percent</code> formats
their ratio as a percentage.  The fourth line tells ledger to display
the current market value of the line.  The last two characters
&lsquo;<samp>%/</samp>&rsquo; tell Ledger what to do for the last line, in this case,
nothing.
</p>
<hr>
<a name="Visualizing-with-Gnuplot"></a>
<div class="header">
<p>
Previous: <a href="#Asset-Allocation" accesskey="p" rel="prev">Asset Allocation</a>, Up: <a href="#Advanced-Reports" accesskey="u" rel="up">Advanced Reports</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Visualizing-with-Gnuplot-1"></a>
<h4 class="subsection">6.4.2 Visualizing with Gnuplot</h4>
<a name="index-plotting"></a>
<a name="index-Gnuplot"></a>
<a name="index-_002d_002damount_002ddata"></a>
<a name="index-_002d_002dtotal_002ddata"></a>
<a name="index-_002d_002dlimit-EXPR-1"></a>
<a name="index-_002d_002ddisplay-EXPR-1"></a>

<p>If you have the &ldquo;Gnuplot&rdquo; program installed, you can graph any of the
above register reports.  The script to do this is included in the ledger
distribution, and is named <samp>contrib/report</samp>.  Install <samp>report</samp>
anywhere along your <code>PATH</code>, and then use <samp>report</samp> instead of
<samp>ledger</samp> when doing a register report.  The only thing to keep in
mind is that you must specify <samp>--amount-data (-j)</samp> or
<samp>--total-data (-J)</samp> to indicate whether &ldquo;Gnuplot&rdquo; should plot
the amount, or the running total.  For example, this command plots total
monthly expenses made on your MasterCard.
</p>
<div class="smallexample">
<pre class="smallexample">$ report -j -M -r --display &quot;account =~ /mastercard/&quot; reg ^expenses
</pre></div>

<p>The <samp>report</samp> script is a very simple Bourne shell script, that
passes a set of scripted commands to &ldquo;Gnuplot&rdquo;.  Feel free to modify
the script to your liking, since you may prefer histograms to line
plots, for example.
</p>
<p>Here are some useful plots:
</p>
<div class="smallexample">
<pre class="smallexample">report -j -M reg ^expenses         # monthly expenses
report -J reg checking             # checking account balance
report -J reg ^income ^expenses    # cash flow report

# net worth report, ignoring non-$ postings

report -J -l &quot;Ua&gt;={\$0.01}&quot; reg ^assets ^liab

# net worth report starting last February. the use of a display
# predicate (-d) is needed, otherwise the balance will start at
# zero, and thus the y-axis will not reflect the true balance

report -J -l &quot;Ua&gt;={\$0.01}&quot; -d &quot;d&gt;=[last feb]&quot; reg ^assets ^liab
</pre></div>

<p>The last report uses both a calculation predicate <samp>--limit
<var>EXPR</var> (-l)</samp> and a display predicate <samp>--display <var>EXPR</var>
(-d)</samp>.  The calculation predicate limits the report to postings whose
amount is greater than or equal to $1 (which can only happen if the
posting amount is in dollars).  The display predicate limits the
transactions <em>displayed</em> to just those since last February, even
though those transactions from before will be computed as part of the
balance.
</p>
<hr>
<a name="Reporting-Commands"></a>
<div class="header">
<p>
Next: <a href="#Command_002dLine-Syntax" accesskey="n" rel="next">Command-Line Syntax</a>, Previous: <a href="#Building-Reports" accesskey="p" rel="prev">Building Reports</a>, Up: <a href="#Top" accesskey="u" rel="up">Top</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Reporting-Commands-1"></a>
<h2 class="chapter">7 Reporting Commands</h2>

<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top">&bull; <a href="#Primary-Financial-Reports" accesskey="1">Primary Financial Reports</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Reports in other formats:: Reports about
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Reports-in-other-Formats" accesskey="2">Reports in other Formats</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Reports-about-your-Journals" accesskey="3">Reports about your Journals</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
</table>

<hr>
<a name="Primary-Financial-Reports"></a>
<div class="header">
<p>
Next: <a href="#Reports-in-other-Formats" accesskey="n" rel="next">Reports in other Formats</a>, Previous: <a href="#Reporting-Commands" accesskey="p" rel="prev">Reporting Commands</a>, Up: <a href="#Reporting-Commands" accesskey="u" rel="up">Reporting Commands</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Primary-Financial-Reports-1"></a>
<h3 class="section">7.1 Primary Financial Reports</h3>

<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top">&bull; <a href="#The-balance-command" accesskey="1">The <code>balance</code> command</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#The-equity-command" accesskey="2">The <code>equity</code> command</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#The-register-command" accesskey="3">The <code>register</code> command</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#The-print-command" accesskey="4">The <code>print</code> command</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
</table>

<hr>
<a name="The-balance-command"></a>
<div class="header">
<p>
Next: <a href="#The-equity-command" accesskey="n" rel="next">The <code>equity</code> command</a>, Previous: <a href="#Primary-Financial-Reports" accesskey="p" rel="prev">Primary Financial Reports</a>, Up: <a href="#Primary-Financial-Reports" accesskey="u" rel="up">Primary Financial Reports</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="The-balance-command-1"></a>
<h4 class="subsection">7.1.1 The <code>balance</code> command</h4>
<a name="index-balance-1"></a>

<p>The <code>balance</code> command reports the current balance of all
accounts.  It accepts a list of optional regexes, which confine the
balance report to the matching accounts.  If an account contains
multiple types of commodities, each commodity&rsquo;s total is reported
separately.
</p>
<hr>
<a name="The-equity-command"></a>
<div class="header">
<p>
Next: <a href="#The-register-command" accesskey="n" rel="next">The <code>register</code> command</a>, Previous: <a href="#The-balance-command" accesskey="p" rel="prev">The <code>balance</code> command</a>, Up: <a href="#Primary-Financial-Reports" accesskey="u" rel="up">Primary Financial Reports</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="The-equity-command-1"></a>
<h4 class="subsection">7.1.2 The <code>equity</code> command</h4>
<a name="index-equity-1"></a>

<p>The <code>equity</code> command prints out account balances as if they
were transactions.  This makes it easy to establish the starting
balances for an account, such as when <a href="#Archiving-Previous-Years">Archiving Previous Years</a>.
</p>
<hr>
<a name="The-register-command"></a>
<div class="header">
<p>
Next: <a href="#The-print-command" accesskey="n" rel="next">The <code>print</code> command</a>, Previous: <a href="#The-equity-command" accesskey="p" rel="prev">The <code>equity</code> command</a>, Up: <a href="#Primary-Financial-Reports" accesskey="u" rel="up">Primary Financial Reports</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="The-register-command-1"></a>
<h4 class="subsection">7.1.3 The <code>register</code> command</h4>
<a name="index-register-4"></a>
<a name="index-_002d_002damount_002ddata-1"></a>
<a name="index-_002d_002dtotal_002ddata-1"></a>

<p>The <code>register</code> command displays all the postings occurring in
a single account, line by line.  The account regex must be specified as
the only argument to this command.  If any regexes occur after the
required account name, the register will contain only those postings
that match, which makes it very useful for hunting down a particular
posting.
</p>
<p>The output from <code>register</code> is very close to what a typical
checkbook, or single-account ledger, would look like.  It also shows a
running balance.  The final running balance of any register should
always be the same as the current balance of that account.
</p>
<p>If you have &ldquo;Gnuplot&rdquo; installed, you may plot the amount or running
total of any register by using the script <samp>report</samp>, which is
included in the Ledger distribution.  The only requirement is that you
add either <samp>--amount-data (-j)</samp> or <samp>--total-data (-J)</samp> to
your <code>register</code> command, in order to plot either the amount or
total column, respectively.
</p>
<hr>
<a name="The-print-command"></a>
<div class="header">
<p>
Previous: <a href="#The-register-command" accesskey="p" rel="prev">The <code>register</code> command</a>, Up: <a href="#Primary-Financial-Reports" accesskey="u" rel="up">Primary Financial Reports</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="The-print-command-1"></a>
<h4 class="subsection">7.1.4 The <code>print</code> command</h4>
<a name="index-print-3"></a>

<p>The <code>print</code> command prints out ledger transactions in a textual
format that can be parsed by Ledger.  They will be properly formatted,
and output in the most economic form possible.  The <code>print</code>
command also takes a list of optional regexes, which will cause only
those postings which match in some way to be printed.
</p>
<p>The <code>print</code> command can be a handy way to clean up a ledger
file whose formatting has gotten out of hand.
</p>
<hr>
<a name="Reports-in-other-Formats"></a>
<div class="header">
<p>
Next: <a href="#Reports-about-your-Journals" accesskey="n" rel="next">Reports about your Journals</a>, Previous: <a href="#Primary-Financial-Reports" accesskey="p" rel="prev">Primary Financial Reports</a>, Up: <a href="#Reporting-Commands" accesskey="u" rel="up">Reporting Commands</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Reports-in-other-Formats-1"></a>
<h3 class="section">7.2 Reports in other Formats</h3>

<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top">&bull; <a href="#Comma-Separated-Values-files" accesskey="1">Comma Separated Values files</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#The-lisp-command" accesskey="2">The <code>lisp</code> command</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Emacs-org-Mode" accesskey="3">Emacs <code>org</code> Mode</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Org-mode-with-Babel" accesskey="4">Org mode with Babel</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#The-pricemap-command" accesskey="5">The <code>pricemap</code> command</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#The-xml-command" accesskey="6">The <code>xml</code> command</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#prices-and-pricedb-commands" accesskey="7"><code>prices</code> and <code>pricedb</code> commands</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
</table>

<hr>
<a name="Comma-Separated-Values-files"></a>
<div class="header">
<p>
Next: <a href="#The-lisp-command" accesskey="n" rel="next">The <code>lisp</code> command</a>, Previous: <a href="#Reports-in-other-Formats" accesskey="p" rel="prev">Reports in other Formats</a>, Up: <a href="#Reports-in-other-Formats" accesskey="u" rel="up">Reports in other Formats</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Comma-Separated-Values-files-1"></a>
<h4 class="subsection">7.2.1 Comma Separated Values files</h4>

<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top">&bull; <a href="#The-csv-command" accesskey="1">The <code>csv</code> command</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#The-convert-command" accesskey="2">The <code>convert</code> command</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
</table>

<hr>
<a name="The-csv-command"></a>
<div class="header">
<p>
Next: <a href="#The-convert-command" accesskey="n" rel="next">The <code>convert</code> command</a>, Previous: <a href="#Comma-Separated-Values-files" accesskey="p" rel="prev">Comma Separated Values files</a>, Up: <a href="#Comma-Separated-Values-files" accesskey="u" rel="up">Comma Separated Values files</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="The-csv-command-1"></a>
<h4 class="subsubsection">7.2.1.1 The <code>csv</code> command</h4>
<a name="index-csv"></a>

<p>The <code>csv</code> command prints the desired ledger
transactions in a csv format suitable for importing into other programs.
You can specify the transactions to print using all the normal
limiting and searching functions.
</p>
<hr>
<a name="The-convert-command"></a>
<div class="header">
<p>
Previous: <a href="#The-csv-command" accesskey="p" rel="prev">The <code>csv</code> command</a>, Up: <a href="#Comma-Separated-Values-files" accesskey="u" rel="up">Comma Separated Values files</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="The-convert-command-1"></a>
<h4 class="subsubsection">7.2.1.2 The <code>convert</code> command</h4>
<a name="index-csv-importing-1"></a>
<a name="index-comma-separated-variable-file-reading"></a>
<a name="index-convert"></a>
<a name="index-_002d_002dinput_002ddate_002dformat-DATE_005fFORMAT"></a>

<p>The <code>convert</code> command parses a comma separated value (csv) file
and prints Ledger transactions.  Many banks offer csv file downloads.
Unfortunately, the file formats, aside from the commas, are all
different.  The ledger <code>convert</code> command tries to help as much
as it can.
</p>
<p>Your bank&rsquo;s csv files will have fields in different orders from other
banks, so there must be a way to tell Ledger what to expect.  Insert
a line at the beginning of the csv file that describes the fields to
Ledger.
</p>
<p>For example, this is a portion of a csv file downloaded from a credit
union in the United States:
</p>
<div class="smallexample">
<pre class="smallexample">Account Name: VALUFIRST CHECKING
Account Number: 71
Date Range: 11/13/2011 - 12/13/2011

Transaction Number,Date,Description,Memo,Amount Debit,Amount Credit,Balance,Check Number,Fees
767718,12/13/2011,&quot;Withdrawal&quot;,&quot;ACE HARDWARE 16335 S HOUGHTON RD&quot;,-8.80,,00001640.04,,
767406,12/13/2011,&quot;Withdrawal&quot;,&quot;ACE HARDWARE 16335 S HOUGHTON RD&quot;,-1.03,,00001648.84,,
683342,12/13/2011,&quot;Visa Checking&quot;,&quot;NetFlix Date 12/12/11 000326585896 5968&quot;,-21.85,,00001649.87,,
639668,12/13/2011,&quot;Withdrawal&quot;,&quot;ID: 1741472662 CO: XXAA.COM PAYMNT&quot;,-236.65,,00001671.72,,
1113648,12/12/2011,&quot;Withdrawal&quot;,&quot;Tuscan IT #00037657&quot;,-29.73,,00001908.37,,
</pre></div>

<p>Unfortunately, as it stands Ledger cannot read it, but you can.  Ledger
expects the first line to contain a description of the fields on each
line of the file.  The fields ledger can recognize contain these
case-insensitive strings <code>date</code>, <code>posted</code>, <code>code</code>,
<code>payee</code> or <code>desc</code> or <code>description</code>, <code>amount</code>,
<code>cost</code>, <code>total</code>, and <code>note</code>.
</p>
<p>Delete the account description lines at the top, and replace the first
line in the data above with:
</p>
<div class="smallexample">
<pre class="smallexample">,date,payee,note,amount,,,code,
</pre></div>

<p>Then execute ledger like this:
</p>
<div class="smallexample">
<pre class="smallexample">$ ledger convert download.csv --input-date-format &quot;%m/%d/%Y&quot;
</pre></div>

<p>Where the <samp>--input-date-format <var>DATE_FORMAT</var></samp> option tells
ledger how to interpret the dates.
</p>
<p>Importing csv files is a lot of work, but is very amenable to
scripting.
</p>
<p>If there are columns in the bank data you would like to keep in your
ledger data, besides the primary fields described above, you can name
them in the field descriptor list and Ledger will include them in the
transaction as meta data if it doesn&rsquo;t recognize the field name.  For
example, if you want to capture the bank transaction number and it
occurs in the first column of the data use:
</p>
<div class="smallexample">
<pre class="smallexample">transid,date,payee,note,amount,,,code,
</pre></div>

<p>Ledger will include &lsquo;<samp>; transid: 767718</samp>&rsquo; in the first transaction
from the file above.
</p>
<a name="index-_002d_002dinvert"></a>
<a name="index-_002d_002dauto_002dmatch"></a>
<a name="index-_002d_002daccount-STR"></a>
<a name="index-_002d_002drich_002ddata"></a>

<p>The <code>convert</code> command accepts four options.  They are
<samp>--invert</samp> which inverts the amount field, <samp>--auto-match</samp>
which automatically matches an account from the Ledger journal for every
CSV line, <samp>--account <var>STR</var></samp> which you can use to specify the
account to balance against, and <samp>--rich-data</samp> which stores
additional tag/value pairs.
</p>
<p>Using the two first lines of the above csv file,
</p>
<div class="smallexample">
<pre class="smallexample">,date,payee,note,amount,,,code,
767718,12/13/2011,&quot;Withdrawal&quot;,&quot;ACE HARDWARE 16335 S HOUGHTON RD&quot;,-8.80,,00001640.04,,
767406,12/13/2011,&quot;Withdrawal&quot;,&quot;ACE HARDWARE 16335 S HOUGHTON RD&quot;,-1.03,,00001648.84,,
</pre></div>

<p>and launching the below command,
</p>
<div class="smallexample">
<pre class="smallexample">$ ledger convert download.csv --input-date-format &quot;%m/%d/%Y&quot; \
  --invert --account Assets:MyBank --rich-data \
  --file sample.dat --now=2012/01/13
</pre></div>

<p>you will get the result:
</p>
<div class="smallexample">
<pre class="smallexample">2011/12/13 * Withdrawal  ;ACE HARDWARE 16335 S HOUGHTON RD
    ; CSV: 767718,12/13/2011,&quot;Withdrawal&quot;,&quot;ACE HARDWARE 16335 S HOUGHTON RD&quot;,-8.80,,00001640.04,,
    ; Imported: 2012/01/13
    ; UUID: dfdc3c3d5c54c6967dd39d5b4e4fd1ea76e87233
    Expenses:Unknown                             8.8
    Assets:MyBank

2011/12/13 * Withdrawal  ;ACE HARDWARE 16335 S HOUGHTON RD
    ; CSV: 767406,12/13/2011,&quot;Withdrawal&quot;,&quot;ACE HARDWARE 16335 S HOUGHTON RD&quot;,-1.03,,00001648.84,,
    ; Imported: 2012/01/13
    ; UUID: 63086448b1f29f7fd6efb11ea40660185a213f9d
    Expenses:Unknown                            1.03
    Assets:MyBank
</pre></div>

<p>The three added metadata are: &lsquo;<samp>CSV</samp>&rsquo; as the original line from csv
file, &lsquo;<samp>Imported</samp>&rsquo; as the date when the csv file was imported into
Ledger, and &lsquo;<samp>UUID</samp>&rsquo; as a checksum of original csv line.
</p>
<p>If an entry with the same &lsquo;<samp>UUID</samp>&rsquo; tag is already included in the
normal ledger file (specified via <samp>--file <var>FILE</var> (-f)</samp> or via
the environment variable <code>LEDGER_FILE</code>) this entry will not be
printed again.
</p>
<p>In the output above, the account is &lsquo;<samp>Expenses:Unknown</samp>&rsquo; for CSV
lines.  You can use the <samp>--auto-match</samp> option to automatically
match an account from your Ledger journal.
</p>
<p>You can also use <code>convert</code> with <code>payee</code> and <code>account</code>
directives.  First, you can use the <code>payee</code> and <code>alias</code>
directive to rewrite the <code>payee</code> field based on some rules.  Then
you can use the account and its <code>payee</code> directive to specify the
account.  I use it like this, for example:
</p>
<div class="smallexample">
<pre class="smallexample">payee Aldi
    alias ^ALDI SUED SAGT DANKE
account Aufwand:Einkauf:Lebensmittel
    payee ^(Aldi|Alnatura|Kaufland|REWE)$
</pre></div>

<p>Note that it may be necessary for the output of &lsquo;<samp>ledger convert</samp>&rsquo;
to be passed through <code>ledger print</code> a second time if you want to
match on the new payee field.  During the <code>ledger convert</code> run,
only the original payee name as specified in the csv data seems to be
used.
</p>
<hr>
<a name="The-lisp-command"></a>
<div class="header">
<p>
Next: <a href="#Emacs-org-Mode" accesskey="n" rel="next">Emacs <code>org</code> Mode</a>, Previous: <a href="#Comma-Separated-Values-files" accesskey="p" rel="prev">Comma Separated Values files</a>, Up: <a href="#Reports-in-other-Formats" accesskey="u" rel="up">Reports in other Formats</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="The-lisp-command-1"></a>
<h4 class="subsection">7.2.2 The <code>lisp</code> command</h4>
<a name="index-lisp"></a>
<a name="index-emacs"></a>

<p>The <code>lisp</code> command prints results in a form that can be read
directly by Emacs Lisp.  The format of the <code>sexp</code> is:
</p>
<div class="smallexample">
<pre class="smallexample">((BEG-POS CLEARED DATE CODE PAYEE
  (ACCOUNT AMOUNT)...)  ; list of postings
 ...)                   ; list of transactions
</pre></div>

<p><code>emacs</code> can also be used as a synonym for <code>lisp</code>.
</p>
<hr>
<a name="Emacs-org-Mode"></a>
<div class="header">
<p>
Next: <a href="#Org-mode-with-Babel" accesskey="n" rel="next">Org mode with Babel</a>, Previous: <a href="#The-lisp-command" accesskey="p" rel="prev">The <code>lisp</code> command</a>, Up: <a href="#Reports-in-other-Formats" accesskey="u" rel="up">Reports in other Formats</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Emacs-org-Mode-1"></a>
<h4 class="subsection">7.2.3 Emacs <code>org</code> Mode</h4>
<a name="index-org"></a>

<p>The <code>org</code> command produces a journal file suitable for use in
the Emacs Org mode.  More details on using Org mode can be found at
<a href="http://www.orgmode.org">http://www.orgmode.org</a>.
</p>
<p>Org mode has a sub-system known as Babel which allows for literate
programming.  This allows you to mix text and code within the same
document and automatically execute code which may generate results
which will then appear in the text.
</p>
<p>One of the languages supported by Babel is Ledger, so that you can have
ledger commands embedded in a text file and have the output of ledger
commands also appear in the text file.  The output can be updated
whenever any new ledger entries are added.
</p>
<p>For instance, the following Org mode text document snippet illustrates
a very naive but still useful application of the Babel system:
</p>
<div class="smallexample">
<pre class="smallexample">* A simple test of ledger in an org file
The following are some entries and I have requested that ledger be run
to generate a balance on the accounts.  I could have asked for
a register or, in fact, anything at all the ledger can do through
command-line options.

#+begin_src ledger :cmdline bal :results value
2010/01/01 * Starting balance
  assets:bank:savings       1300.00
  income:starting balances
2010/07/22 * Got paid
  assets:bank:chequing      1000.00
  income:salary
2010/07/23 Rent
  expenses:rent              500.00
  assets:bank:chequing
#+end_src

#+results:
:            1800.00  assets:bank
:             500.00    chequing
:            1300.00    savings
:             500.00  expenses:rent
:           -2300.00  income
:           -1000.00    salary
:           -1300.00    starting balances
</pre></div>

<p>Typing <kbd>C-c C-c</kbd> anywhere in the &ldquo;ledger source code block&rdquo; will
invoke ledger on the contents of that block and generate a &ldquo;results&rdquo;
block.  The results block can appear anywhere in the file but, by
default, will appear immediately below the source code block.
</p>
<p>You can combine multiple source code blocks before executing ledger and
do all kinds of other wonderful things with Babel (and Org mode).
</p>
<hr>
<a name="Org-mode-with-Babel"></a>
<div class="header">
<p>
Next: <a href="#The-pricemap-command" accesskey="n" rel="next">The <code>pricemap</code> command</a>, Previous: <a href="#Emacs-org-Mode" accesskey="p" rel="prev">Emacs <code>org</code> Mode</a>, Up: <a href="#Reports-in-other-Formats" accesskey="u" rel="up">Reports in other Formats</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Org-mode-with-Babel-1"></a>
<h4 class="subsection">7.2.4 Org mode with Babel</h4>

<p>Using Babel, it is possible to record financial transactions
conveniently in an org file and subsequently generate the financial
reports required.
</p>
<p>As of Org mode 7.01, Ledger support is provided.  Check the Babel
documentation on Worg for instructions on how to achieve this but
I currently do this directly as follows:
</p>
<div class="smallexample">
<pre class="smallexample">(org-babel-do-load-languages
 'org-babel-load-languages
 '((ledger . t)         ;this is the important one for this tutorial
  ))
</pre></div>

<p>Once Ledger support in Babel has been enabled, we can proceed to
include Ledger entries within an org file.  There are three ways (at
least) in which these can be included:
</p>
<ol>
<li> place all Ledger entries within one single source block and execute this
block with different arguments to generate the appropriate reports,

</li><li> place Ledger entries in more than one source block and use the
<code>noweb</code> literary programming approach, supported by Babel, to
combine these into one block elsewhere in the file for processing by
Ledger,

</li><li> place Ledger entries in different source blocks and use <code>tangle</code> to
generate a Ledger file which you can subsequently process using Ledger
directly.
</li></ol>

<p>The first two are described in more detail in this short tutorial.
</p>
<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top">&bull; <a href="#Embedded-Ledger-example-with-single-source-block" accesskey="1">Embedded Ledger example with single source block</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Multiple-Ledger-source-blocks-with-noweb" accesskey="2">Multiple Ledger source blocks with <code>noweb</code></a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Income-Entries" accesskey="3">Income Entries</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Expenses" accesskey="4">Expenses</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Financial-Summaries" accesskey="5">Financial Summaries</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#An-overall-balance-summary" accesskey="6">An overall balance summary</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Generating-a-monthly-register" accesskey="7">Generating a monthly register</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Summary" accesskey="8">Summary</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
</table>

<hr>
<a name="Embedded-Ledger-example-with-single-source-block"></a>
<div class="header">
<p>
Next: <a href="#Multiple-Ledger-source-blocks-with-noweb" accesskey="n" rel="next">Multiple Ledger source blocks with <code>noweb</code></a>, Previous: <a href="#Org-mode-with-Babel" accesskey="p" rel="prev">Org mode with Babel</a>, Up: <a href="#Org-mode-with-Babel" accesskey="u" rel="up">Org mode with Babel</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Embedded-Ledger-example-with-single-source-block-1"></a>
<h4 class="subsubsection">7.2.4.1 Embedded Ledger example with single source block</h4>

<p>The easiest, albeit possibly least useful, way in which to use Ledger
within an org file is to use a single source block to record all Ledger
entries.  The following is an example source block:
</p>
<div class="smallexample">
<pre class="smallexample">#+name: allinone
#+begin_src ledger
2010/01/01 * Starting balance
  assets:bank:savings       1300.00
  income:starting balances
2010/07/22 * Got paid
  assets:bank:chequing      1000.00
  income:salary
2010/07/23 Rent
  expenses:rent              500.00
  assets:bank:chequing
2010/07/24 Food
  expenses:food              150.00
  assets:bank:chequing
2010/07/31 * Interest on bank savings
  assets:bank:savings          3.53
  income:interest
2010/07/31 * Transfer savings
  assets:bank:savings        250.00
  assets:bank:chequing
2010/08/01 got paid again
  assets:bank:chequing      1000.00
  income:salary
#+end_src
</pre></div>

<p>In this example, we have combined both expenses and income into one set
of Ledger entries.  We can now generate register and balance reports (as
well as many other types of reports) using Babel to invoke Ledger with
specific arguments.  The arguments are passed to Ledger using the
<code>:cmdline</code> header argument.  In the code block above, there is no
such argument so the system takes the default.  For Ledger code blocks,
the default <code>:cmdline</code> argument is <code>bal</code> and the result of
evaluating this code block (<kbd>C-c C-c</kbd>) would be:
</p>
<div class="smallexample">
<pre class="smallexample">#+results: allinone()
:            2653.53  assets:bank
:            1100.00    chequing
:            1553.53    savings
:             650.00  expenses
:             150.00    food
:             500.00    rent
:           -3303.53  income
:              -3.53    interest
:           -2000.00    salary
:           -1300.00    starting balances
</pre></div>

<p>If, instead, you wished to generate a register of all the transactions,
you would change the <code>#+begin_src</code> line for the code block to
include the required command-line option:
</p>
<div class="smallexample">
<pre class="smallexample">#+begin_src ledger :cmdline reg
</pre></div>

<p>Evaluating the code block again would generate a different report.
</p>
<p>Having to change the actual directive on the code block and re-evaluate
makes it difficult to have more than one view of your transactions and
financial state.  Eventually, Babel will support passing arguments to
<code>#+call</code> evaluations of code blocks but this support is missing
currently.  Instead, we can use the concepts of literary programming, as
implemented by the <code>noweb</code> features of Babel, to help us.
</p>
<hr>
<a name="Multiple-Ledger-source-blocks-with-noweb"></a>
<div class="header">
<p>
Next: <a href="#Income-Entries" accesskey="n" rel="next">Income Entries</a>, Previous: <a href="#Embedded-Ledger-example-with-single-source-block" accesskey="p" rel="prev">Embedded Ledger example with single source block</a>, Up: <a href="#Org-mode-with-Babel" accesskey="u" rel="up">Org mode with Babel</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Multiple-Ledger-source-blocks-with-noweb-1"></a>
<h4 class="subsubsection">7.2.4.2 Multiple Ledger source blocks with <code>noweb</code></h4>

<p>The <code>noweb</code> feature of Babel allows us to expand references to
other code blocks within a code block.  For Ledger, this can be used to
group transactions according to type, say, and then bring various sets
of transactions together to generate reports.
</p>
<p>Using the same transactions used above, we could consider splitting
these into expenses and income, as follows:
</p>
<hr>
<a name="Income-Entries"></a>
<div class="header">
<p>
Next: <a href="#Expenses" accesskey="n" rel="next">Expenses</a>, Previous: <a href="#Multiple-Ledger-source-blocks-with-noweb" accesskey="p" rel="prev">Multiple Ledger source blocks with <code>noweb</code></a>, Up: <a href="#Org-mode-with-Babel" accesskey="u" rel="up">Org mode with Babel</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Income-Entries-1"></a>
<h4 class="subsubsection">7.2.4.3 Income Entries</h4>

<p>The first set of entries relates to income, either monthly pay or
interest, all typically going into one of my bank accounts.  Here, I have
placed several entries, but we could have had each entry in a separate
<code>src</code> block.  Note that all code blocks you wish to refer to later
must have the <code>:noweb yes</code> header argument specified.
</p>
<div class="smallexample">
<pre class="smallexample">#+name: income
#+begin_src ledger :noweb yes
2010/01/01 * Starting balance
  assets:bank:savings       1300.00
  income:starting balances
2010/07/22 * Got paid
  assets:bank:chequing      1000.00
  income:salary
2010/07/31 * Interest on bank savings
  assets:bank:savings          3.53
  income:interest
2010/07/31 * Transfer savings
  assets:bank:savings        250.00
  assets:bank:chequing
2010/08/01 got paid again
  assets:bank:chequing      1000.00
  income:salary
#+end_src
</pre></div>

<hr>
<a name="Expenses"></a>
<div class="header">
<p>
Next: <a href="#Financial-Summaries" accesskey="n" rel="next">Financial Summaries</a>, Previous: <a href="#Income-Entries" accesskey="p" rel="prev">Income Entries</a>, Up: <a href="#Org-mode-with-Babel" accesskey="u" rel="up">Org mode with Babel</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Expenses-1"></a>
<h4 class="subsubsection">7.2.4.4 Expenses</h4>

<p>The following entries relate to personal expenses, such as rent and
food.  Again, these have all been placed in a single <code>src</code> block but
could have been done individually.
</p>
<div class="smallexample">
<pre class="smallexample">#+name: expenses
#+begin_src ledger :noweb yes
2010/07/23 Rent
  expenses:rent              500.00
  assets:bank:chequing
2010/07/24 Food
  expenses:food              150.00
  assets:bank:chequing
#+end_src
</pre></div>

<hr>
<a name="Financial-Summaries"></a>
<div class="header">
<p>
Next: <a href="#An-overall-balance-summary" accesskey="n" rel="next">An overall balance summary</a>, Previous: <a href="#Expenses" accesskey="p" rel="prev">Expenses</a>, Up: <a href="#Org-mode-with-Babel" accesskey="u" rel="up">Org mode with Babel</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Financial-Summaries-1"></a>
<h4 class="subsubsection">7.2.4.5 Financial Summaries</h4>

<p>Given the ledger entries defined above in the income and expenses code
blocks, we can now refer to these using the noweb expansion directives,
<code>&lt;&lt;name&gt;&gt;</code>.  We can now define different code blocks to generate
specific reports for those transactions.  Below are two examples, one to
generate a balance report and one to generate a register report of all
transactions.
</p>
<hr>
<a name="An-overall-balance-summary"></a>
<div class="header">
<p>
Next: <a href="#Generating-a-monthly-register" accesskey="n" rel="next">Generating a monthly register</a>, Previous: <a href="#Financial-Summaries" accesskey="p" rel="prev">Financial Summaries</a>, Up: <a href="#Org-mode-with-Babel" accesskey="u" rel="up">Org mode with Babel</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="An-overall-balance-summary-1"></a>
<h4 class="subsubsection">7.2.4.6 An overall balance summary</h4>
<a name="index-_002d_002dsubtotal-1"></a>

<p>The overall balance of your account and expenditure with a breakdown
according to category is specified by passing the <code>:cmdline bal</code>
argument to Ledger.  This code block can now be evaluated (<kbd>C-c C-c</kbd>)
and the results generated by incorporating the transactions referred to
by the <code>&lt;&lt;income&gt;&gt;</code> and <code>&lt;&lt;expenses&gt;&gt;</code> lines.
</p>
<div class="smallexample">
<pre class="smallexample">#+name: balance
#+begin_src ledger :cmdline bal :noweb yes
&lt;&lt;income&gt;&gt;
&lt;&lt;expenses&gt;&gt;
#+end_src

#+results: balance
:            2653.53  assets:bank
:            1100.00    chequing
:            1553.53    savings
:             650.00  expenses
:             150.00    food
:             500.00    rent
:           -3303.53  income
:              -3.53    interest
:           -2000.00    salary
:           -1300.00    starting balances
</pre></div>

<p>If you want a less detailed breakdown of where your money is, you can
specify the <samp>--collapse (-n)</samp> flag (i.e. &lsquo;<samp>:cmdline -n bal</samp>&rsquo;)
to tell Ledger to exclude sub-accounts in the report.
</p>
<div class="smallexample">
<pre class="smallexample">#+begin_src ledger :cmdline -n bal :noweb yes
&lt;&lt;income&gt;&gt;
&lt;&lt;expenses&gt;&gt;
#+end_src

#+results:
:            2653.53  assets
:             650.00  expenses
:           -3303.53  income
</pre></div>

<hr>
<a name="Generating-a-monthly-register"></a>
<div class="header">
<p>
Next: <a href="#Summary" accesskey="n" rel="next">Summary</a>, Previous: <a href="#An-overall-balance-summary" accesskey="p" rel="prev">An overall balance summary</a>, Up: <a href="#Org-mode-with-Babel" accesskey="u" rel="up">Org mode with Babel</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Generating-a-monthly-register-1"></a>
<h4 class="subsubsection">7.2.4.7 Generating a monthly register</h4>
<a name="index-register-5"></a>
<a name="index-_002d_002dmonthly-1"></a>

<p>You can also generate a monthly register (the <code>reg</code> command) by
executing the following <code>src</code> block.  This presents a summary of
transactions for each monthly period (the <samp>--monthly (-M)</samp>
argument) with a running total in the final column (which should be 0 at
the end if all the entries are correct).
</p>
<div class="smallexample">
<pre class="smallexample">#+name: monthlyregister
#+begin_src ledger :cmdline -M reg :noweb yes
&lt;&lt;income&gt;&gt;
&lt;&lt;expenses&gt;&gt;
#+end_src

#+results: monthlyregister
:2010/01/01 - 2010/01/31         assets:bank:savings       1300.00    1300.00
:                                in:starting balances     -1300.00           0
:2010/07/01 - 2010/07/31         assets:bank:chequing       100.00     100.00
:                                assets:bank:savings        253.53     353.53
:                                expenses:food              150.00     503.53
:                                expenses:rent              500.00    1003.53
:                                income:interest             -3.53    1000.00
:                                income:salary            -1000.00           0
:2010/08/01 - 2010/08/01         assets:bank:chequing      1000.00    1000.00
:                                income:salary            -1000.00           0
</pre></div>

<p>We could also generate a monthly report on our assets showing how these
are increasing (or decreasing!).  In this case, the final column will be
the running total of the assets in our ledger.
</p>
<div class="smallexample">
<pre class="smallexample">#+name: monthlyassetsregister
#+begin_src ledger :cmdline -M reg assets :noweb yes
&lt;&lt;income&gt;&gt;
&lt;&lt;expenses&gt;&gt;
#+end_src

#+results: monthlyassetsregister
: 2010/01/01 - 2010/01/31         assets:bank:savings       1300.00    1300.00
: 2010/07/01 - 2010/07/31         assets:bank:chequing       100.00    1400.00
:                                 assets:bank:savings        253.53    1653.53
: 2010/08/01 - 2010/08/01         assets:bank:chequing      1000.00    2653.53
</pre></div>

<hr>
<a name="Summary"></a>
<div class="header">
<p>
Previous: <a href="#Generating-a-monthly-register" accesskey="p" rel="prev">Generating a monthly register</a>, Up: <a href="#Org-mode-with-Babel" accesskey="u" rel="up">Org mode with Babel</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Summary-1"></a>
<h4 class="subsubsection">7.2.4.8 Summary</h4>

<p>This short tutorial shows how Ledger entries can be embedded in an org
file and manipulated using Babel.  However, only simple Ledger features
have been illustrated; please refer to the Ledger documentation for
examples of more complex operations on a ledger.
</p>
<hr>
<a name="The-pricemap-command"></a>
<div class="header">
<p>
Next: <a href="#The-xml-command" accesskey="n" rel="next">The <code>xml</code> command</a>, Previous: <a href="#Org-mode-with-Babel" accesskey="p" rel="prev">Org mode with Babel</a>, Up: <a href="#Reports-in-other-Formats" accesskey="u" rel="up">Reports in other Formats</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="The-pricemap-command-1"></a>
<h4 class="subsection">7.2.5 The <code>pricemap</code> command</h4>
<a name="index-pricemap"></a>

<p>If you have the <samp>graphviz</samp> graph visualization package installed,
ledger can generate a graph of the relationship between your various
commodities.  The output file is in the &ldquo;dot&rdquo; format.
</p>
<p>This is probably not very interesting, unless you have many different
commodities valued in terms of each other.  For example, multiple
currencies and multiple investments valued in those currencies.
</p>
<hr>
<a name="The-xml-command"></a>
<div class="header">
<p>
Next: <a href="#prices-and-pricedb-commands" accesskey="n" rel="next"><code>prices</code> and <code>pricedb</code> commands</a>, Previous: <a href="#The-pricemap-command" accesskey="p" rel="prev">The <code>pricemap</code> command</a>, Up: <a href="#Reports-in-other-Formats" accesskey="u" rel="up">Reports in other Formats</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="The-xml-command-1"></a>
<h4 class="subsection">7.2.6 The <code>xml</code> command</h4>
<a name="index-xml"></a>

<p>By default, Ledger uses a human-readable data format, and displays its
reports in a manner meant to be read on screen.  For the purpose of
writing tools which use Ledger, however, it is possible to read and
display data using XML.  This section documents that format.
</p>
<p>The general format used for Ledger data is:
</p>
<div class="smallexample">
<pre class="smallexample">&lt;?xml version=&quot;1.0&quot;?&gt;
&lt;ledger&gt;
  &lt;xact&gt;...&lt;/xact&gt;
  &lt;xact&gt;...&lt;/xact&gt;
  &lt;xact&gt;...&lt;/xact&gt;...
&lt;/ledger&gt;
</pre></div>

<p>The data stream is enclosed in a <code>ledger</code> tag, which contains a
series of one or more transactions.  Each <code>xact</code> describes one
transaction and contains a series of one or more postings:
</p>
<div class="smallexample">
<pre class="smallexample">&lt;xact&gt;
  &lt;en:date&gt;2004/03/01&lt;/en:date&gt;
  &lt;en:cleared/&gt;
  &lt;en:code&gt;100&lt;/en:code&gt;
  &lt;en:payee&gt;John Wiegley&lt;/en:payee&gt;
  &lt;en:postings&gt;
    &lt;posting&gt;...&lt;/posting&gt;
    &lt;posting&gt;...&lt;/posting&gt;
    &lt;posting&gt;...&lt;/posting&gt;...
  &lt;/en:postings&gt;
&lt;/xact&gt;
</pre></div>

<p>The date format for <code>en:date</code> is always <code>YYYY/MM/DD</code>.  The
<code>en:cleared</code> tag is optional, and indicates whether the posting has
been cleared or not.  There is also an <code>en:pending</code> tag, for
marking pending postings.  The <code>en:code</code> and <code>en:payee</code> tags
both contain whatever text the user wishes.
</p>
<p>After the initial transaction data, there must follow a set of postings
marked with <code>en:postings</code>.  Typically these postings will all
balance each other, but if not they will be automatically balanced into
an account named &lsquo;<samp>Unknown</samp>&rsquo;.
</p>
<p>Within the <code>en:postings</code> tag is a series of one or more
<code>posting</code>&rsquo;s, which have the following form:
</p>
<div class="smallexample">
<pre class="smallexample">&lt;posting&gt;
  &lt;tr:account&gt;Expenses:Computer:Hardware&lt;/tr:account&gt;
  &lt;tr:amount&gt;
    &lt;value type=&quot;amount&quot;&gt;
      &lt;amount&gt;
        &lt;commodity flags=&quot;PT&quot;&gt;$&lt;/commodity&gt;
        &lt;quantity&gt;90.00&lt;/quantity&gt;
      &lt;/amount&gt;
    &lt;/value&gt;
  &lt;/tr:amount&gt;
&lt;/posting&gt;
</pre></div>

<p>This is a basic posting.  It may also begin with
<code>tr:virtual</code> and/or <code>tr:generated</code> tags, to indicate virtual
and auto-generated postings.  Then follows the <code>tr:account</code>
tag, which contains the full name of the account the posting is
related to.  Colons separate parent from child in an account name.
</p>
<p>Lastly follows the amount of the posting, indicated by
<code>tr:amount</code>.  Within this tag is a <code>value</code> tag, of which
there are four different kinds, each with its own format:
</p>
<ol>
<li> Boolean,
</li><li> integer,
</li><li> amount,
</li><li> balance.
</li></ol>

<p>The format of a Boolean value is <code>true</code> or <code>false</code>
surrounded by a <code>boolean</code> tag, for example:
</p>
<div class="smallexample">
<pre class="smallexample">&lt;boolean&gt;true&lt;/boolean&gt;
</pre></div>

<p>The format of an integer value is the numerical value surrounded by an
<code>integer</code> tag, for example:
</p>
<div class="smallexample">
<pre class="smallexample">&lt;integer&gt;12036&lt;/integer&gt;
</pre></div>

<p>The format of an amount contains two members, the commodity and the
quantity.  The commodity can have a set of flags that indicate how to
display it.  The meaning of the flags (all of which are optional) are:
</p>
<dl compact="compact">
<dt><code>P</code></dt>
<dd><p>The commodity is prefixed to the value.
</p>
</dd>
<dt><code>S</code></dt>
<dd><p>The commodity is separated from the value by a space.
</p>
</dd>
<dt><code>T</code></dt>
<dd><p>Thousands markers are used to display the amount.
</p>
</dd>
<dt><code>E</code></dt>
<dd><p>The format of the amount is European, with period used as a thousands
marker, and comma used as the decimal point.
</p>
</dd>
</dl>

<p>The actual quantity for an amount is an integer of arbitrary size.
Ledger uses the GNU multiple precision arithmetic library to handle
such values.  The XML format assumes the reader to be equally capable.
Here is an example amount:
</p>
<div class="smallexample">
<pre class="smallexample">&lt;value type=&quot;amount&quot;&gt;
  &lt;amount&gt;
    &lt;commodity flags=&quot;PT&quot;&gt;$&lt;/commodity&gt;
    &lt;quantity&gt;90.00&lt;/quantity&gt;
  &lt;/amount&gt;
&lt;/value&gt;
</pre></div>

<p>Lastly, a balance value contains a series of amounts, each with a
different commodity.  Unlike the name, such a value does need to
balance.  It is called a balance because it sums several amounts.  For
example:
</p>
<div class="smallexample">
<pre class="smallexample">&lt;value type=&quot;balance&quot;&gt;
  &lt;balance&gt;
    &lt;amount&gt;
      &lt;commodity flags=&quot;PT&quot;&gt;$&lt;/commodity&gt;
      &lt;quantity&gt;90.00&lt;/quantity&gt;
    &lt;/amount&gt;
    &lt;amount&gt;
      &lt;commodity flags=&quot;TE&quot;&gt;DM&lt;/commodity&gt;
      &lt;quantity&gt;200.00&lt;/quantity&gt;
    &lt;/amount&gt;
  &lt;/balance&gt;
&lt;/value&gt;
</pre></div>

<p>That is the extent of the XML data format used by Ledger.  It will
output such data if the <code>xml</code> command is used, and can read
the same data.
</p>
<hr>
<a name="prices-and-pricedb-commands"></a>
<div class="header">
<p>
Previous: <a href="#The-xml-command" accesskey="p" rel="prev">The <code>xml</code> command</a>, Up: <a href="#Reports-in-other-Formats" accesskey="u" rel="up">Reports in other Formats</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="prices-and-pricedb-commands-1"></a>
<h4 class="subsection">7.2.7 <code>prices</code> and <code>pricedb</code> commands</h4>
<a name="index-prices"></a>
<a name="index-pricedb"></a>
<a name="index-_002d_002daverage"></a>

<p>The <code>prices</code> command displays the price history for matching
commodities.  The <samp>--average (-A)</samp> option is useful with this
report, to display the running average price, or <samp>--deviation
(-D)</samp> to show each price&rsquo;s deviation from that average.
</p>
<p>There is also a <code>pricedb</code> command which outputs the same
information as <code>prices</code>, but does so in a format that can be
parsed by Ledger.  This is useful for generating and tidying up
pricedb database files.
</p>
<hr>
<a name="Reports-about-your-Journals"></a>
<div class="header">
<p>
Previous: <a href="#Reports-in-other-Formats" accesskey="p" rel="prev">Reports in other Formats</a>, Up: <a href="#Reporting-Commands" accesskey="u" rel="up">Reporting Commands</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Reports-about-your-Journals-1"></a>
<h3 class="section">7.3 Reports about your Journals</h3>
<a name="index-_002d_002dcount"></a>

<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top">&bull; <a href="#accounts" accesskey="1"><code>accounts</code></a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#payees" accesskey="2"><code>payees</code></a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#commodities" accesskey="3"><code>commodities</code></a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#tags" accesskey="4"><code>tags</code></a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#xact" accesskey="5"><code>xact</code></a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#stats" accesskey="6"><code>stats</code></a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#select" accesskey="7"><code>select</code></a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
</table>

<hr>
<a name="accounts"></a>
<div class="header">
<p>
Next: <a href="#payees" accesskey="n" rel="next"><code>payees</code></a>, Previous: <a href="#Reports-about-your-Journals" accesskey="p" rel="prev">Reports about your Journals</a>, Up: <a href="#Reports-about-your-Journals" accesskey="u" rel="up">Reports about your Journals</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="accounts-1"></a>
<h4 class="subsection">7.3.1 <code>accounts</code></h4>
<a name="index-accounts-1"></a>

<p>The <code>accounts</code> command reports all of the accounts in the
journal.  Following the command with a regular expression will limit the
output to accounts matching the regex.  The output is sorted by name.
Using the <samp>--count</samp> option will tell you how many entries use
each account.
</p>
<hr>
<a name="payees"></a>
<div class="header">
<p>
Next: <a href="#commodities" accesskey="n" rel="next"><code>commodities</code></a>, Previous: <a href="#accounts" accesskey="p" rel="prev"><code>accounts</code></a>, Up: <a href="#Reports-about-your-Journals" accesskey="u" rel="up">Reports about your Journals</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="payees-1"></a>
<h4 class="subsection">7.3.2 <code>payees</code></h4>
<a name="index-payees-1"></a>

<p>The <code>payees</code> command reports all of the unique payees in the
journal.  Using the <samp>--count</samp> option will tell you how many
entries use each payee.  To filter the payees displayed you must use the
prefix @:
</p>
<div class="smallexample">
<pre class="smallexample">$ ledger payees @Nic
</pre></div>
<div class="smallexample">
<pre class="smallexample">Nicolas
Nicolas BOILABUS
Oudtshoorn Municipality
Vaca Veronica
</pre></div>

<hr>
<a name="commodities"></a>
<div class="header">
<p>
Next: <a href="#tags" accesskey="n" rel="next"><code>tags</code></a>, Previous: <a href="#payees" accesskey="p" rel="prev"><code>payees</code></a>, Up: <a href="#Reports-about-your-Journals" accesskey="u" rel="up">Reports about your Journals</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="commodities-1"></a>
<h4 class="subsection">7.3.3 <code>commodities</code></h4>
<a name="index-commodities"></a>

<p>Report all commodities present in the journals under consideration.  The
output is sorted by name.  Using the <samp>--count</samp> option will tell
you how many entries use each commodity.
</p>
<hr>
<a name="tags"></a>
<div class="header">
<p>
Next: <a href="#xact" accesskey="n" rel="next"><code>xact</code></a>, Previous: <a href="#commodities" accesskey="p" rel="prev"><code>commodities</code></a>, Up: <a href="#Reports-about-your-Journals" accesskey="u" rel="up">Reports about your Journals</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="tags-1"></a>
<h4 class="subsection">7.3.4 <code>tags</code></h4>
<a name="index-tags-1"></a>
<a name="index-_002d_002dvalues"></a>

<p>The <code>tags</code> command reports all of the tags in the journal.  The
output is sorted by name.  Using the <samp>--count</samp> option will tell
you how many entries use each tag.  Using the <samp>--values</samp> option
will report the values used by each tag.
</p>
<hr>
<a name="xact"></a>
<div class="header">
<p>
Next: <a href="#stats" accesskey="n" rel="next"><code>stats</code></a>, Previous: <a href="#tags" accesskey="p" rel="prev"><code>tags</code></a>, Up: <a href="#Reports-about-your-Journals" accesskey="u" rel="up">Reports about your Journals</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="xact-1"></a>
<h4 class="subsection">7.3.5 <code>xact</code></h4>
<a name="index-draft"></a>
<a name="index-entry"></a>
<a name="index-xact-1"></a>

<p>The <code>xact</code> command simplifies the creation of new transactions.
It works on the principle that 80% of all postings are variants of
earlier postings.  Here&rsquo;s how it works:
</p>
<p>Say you currently have this posting in your ledger file:
</p>
<div class="smallexample">
<pre class="smallexample">2004/03/15 * Viva Italiano
    Expenses:Food                       $12.45
    Expenses:Tips                        $2.55
    Liabilities:MasterCard             $-15.00
</pre></div>

<p>Now it&rsquo;s &lsquo;<samp>2004/4/9</samp>&rsquo;, and you&rsquo;ve just eaten at &lsquo;<samp>Viva Italiano</samp>&rsquo;
again.  The exact amounts are different, but the overall form is the
same.  With the <code>xact</code> command you can type:
</p>
<div class="smallexample">
<pre class="smallexample">$ ledger xact 2004/4/9 viva food 11 tips 2.50
</pre></div>

<p>This produces the following output:
</p>
<div class="smallexample">
<pre class="smallexample">2004/04/09 Viva Italiano
    Expenses:Food                             $11.00
    Expenses:Tips                              $2.50
    Liabilities:MasterCard
</pre></div>

<p>It works by finding a past posting matching the regular expression
&lsquo;<samp>viva</samp>&rsquo;, and assuming that any accounts or amounts specified will be
similar to that earlier posting.  If Ledger does not succeed in
generating a new transaction, an error is printed and the exit code is
set to &lsquo;<samp>1</samp>&rsquo;.
</p>
<p>Here are a few more examples of the <code>xact</code> command, assuming
the above journal transaction:
</p>
<div class="smallexample">
<pre class="smallexample">$ ledger xact 4/9 viva 11.50
$ ledger xact 4/9 viva 11.50 checking # (from `checking')
$ ledger xact 4/9 viva food 11.50 tips 8
$ ledger xact 4/9 viva food 11.50 tips 8 cash
$ ledger xact 4/9 viva food $11.50 tips $8 cash
$ ledger xact 4/9 viva dining &quot;DM 11.50&quot;
</pre></div>

<p><code>draft</code> and <code>entry</code> are both synonyms of
<code>xact</code>.  <code>entry</code> is provided for backwards compatibility
with Ledger 2.X.
</p>
<hr>
<a name="stats"></a>
<div class="header">
<p>
Next: <a href="#select" accesskey="n" rel="next"><code>select</code></a>, Previous: <a href="#xact" accesskey="p" rel="prev"><code>xact</code></a>, Up: <a href="#Reports-about-your-Journals" accesskey="u" rel="up">Reports about your Journals</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="stats-1"></a>
<h4 class="subsection">7.3.6 <code>stats</code></h4>
<a name="index-stats"></a>
<a name="index-stat"></a>

<p><small>UNDOCUMENTED</small>! Please help by contributing documentation for this feature.
</p>
<hr>
<a name="select"></a>
<div class="header">
<p>
Previous: <a href="#stats" accesskey="p" rel="prev"><code>stats</code></a>, Up: <a href="#Reports-about-your-Journals" accesskey="u" rel="up">Reports about your Journals</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="select-1"></a>
<h4 class="subsection">7.3.7 <code>select</code></h4>
<a name="index-select"></a>

<p><small>UNDOCUMENTED</small>! Please help by contributing documentation for this feature.
</p>
<hr>
<a name="Command_002dLine-Syntax"></a>
<div class="header">
<p>
Next: <a href="#Budgeting-and-Forecasting" accesskey="n" rel="next">Budgeting and Forecasting</a>, Previous: <a href="#Reporting-Commands" accesskey="p" rel="prev">Reporting Commands</a>, Up: <a href="#Top" accesskey="u" rel="up">Top</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Command_002dLine-Syntax-1"></a>
<h2 class="chapter">8 Command-Line Syntax</h2>

<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top">&bull; <a href="#Basic-Usage" accesskey="1">Basic Usage</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Command_002dLine-Quick-Reference" accesskey="2">Command-Line Quick Reference</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Detailed-Option-Description" accesskey="3">Detailed Option Description</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Period-Expressions" accesskey="4">Period Expressions</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
</table>

<hr>
<a name="Basic-Usage"></a>
<div class="header">
<p>
Next: <a href="#Command_002dLine-Quick-Reference" accesskey="n" rel="next">Command-Line Quick Reference</a>, Previous: <a href="#Command_002dLine-Syntax" accesskey="p" rel="prev">Command-Line Syntax</a>, Up: <a href="#Command_002dLine-Syntax" accesskey="u" rel="up">Command-Line Syntax</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Basic-Usage-1"></a>
<h3 class="section">8.1 Basic Usage</h3>

<p>This chapter describes Ledger&rsquo;s features and options.  You may wish to
survey this to get an overview before diving into the <a href="#Ledger-Tutorial">Ledger Tutorial</a> and more detailed examples that follow.
</p>
<p>Ledger has a very simple command-line interface, named&mdash;enticingly
enough&mdash;<samp>ledger</samp>.  It supports a few reporting commands, and
a large number of options for refining the output from those commands.
The basic syntax of any ledger command is:
</p>
<div class="smallexample">
<pre class="smallexample">$ ledger [OPTIONS...] COMMAND [ARGS...]
</pre></div>

<p>After the command word there may appear any number of arguments.  For
most commands, these arguments are regular expressions that cause the
output to relate only to postings matching those regular expressions.
For the <code>xact</code> command, the arguments have a special meaning,
described below.
</p>
<p>The regular expressions arguments always match the account name that
a posting refers to.  To match on the payee of the transaction
instead, precede the regular expression with &lsquo;<samp>payee</samp>&rsquo; or
&lsquo;<samp>@</samp>&rsquo;.  For example, the following balance command reports account
totals for rent, food and movies, but only those whose payee matches
Freddie:
</p>
<div class="smallexample">
<pre class="smallexample">$ ledger bal rent food movies payee freddie
</pre></div>

<p>or
</p>
<div class="smallexample">
<pre class="smallexample">$ ledger bal rent food movies @freddie
</pre></div>

<p>There are many, many command options available with the <samp>ledger</samp>
program, and it takes a while to master them.  However, none of them are
required to use the basic reporting commands.
</p>
<hr>
<a name="Command_002dLine-Quick-Reference"></a>
<div class="header">
<p>
Next: <a href="#Detailed-Option-Description" accesskey="n" rel="next">Detailed Option Description</a>, Previous: <a href="#Basic-Usage" accesskey="p" rel="prev">Basic Usage</a>, Up: <a href="#Command_002dLine-Syntax" accesskey="u" rel="up">Command-Line Syntax</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Command_002dLine-Quick-Reference-1"></a>
<h3 class="section">8.2 Command-Line Quick Reference</h3>

<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top">&bull; <a href="#Basic-Reporting-Commands" accesskey="1">Basic Reporting Commands</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Basic-Options" accesskey="2">Basic Options</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Report-Filtering" accesskey="3">Report Filtering</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Error-Checking-and-Calculation-Options" accesskey="4">Error Checking and Calculation Options</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Output-Customization" accesskey="5">Output Customization</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Grouping-Options" accesskey="6">Grouping Options</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Commodity-Reporting" accesskey="7">Commodity Reporting</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
</table>

<hr>
<a name="Basic-Reporting-Commands"></a>
<div class="header">
<p>
Next: <a href="#Basic-Options" accesskey="n" rel="next">Basic Options</a>, Previous: <a href="#Command_002dLine-Quick-Reference" accesskey="p" rel="prev">Command-Line Quick Reference</a>, Up: <a href="#Command_002dLine-Quick-Reference" accesskey="u" rel="up">Command-Line Quick Reference</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Basic-Reporting-Commands-1"></a>
<h4 class="subsection">8.2.1 Basic Reporting Commands</h4>

<dl compact="compact">
<dt><code>balance</code>
<a name="index-balance-2"></a>
</dt>
<dt><code>bal</code>
<a name="index-bal"></a>
</dt>
<dd><p>Show account balances.
</p>
</dd>
<dt><code>register</code>
<a name="index-register-6"></a>
</dt>
<dt><code>reg</code>
<a name="index-reg"></a>
</dt>
<dd><p>Show all transactions with running total.
</p>
</dd>
<dt><code>csv</code>
<a name="index-csv-1"></a>
</dt>
<dd><a name="index-csv-exporting"></a>
<p>Show transactions in csv format, for exporting to other programs.
</p>
</dd>
<dt><code>print</code>
<a name="index-print-4"></a>
</dt>
<dd><p>Print transactions in a format readable by ledger.
</p>
</dd>
<dt><code>xml</code>
<a name="index-xml-1"></a>
</dt>
<dd><p>Produce XML output of the register command.
</p>
</dd>
<dt><code>lisp</code>
<a name="index-lisp-1"></a>
</dt>
<dt><code>emacs</code>
<a name="index-emacs-1"></a>
</dt>
<dd><p>Produce s-expression output, suitable for Emacs.
</p>
</dd>
<dt><code>equity</code>
<a name="index-equity-2"></a>
</dt>
<dd><p>Print account balances as transactions.
</p>
</dd>
<dt><code>prices</code>
<a name="index-prices-1"></a>
</dt>
<dd><p>Print price history for matching commodities.
</p>
</dd>
<dt><code>pricedb</code>
<a name="index-pricedb-1"></a>
</dt>
<dd><p>Print price history for matching commodities in a format readable by
ledger.
</p>
</dd>
<dt><code>xact</code>
<a name="index-xact-2"></a>
</dt>
<dd><p>Generate transactions based on previous postings.
</p>
</dd>
</dl>

<hr>
<a name="Basic-Options"></a>
<div class="header">
<p>
Next: <a href="#Report-Filtering" accesskey="n" rel="next">Report Filtering</a>, Previous: <a href="#Basic-Reporting-Commands" accesskey="p" rel="prev">Basic Reporting Commands</a>, Up: <a href="#Command_002dLine-Quick-Reference" accesskey="u" rel="up">Command-Line Quick Reference</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Basic-Options-1"></a>
<h4 class="subsection">8.2.2 Basic Options</h4>

<dl compact="compact">
<dt><samp>--help</samp>
<a name="index-_002d_002dhelp"></a>
</dt>
<dt><samp>-h</samp>
<a name="index-_002dh"></a>
</dt>
<dd><p>Display the man page for <samp>ledger</samp>.
</p>
</dd>
<dt><samp>--version</samp>
<a name="index-_002d_002dversion"></a>
</dt>
<dd><p>Print version information and exit.
</p>
</dd>
<dt><samp>--file <var>FILE</var></samp>
<a name="index-_002d_002dfile-FILE"></a>
</dt>
<dt><samp>-f <var>FILE</var></samp>
<a name="index-_002df-FILE"></a>
</dt>
<dd><p>Read <samp>FILE</samp> as a ledger file.
</p>
</dd>
<dt><samp>--output <var>FILE</var></samp>
<a name="index-_002d_002doutput-FILE"></a>
</dt>
<dt><samp>-o <var>FILE</var></samp>
<a name="index-_002do-FILE"></a>
</dt>
<dd><p>Redirect output to <samp>FILE</samp>.
</p>
</dd>
<dt><samp>--init-file <var>FILE</var></samp>
<a name="index-_002d_002dinit_002dfile-FILE"></a>
</dt>
<dt><samp>-i <var>FILE</var></samp>
<a name="index-_002di-FILE"></a>
</dt>
<dd><p>Specify an options file.
</p>
</dd>
<dt><samp>--import <var>FILE</var></samp>
<a name="index-_002d_002dimport-FILE"></a>
</dt>
<dd><p>Import <var>FILE</var> as Python module.
</p>
</dd>
<dt><samp>--account <var>STR</var></samp>
<a name="index-_002d_002daccount-STR-1"></a>
</dt>
<dt><samp>-a <var>STR</var></samp>
<a name="index-_002da-STR"></a>
</dt>
<dd><p>Specify default account <var>STR</var> for QIF file postings.
</p>
</dd>
</dl>

<hr>
<a name="Report-Filtering"></a>
<div class="header">
<p>
Next: <a href="#Error-Checking-and-Calculation-Options" accesskey="n" rel="next">Error Checking and Calculation Options</a>, Previous: <a href="#Basic-Options" accesskey="p" rel="prev">Basic Options</a>, Up: <a href="#Command_002dLine-Quick-Reference" accesskey="u" rel="up">Command-Line Quick Reference</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Report-Filtering-1"></a>
<h4 class="subsection">8.2.3 Report Filtering</h4>

<dl compact="compact">
<dt><samp>--current</samp>
<a name="index-_002d_002dcurrent"></a>
</dt>
<dt><samp>-c</samp>
<a name="index-_002dc"></a>
</dt>
<dd><p>Display only transactions on or before the current date.
</p>
</dd>
<dt><samp>--begin <var>DATE</var></samp>
<a name="index-_002d_002dbegin-DATE"></a>
</dt>
<dt><samp>-b <var>DATE</var></samp>
<a name="index-_002db-DATE"></a>
</dt>
<dd><p>Limit the processing to transactions on or after <var>DATE</var>.
</p>
</dd>
<dt><samp>--end <var>DATE</var></samp>
<a name="index-_002d_002dend-DATE"></a>
</dt>
<dt><samp>-e <var>DATE</var></samp>
<a name="index-_002de-DATE"></a>
</dt>
<dd><p>Limit the processing to transactions before <var>DATE</var>.
</p>
</dd>
<dt><samp>--period <var>PERIOD_EXPRESSION</var></samp>
<a name="index-_002d_002dperiod-PERIOD_005fEXPRESSION"></a>
</dt>
<dt><samp>-p <var>PERIOD_EXPRESSION</var></samp>
<a name="index-_002dp-PERIOD_005fEXPRESSION"></a>
</dt>
<dd><p>Limit the processing to transactions in <var>PERIOD_EXPRESSION</var>.
</p>
</dd>
<dt><samp>--period-sort <var>VEXPR</var></samp>
<a name="index-_002d_002dperiod_002dsort-VEXPR-1"></a>
</dt>
<dd><p>Sort postings within each period according to <var>VEXPR</var>.
</p>
</dd>
<dt><samp>--cleared</samp>
<a name="index-_002d_002dcleared-1"></a>
</dt>
<dt><samp>-C</samp>
<a name="index-_002dC"></a>
</dt>
<dd><p>Display only cleared postings.
</p>
</dd>
<dt><samp>--dc</samp>
<a name="index-_002d_002ddc"></a>
</dt>
<dd><p>Display register or balance in debit/credit format.
</p>
</dd>
<dt><samp>--uncleared</samp>
<a name="index-_002d_002duncleared-1"></a>
</dt>
<dt><samp>-U</samp>
<a name="index-_002dU"></a>
</dt>
<dd><p>Display only uncleared postings.
</p>
</dd>
<dt><samp>--real</samp>
<a name="index-_002d_002dreal-2"></a>
</dt>
<dt><samp>-R</samp>
<a name="index-_002dR"></a>
</dt>
<dd><p>Display only real postings.
</p>
</dd>
<dt><samp>--actual</samp>
<a name="index-_002d_002dactual"></a>
</dt>
<dt><samp>-L</samp>
<a name="index-_002dL"></a>
</dt>
<dd><p>Display only actual postings, not automated ones.
</p>
</dd>
<dt><samp>--related</samp>
<a name="index-_002d_002drelated-1"></a>
</dt>
<dt><samp>-r</samp>
<a name="index-_002dr"></a>
</dt>
<dd><p>Display related postings.
</p>
</dd>
<dt><samp>--budget</samp>
<a name="index-_002d_002dbudget-1"></a>
</dt>
<dd><p>Display how close your postings meet your budget.
</p>
</dd>
<dt><samp>--add-budget</samp>
<a name="index-_002d_002dadd_002dbudget"></a>
</dt>
<dd><p>Show unbudgeted postings.
</p>
</dd>
<dt><samp>--unbudgeted</samp>
<a name="index-_002d_002dunbudgeted"></a>
</dt>
<dd><p>Show only unbudgeted postings.
</p>
</dd>
<dt><samp>--forecast-while <var>VEXPR</var></samp>
<a name="index-_002d_002dforecast_002dwhile-VEXPR"></a>
</dt>
<dt><samp>--forecast <var>VEXPR</var></samp>
<a name="index-_002d_002dforecast-VEXPR"></a>
</dt>
<dd><p>Project balances into the future.
</p>
</dd>
<dt><samp>--limit <var>EXPR</var></samp>
<a name="index-_002d_002dlimit-EXPR-2"></a>
</dt>
<dt><samp>-l <var>EXPR</var></samp>
<a name="index-_002dl-EXPR"></a>
</dt>
<dd><p>Limit which postings are used in calculations by <var>EXPR</var>.
</p>
</dd>
<dt><samp>--amount <var>EXPR</var></samp>
<a name="index-_002d_002damount-EXPR"></a>
</dt>
<dt><samp>-t <var>EXPR</var></samp>
<a name="index-_002dt-EXPR"></a>
</dt>
<dd><p>Change value expression reported in <code>register</code> report.
</p>
</dd>
<dt><samp>--total <var>VEXPR</var></samp>
<a name="index-_002d_002dtotal-VEXPR"></a>
</dt>
<dt><samp>-T <var>VEXPR</var></samp>
<a name="index-_002dT-VEXPR"></a>
</dt>
<dd><p>Change the value expression used for &ldquo;totals&rdquo; column in
<code>register</code> and <code>balance</code> reports.
</p>
</dd>
</dl>

<hr>
<a name="Error-Checking-and-Calculation-Options"></a>
<div class="header">
<p>
Next: <a href="#Output-Customization" accesskey="n" rel="next">Output Customization</a>, Previous: <a href="#Report-Filtering" accesskey="p" rel="prev">Report Filtering</a>, Up: <a href="#Command_002dLine-Quick-Reference" accesskey="u" rel="up">Command-Line Quick Reference</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Error-Checking-and-Calculation-Options-1"></a>
<h4 class="subsection">8.2.4 Error Checking and Calculation Options</h4>

<dl compact="compact">
<dt><samp>--strict</samp>
<a name="index-_002d_002dstrict-2"></a>
</dt>
<dd><p>Accounts, tags or commodities not previously declared will cause
warnings.
</p>
</dd>
<dt><samp>--pedantic</samp>
<a name="index-_002d_002dpedantic-1"></a>
</dt>
<dd><p>Accounts, tags or commodities not previously declared will cause errors.
</p>
</dd>
<dt><samp>--check-payees</samp>
<a name="index-_002d_002dcheck_002dpayees"></a>
</dt>
<dd><p>Enable strict and pedantic checking for payees as well as accounts,
commodities and tags.  This only works in conjunction with
<samp>--strict</samp> or <samp>--pedantic</samp>.
</p>
</dd>
<dt><samp>--immediate</samp>
<a name="index-_002d_002dimmediate"></a>
</dt>
<dd><p>Instruct ledger to evaluate calculations immediately rather than lazily.
</p>
</dd>
</dl>

<hr>
<a name="Output-Customization"></a>
<div class="header">
<p>
Next: <a href="#Grouping-Options" accesskey="n" rel="next">Grouping Options</a>, Previous: <a href="#Error-Checking-and-Calculation-Options" accesskey="p" rel="prev">Error Checking and Calculation Options</a>, Up: <a href="#Command_002dLine-Quick-Reference" accesskey="u" rel="up">Command-Line Quick Reference</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Output-Customization-1"></a>
<h4 class="subsection">8.2.5 Output Customization</h4>

<dl compact="compact">
<dt><samp>--collapse</samp>
<a name="index-_002d_002dcollapse"></a>
</dt>
<dt><samp>-n</samp>
<a name="index-_002dn"></a>
</dt>
<dd><p>Collapse transactions with multiple postings.
</p>
</dd>
<dt><samp>--subtotal</samp>
<a name="index-_002d_002dsubtotal-2"></a>
</dt>
<dt><samp>-s</samp>
<a name="index-_002ds"></a>
</dt>
<dd><p>Report register as a single subtotal.
</p>
</dd>
<dt><samp>--by-payee</samp>
<a name="index-_002d_002dby_002dpayee-2"></a>
</dt>
<dt><samp>-P</samp>
<a name="index-_002dP"></a>
</dt>
<dd><p>Report subtotals by payee.
</p>
</dd>
<dt><samp>--empty</samp>
<a name="index-_002d_002dempty-1"></a>
</dt>
<dt><samp>-E</samp>
<a name="index-_002dE"></a>
</dt>
<dd><p>Include empty accounts in the report.
</p>
</dd>
<dt><samp>--weekly</samp>
<a name="index-_002d_002dweekly"></a>
</dt>
<dt><samp>-W</samp>
<a name="index-_002dW"></a>
</dt>
<dd><p>Report posting totals by week.
</p>
</dd>
<dt><samp>--quarterly</samp>
<a name="index-_002d_002dquarterly"></a>
</dt>
<dd><p>Report posting totals by quarter.
</p>
</dd>
<dt><samp>--yearly</samp>
<a name="index-_002d_002dyearly"></a>
</dt>
<dt><samp>-Y</samp>
<a name="index-_002dY"></a>
</dt>
<dd><p>Report posting totals by year.
</p>
</dd>
<dt><samp>--dow</samp>
<a name="index-_002d_002ddow"></a>
</dt>
<dd><p>Report posting totals by day of week.
</p>
</dd>
<dt><samp>--sort <var>VEXPR</var></samp>
<a name="index-_002d_002dsort-VEXPR"></a>
</dt>
<dt><samp>-S <var>VEXPR</var></samp>
<a name="index-_002dS-VEXPR"></a>
</dt>
<dd><p>Sort a report using <var>VEXPR</var>.
</p>
</dd>
<dt><samp>--wide</samp>
<a name="index-_002d_002dwide"></a>
</dt>
<dt><samp>-w</samp>
<a name="index-_002dw"></a>
</dt>
<dd><p>Assume 132 columns instead of 80.
</p>
</dd>
<dt><samp>--head <var>INT</var></samp>
<a name="index-_002d_002dhead-INT"></a>
</dt>
<dd><p>Report the first <var>INT</var> postings.
</p>
</dd>
<dt><samp>--tail <var>INT</var></samp>
<a name="index-_002d_002dtail-INT"></a>
</dt>
<dd><p>Report the last <var>INT</var> postings.
</p>
</dd>
<dt><samp>--pager <var>FILE</var></samp>
<a name="index-_002d_002dpager-FILE"></a>
</dt>
<dd><p>Direct output to <var>FILE</var> pager program.
</p>
</dd>
<dt><samp>--no-pager</samp>
<a name="index-_002d_002dno_002dpager"></a>
</dt>
<dd><p>Direct output to stdout, avoiding pager program.
</p>
</dd>
<dt><samp>--average</samp>
<a name="index-_002d_002daverage-1"></a>
</dt>
<dt><samp>-A</samp>
<a name="index-_002dA"></a>
</dt>
<dd><p>Report the average posting value.
</p>
</dd>
<dt><samp>--deviation</samp>
<a name="index-_002d_002ddeviation"></a>
</dt>
<dt><samp>-D</samp>
<a name="index-_002dD"></a>
</dt>
<dd><p>Report each posting&rsquo;s deviation from the average.
</p>
</dd>
<dt><samp>--percent</samp>
<a name="index-_002d_002dpercent"></a>
</dt>
<dt><samp>-%</samp>
<a name="index-_002d_0025"></a>
</dt>
<dd><p>Show subtotals in the balance report as percentages.
</p>
</dd>
<dt><samp>--pivot <var>TAG</var></samp>
<a name="index-_002d_002dpivot-TAG"></a>
</dt>
<dd><p>Produce a pivot table of the <var>TAG</var> type specified.
</p>
</dd>
<dt><samp>--amount-data</samp>
<a name="index-_002d_002damount_002ddata-2"></a>
</dt>
<dt><samp>-j</samp>
<a name="index-_002dj"></a>
</dt>
<dd><p>Show only the date and value columns to format the output for plots.
</p>
</dd>
<dt><samp>--plot-amount-format <var>FORMAT_STRING</var></samp>
<a name="index-_002d_002dplot_002damount_002dformat-FORMAT_005fSTRING"></a>
</dt>
<dd><p>Specify the format for the plot output.
</p>
</dd>
<dt><samp>--total-data</samp>
<a name="index-_002d_002dtotal_002ddata-2"></a>
</dt>
<dt><samp>-J</samp>
<a name="index-_002dJ"></a>
</dt>
<dd><p>Show only the date and total columns to format the output for plots.
</p>
</dd>
<dt><samp>--plot-total-format <var>FORMAT_STRING</var></samp>
<a name="index-_002d_002dplot_002dtotal_002dformat-FORMAT_005fSTRING"></a>
</dt>
<dd><p>Specify the format for the plot output.
</p>
</dd>
<dt><samp>--display <var>EXPR</var></samp>
<a name="index-_002d_002ddisplay-EXPR-2"></a>
</dt>
<dt><samp>-d <var>EXPR</var></samp>
<a name="index-_002dd-EXPR"></a>
</dt>
<dd><p>Display only postings that meet the criteria in the <var>EXPR</var>.
</p>
</dd>
<dt><samp>--date-format <var>DATE_FORMAT</var></samp>
<a name="index-_002d_002ddate_002dformat-DATE_005fFORMAT"></a>
</dt>
<dt><samp>-y <var>DATE_FORMAT</var></samp>
<a name="index-_002dy-DATE_005fFORMAT"></a>
</dt>
<dd><p>Change the basic date format used in reports.
</p>
</dd>
<dt><samp>--format <var>FORMAT_STRING</var></samp>
<a name="index-_002d_002dformat-FORMAT_005fSTRING"></a>
</dt>
<dt><samp>--balance-format <var>FORMAT_STRING</var></samp>
<a name="index-_002d_002dbalance_002dformat-FORMAT_005fSTRING"></a>
</dt>
<dt><samp>--register-format <var>FORMAT_STRING</var></samp>
<a name="index-_002d_002dregister_002dformat-FORMAT_005fSTRING"></a>
</dt>
<dt><samp>--prices-format <var>FORMAT_STRING</var></samp>
<a name="index-_002d_002dprices_002dformat-FORMAT_005fSTRING"></a>
</dt>
<dt><samp>-F <var>FORMAT_STRING</var></samp>
<a name="index-_002dF-FORMAT_005fSTRING"></a>
</dt>
<dd><p>Set the reporting format for various reports.
</p>
</dd>
<dt><samp>--anon</samp>
<a name="index-_002d_002danon"></a>
</dt>
<dd><p>Print the ledger register with anonymized accounts and payees, useful
for filing bug reports.
</p>
</dd>
</dl>

<hr>
<a name="Grouping-Options"></a>
<div class="header">
<p>
Next: <a href="#Commodity-Reporting" accesskey="n" rel="next">Commodity Reporting</a>, Previous: <a href="#Output-Customization" accesskey="p" rel="prev">Output Customization</a>, Up: <a href="#Command_002dLine-Quick-Reference" accesskey="u" rel="up">Command-Line Quick Reference</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Grouping-Options-1"></a>
<h4 class="subsection">8.2.6 Grouping Options</h4>

<dl compact="compact">
<dt><samp>--by-payee</samp>
<a name="index-_002d_002dby_002dpayee-3"></a>
</dt>
<dt><samp>-P</samp>
<a name="index-_002dP-1"></a>
</dt>
<dd><p>Group postings by common payee names.
</p>
</dd>
<dt><samp>--daily</samp>
<a name="index-_002d_002ddaily"></a>
</dt>
<dt><samp>-D</samp>
<a name="index-_002dD-1"></a>
</dt>
<dd><p>Group postings by day.
</p>
</dd>
<dt><samp>--weekly</samp>
<a name="index-_002d_002dweekly-1"></a>
</dt>
<dt><samp>-W</samp>
<a name="index-_002dW-1"></a>
</dt>
<dd><p>Group postings by week.
</p>
</dd>
<dt><samp>--monthly</samp>
<a name="index-_002d_002dmonthly-2"></a>
</dt>
<dt><samp>-M</samp>
<a name="index-_002dM"></a>
</dt>
<dd><p>Group postings by month.
</p>
</dd>
<dt><samp>--quarterly</samp>
<a name="index-_002d_002dquarterly-1"></a>
</dt>
<dd><p>Group postings by quarter.
</p>
</dd>
<dt><samp>--yearly</samp>
<a name="index-_002d_002dyearly-1"></a>
</dt>
<dt><samp>-Y</samp>
<a name="index-_002dY-1"></a>
</dt>
<dd><p>Group postings by year.
</p>
</dd>
<dt><samp>--dow</samp>
<a name="index-_002d_002ddow-1"></a>
</dt>
<dd><p>Group by day of weeks.
</p>
</dd>
<dt><samp>--subtotal</samp>
<a name="index-_002d_002dsubtotal-3"></a>
</dt>
<dt><samp>-s</samp>
<a name="index-_002ds-1"></a>
</dt>
<dd><p>Group postings together, similar to the balance report.
</p>
</dd>
</dl>

<hr>
<a name="Commodity-Reporting"></a>
<div class="header">
<p>
Previous: <a href="#Grouping-Options" accesskey="p" rel="prev">Grouping Options</a>, Up: <a href="#Command_002dLine-Quick-Reference" accesskey="u" rel="up">Command-Line Quick Reference</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Commodity-Reporting-1"></a>
<h4 class="subsection">8.2.7 Commodity Reporting</h4>

<dl compact="compact">
<dt><samp>--price-db <var>FILE</var></samp>
<a name="index-_002d_002dprice_002ddb-FILE-1"></a>
</dt>
<dd><p>Use <samp>FILE</samp> for retrieving stored commodity prices.
</p>
</dd>
<dt><samp>--price-exp <var>INT</var></samp>
<a name="index-_002d_002dprice_002dexp-INT"></a>
</dt>
<dt><samp>--leeway <var>INT</var></samp>
<a name="index-_002d_002dleeway-INT"></a>
</dt>
<dt><samp>-Z <var>INT</var></samp>
<a name="index-_002dZ-INT"></a>
</dt>
<dd><p>Set expected freshness of prices in <var>INT</var> minutes.
</p>
</dd>
<dt><samp>--download</samp>
<a name="index-_002d_002ddownload-1"></a>
</dt>
<dt><samp>-Q</samp>
<a name="index-_002dQ"></a>
</dt>
<dd><p>Download quotes using the script named <samp>getquote</samp>.
</p>

</dd>
<dt><samp>--quantity</samp>
<a name="index-_002d_002dquantity"></a>
</dt>
<dt><samp>-O</samp>
<a name="index-_002dO"></a>
</dt>
<dd><p>Report commodity totals without conversion.
</p>
</dd>
<dt><samp>--basis</samp>
<a name="index-_002d_002dbasis"></a>
</dt>
<dt><samp>-B</samp>
<a name="index-_002dB"></a>
</dt>
<dd><p>Report cost basis.
</p>
</dd>
<dt><samp>--market</samp>
<a name="index-_002d_002dmarket-3"></a>
</dt>
<dt><samp>-V</samp>
<a name="index-_002dV"></a>
</dt>
<dd><p>Report last known market value.
</p>
</dd>
<dt><samp>--gain</samp>
<a name="index-_002d_002dgain"></a>
</dt>
<dt><samp>-G</samp>
<a name="index-_002dG"></a>
</dt>
<dd><p>Report net gain or loss for commodities that have a price history.
</p>
</dd>
</dl>

<hr>
<a name="Detailed-Option-Description"></a>
<div class="header">
<p>
Next: <a href="#Period-Expressions" accesskey="n" rel="next">Period Expressions</a>, Previous: <a href="#Command_002dLine-Quick-Reference" accesskey="p" rel="prev">Command-Line Quick Reference</a>, Up: <a href="#Command_002dLine-Syntax" accesskey="u" rel="up">Command-Line Syntax</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Detailed-Option-Description-1"></a>
<h3 class="section">8.3 Detailed Option Description</h3>

<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top">&bull; <a href="#Global-Options" accesskey="1">Global Options</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Session-Options" accesskey="2">Session Options</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Report-Options" accesskey="3">Report Options</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Basic-options" accesskey="4">Basic options</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Report-filtering" accesskey="5">Report filtering</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Output-customization" accesskey="6">Output customization</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Commodity-reporting" accesskey="7">Commodity reporting</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Environment-variables" accesskey="8">Environment variables</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
</table>

<hr>
<a name="Global-Options"></a>
<div class="header">
<p>
Next: <a href="#Session-Options" accesskey="n" rel="next">Session Options</a>, Previous: <a href="#Detailed-Option-Description" accesskey="p" rel="prev">Detailed Option Description</a>, Up: <a href="#Detailed-Option-Description" accesskey="u" rel="up">Detailed Option Description</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Global-Options-1"></a>
<h4 class="subsection">8.3.1 Global Options</h4>

<p>Options for Ledger reports affect three separate scopes of operation:
Global, Session, and Report.  In practice there is very little
difference between these scopes.  Ledger 3.0 contains provisions for
GUIs, which would make use of the different scopes by keeping an
instance of Ledger running in the background and running multiple
sessions with multiple reports per session.
</p>
<dl compact="compact">
<dt><samp>--args-only</samp>
<a name="index-_002d_002dargs_002donly"></a>
</dt>
<dd><p>Ignore all environment and init-file settings and
use only command-line arguments to control Ledger.  Useful for debugging
or testing small journal files not associated with your main financial
database.
</p>
</dd>
<dt><samp>--debug <var>CODE</var></samp>
<a name="index-_002d_002ddebug-CODE"></a>
</dt>
<dd><p><small>UNDOCUMENTED</small>! Please help by contributing documentation for this feature.
If ledger has been built with debug options this will provide extra data during
the run.
</p>
</dd>
<dt><samp>--help</samp>
<a name="index-_002d_002dhelp-1"></a>
</dt>
<dt><samp>-h</samp>
<a name="index-_002dh-1"></a>
</dt>
<dd><p>Display the man page for <samp>ledger</samp>.
</p>
</dd>
<dt><samp>--init-file <var>FILE</var></samp>
<a name="index-_002d_002dinit_002dfile-FILE-1"></a>
</dt>
<dd><p>Specify the location of the init file.  The default is home directory
<samp>~/.ledgerrc</samp>, or current directory <samp>./.ledgerrc</samp> if not found
in home directory.
</p>
</dd>
<dt><samp>--options</samp>
<a name="index-_002d_002doptions"></a>
</dt>
<dd><p>Display the options in effect for this Ledger invocation, along with
their values and the source of those values, for example:
</p>
<div class="smallexample">
<pre class="smallexample">$ ledger --options bal --cleared
</pre></div>

<div class="smallexample">
<pre class="smallexample">===============================================================================
[Global scope options]
             --args-only                                             --args-only

[Session scope options]
                  --file = A9349E4.dat                               --file

[Report scope options]
               --cleared                                             --cleared
               --columns = 80                                        --columns
                 --limit = cleared                                   --cleared
===============================================================================
              $15.00  Expenses
              $12.45    Food
               $2.55    Tips
             $-15.00  Liabilities:MasterCard
--------------------
                   0
</pre></div>

<p>For the source column, a value starting with a &lsquo;<samp>-</samp>&rsquo; or &lsquo;<samp>--</samp>&rsquo;
indicated the source was a command-line argument.  If the entry starts
with a &lsquo;<samp>$</samp>&rsquo;, the source was an environment variable.  If the source
is <code>?normalize</code> the value was set internally by ledger, in
a function called <code>normalize_options</code>.
</p>
</dd>
<dt><samp>--script <var>FILE</var></samp>
<a name="index-_002d_002dscript-FILE"></a>
</dt>
<dd><p>Execute a ledger script.
</p>
</dd>
<dt><samp>--trace <var>INT</var></samp>
<a name="index-_002d_002dtrace-INT"></a>
</dt>
<dd><p>Enable tracing.  The <var>INT</var> specifies the level of trace desired.
</p>
</dd>
<dt><samp>--verbose</samp>
<a name="index-_002d_002dverbose"></a>
</dt>
<dt><samp>-v</samp>
<a name="index-_002dv"></a>
</dt>
<dd><p>Print detailed information on the execution of Ledger.
</p>
</dd>
<dt><samp>--verify</samp>
<a name="index-_002d_002dverify"></a>
</dt>
<dd><p>Enable additional assertions during run-time.  This causes a significant
slowdown.  When combined with <samp>--debug <var>CODE</var></samp> ledger will
produce memory trace information.
</p>
</dd>
<dt><samp>--verify-memory</samp>
<a name="index-_002d_002dverify_002dmemory"></a>
</dt>
<dd><p>Verify that every constructed object is properly destructed.  This is for
debugging purposes only.
</p>
</dd>
<dt><samp>--version</samp>
<a name="index-_002d_002dversion-1"></a>
</dt>
<dd><p>Print version information and exit.
</p>
</dd>
</dl>

<hr>
<a name="Session-Options"></a>
<div class="header">
<p>
Next: <a href="#Report-Options" accesskey="n" rel="next">Report Options</a>, Previous: <a href="#Global-Options" accesskey="p" rel="prev">Global Options</a>, Up: <a href="#Detailed-Option-Description" accesskey="u" rel="up">Detailed Option Description</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Session-Options-1"></a>
<h4 class="subsection">8.3.2 Session Options</h4>

<p>Options for Ledger reports affect three separate scopes of operation:
Global, Session, and Report.  In practice there is very little
difference between these scopes.  Ledger 3.0 contains provisions for
GUIs, which would make use of the different scopes by keeping an
instance of Ledger running in the background and running multiple
sessions with multiple reports per session.
</p>
<dl compact="compact">
<dt><samp>--check-payees</samp>
<a name="index-_002d_002dcheck_002dpayees-1"></a>
</dt>
<dd><p>Enable strict and pedantic checking for payees as well as accounts,
commodities and tags.  This only works in conjunction with
<samp>--strict</samp> or <samp>--pedantic</samp>.
</p>
</dd>
<dt><samp>--day-break</samp>
<a name="index-_002d_002dday_002dbreak"></a>
</dt>
<dd><p>Break up <code>register</code> report of <a href="#timelog">timelog</a> entries that span multiple
days by day.
</p>
</dd>
<dt><samp>--decimal-comma</samp>
<a name="index-_002d_002ddecimal_002dcomma"></a>
</dt>
<dd><p>Direct Ledger to parse journals using the European standard comma as
a decimal separator, not the usual period.
</p>
</dd>
<dt><samp>--download</samp>
<a name="index-_002d_002ddownload-2"></a>
</dt>
<dt><samp>-Q</samp>
<a name="index-_002dQ-1"></a>
</dt>
<dd><p>Direct Ledger to download prices.
</p>
</dd>
<dt><samp>--explicit</samp>
<a name="index-_002d_002dexplicit"></a>
</dt>
<dd><p>Direct Ledger to require pre-declarations for entities (such as accounts,
commodities and tags) rather than taking entities from cleared
transactions as defined.  This option is useful in combination with
<samp>--strict</samp> or <samp>--pedantic</samp>.
</p>
</dd>
<dt><samp>--file <var>FILE</var></samp>
<a name="index-_002d_002dfile-FILE-1"></a>
</dt>
<dt><samp>-f <var>FILE</var></samp>
<a name="index-_002df-FILE-1"></a>
</dt>
<dd><p>Specify the input <samp>FILE</samp> for this invocation.
</p>

</dd>
<dt><samp>--input-date-format <var>DATE_FORMAT</var></samp>
<a name="index-_002d_002dinput_002ddate_002dformat-DATE_005fFORMAT-1"></a>
</dt>
<dd><p>Specify the input date format for journal entries.  For example,
</p>
<div class="smallexample">
<pre class="smallexample">$ ledger convert Export.csv --input-date-format &quot;%m/%d/%Y&quot;
</pre></div>

<p>Would convert the <samp>Export.csv</samp> file to ledger format, assuming
the dates in the CSV file are like 12/23/2009 (see <a href="#Date-and-Time-Format-Codes">Date and Time Format Codes</a>).
</p>
</dd>
<dt><samp>--master-account <var>STR</var></samp>
<a name="index-_002d_002dmaster_002daccount-STR"></a>
</dt>
<dd><p>Prepend all account names with the argument.
</p>
<div class="smallexample">
<pre class="smallexample">$ ledger -f drewr3.dat bal --no-total --master-account HUMBUG
</pre></div>

<div class="smallexample">
<pre class="smallexample">                   0  HUMBUG
         $ -3,804.00    Assets
          $ 1,396.00      Checking
             $ 30.00        Business
         $ -5,200.00      Savings
         $ -1,000.00    Equity:Opening Balances
          $ 6,654.00    Expenses
          $ 5,500.00      Auto
             $ 20.00      Books
            $ 300.00      Escrow
            $ 334.00      Food:Groceries
            $ 500.00      Interest:Mortgage
         $ -2,030.00    Income
         $ -2,000.00      Salary
            $ -30.00      Sales
            $ 180.00    Liabilities
            $ -20.00      MasterCard
            $ 200.00      Mortgage:Principal
</pre></div>

</dd>
<dt><samp>--no-aliases</samp>
<a name="index-_002d_002dno_002daliases"></a>
</dt>
<dd><p>Ledger does not expand any aliases if this option is specified.
</p>
</dd>
<dt><samp>--pedantic</samp>
<a name="index-_002d_002dpedantic-2"></a>
</dt>
<dd><p>Accounts, tags or commodities not previously declared will cause errors.
</p>
</dd>
<dt><samp>--permissive</samp>
<a name="index-_002d_002dpermissive-1"></a>
</dt>
<dd><p>Quiet balance assertions.
</p>
</dd>
<dt><samp>--price-db <var>FILE</var></samp>
<a name="index-_002d_002dprice_002ddb-FILE-2"></a>
</dt>
<dd><p>Specify the location of the price entry data file.
</p>
</dd>
<dt><samp>--price-exp <var>INT</var></samp>
<a name="index-_002d_002dprice_002dexp-INT-1"></a>
</dt>
<dt><samp>--leeway <var>INT</var></samp>
<a name="index-_002d_002dleeway-INT-1"></a>
</dt>
<dt><samp>-Z <var>INT</var></samp>
<a name="index-_002dZ-INT-1"></a>
</dt>
<dd><p>Set the expected freshness of price quotes, in <var>INT</var> minutes.  That
is, if the last known quote for any commodity is older than this value,
and if <samp>--download</samp> is being used, then the Internet will be
consulted again for a newer price.  Otherwise, the old price is still
considered to be fresh enough.
</p>
</dd>
<dt><samp>--strict</samp>
<a name="index-_002d_002dstrict-3"></a>
</dt>
<dd><p>Ledger normally silently accepts any account or commodity in a posting,
even if you have misspelled a commonly used one.  The option
<samp>--strict</samp> changes that behavior.  While running with
<samp>--strict</samp>, Ledger interprets all cleared transactions as
correct, and if it encounters a new account or commodity (same as
a misspelled commodity or account) it will issue a warning giving you
the file and line number of the problem.
</p>
</dd>
<dt><samp>--recursive-aliases</samp>
<a name="index-_002d_002drecursive_002daliases"></a>
</dt>
<dd><p>Normally, ledger only expands aliases once.  With this option, ledger
tries to expand the result of alias expansion recursively, until no more
expansions apply.
</p>
</dd>
<dt><samp>--time-colon</samp>
<a name="index-_002d_002dtime_002dcolon"></a>
</dt>
<dd><p>The <samp>--time-colon</samp> option will display the value for a seconds
based commodity as real hours and minutes.
</p>
<p>For example 8100 seconds by default will be displayed as 2.25 whereas
with the <samp>--time-colon</samp> option they will be displayed as 2:15.
</p>
</dd>
<dt><samp>--value-expr <var>VEXPR</var></samp>
<a name="index-_002d_002dvalue_002dexpr-VEXPR"></a>
</dt>
<dd><p>Set a global value expression annotation.
</p>
</dd>
</dl>

<hr>
<a name="Report-Options"></a>
<div class="header">
<p>
Next: <a href="#Basic-options" accesskey="n" rel="next">Basic options</a>, Previous: <a href="#Session-Options" accesskey="p" rel="prev">Session Options</a>, Up: <a href="#Detailed-Option-Description" accesskey="u" rel="up">Detailed Option Description</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Report-Options-1"></a>
<h4 class="subsection">8.3.3 Report Options</h4>

<p>Options for Ledger reports affect three separate scopes of operation:
Global, Session, and Report.  In practice there is very little
difference between these scopes.  Ledger 3.0 contains provisions for
GUIs, which would make use of the different scopes by keeping an
instance of Ledger running in the background and running multiple
sessions with multiple reports per session.
</p>
<dl compact="compact">
<dt><samp>--abbrev-len <var>INT</var></samp>
<a name="index-_002d_002dabbrev_002dlen-INT"></a>
</dt>
<dd><p>Set the minimum length an account can be abbreviated to if it doesn&rsquo;t
fit inside the <code>account-width</code>.  If <var>INT</var> is zero, then the
account name will be truncated on the right.  If <var>INT</var> is greater
than <code>account-width</code> then the account will be truncated on the
left, with no shortening of the account names in order to fit into the
desired width.
</p>
</dd>
<dt><samp>--account <var>STR</var></samp>
<a name="index-_002d_002daccount-STR-2"></a>
</dt>
<dd><p>Prepend <var>STR</var> to all accounts reported.  That is, the option
&lsquo;<samp>--account Personal</samp>&rsquo; would tack &lsquo;<samp>Personal:</samp>&rsquo; to the beginning
of every account reported in a balance report or register report.
</p>
</dd>
<dt><samp>--account-width <var>INT</var></samp>
<a name="index-_002d_002daccount_002dwidth-INT"></a>
</dt>
<dd><p>Set the width of the account column in the <code>register</code> report
to <var>INT</var> characters.
</p>
</dd>
<dt><samp>--actual</samp>
<a name="index-_002d_002dactual-1"></a>
</dt>
<dt><samp>-L</samp>
<a name="index-_002dL-1"></a>
</dt>
<dd><p>Report only real transactions, ignoring all automated or virtual
transactions.
</p>
</dd>
<dt><samp>--add-budget</samp>
<a name="index-_002d_002dadd_002dbudget-1"></a>
</dt>
<dd><p>Show only unbudgeted postings.
</p>
</dd>
<dt><samp>--amount <var>EXPR</var></samp>
<a name="index-_002d_002damount-EXPR-1"></a>
</dt>
<dt><samp>-t <var>EXPR</var></samp>
<a name="index-_002dt-EXPR-1"></a>
</dt>
<dd><p>Apply the given value expression to the posting amount (see <a href="#Value-Expressions">Value Expressions</a>).  Using <samp>--amount <var>EXPR</var></samp> you can apply an
arbitrary transformation to the postings.
</p>
</dd>
<dt><samp>--amount-data</samp>
<a name="index-_002d_002damount_002ddata-3"></a>
</dt>
<dt><samp>-j</samp>
<a name="index-_002dj-1"></a>
</dt>
<dd><p>On a register report print only the date and amount of postings.
Useful for graphing and spreadsheet applications.
</p>
</dd>
<dt><samp>--amount-width <var>INT</var></samp>
<a name="index-_002d_002damount_002dwidth-INT"></a>
</dt>
<dd><p>Set the width in characters of the amount column in the
<code>register</code> report.
</p>
</dd>
<dt><samp>--anon</samp>
<a name="index-_002d_002danon-1"></a>
</dt>
<dd><p>Anonymize registry output, mostly for sending in bug reports.
</p>
</dd>
<dt><samp>--auto-match</samp>
<a name="index-_002d_002dauto_002dmatch-1"></a>
</dt>
<dd><p>When generating a ledger transaction from a CSV file using the
<code>convert</code> command, automatically match an account from the
Ledger journal.
</p>
</dd>
<dt><samp>--aux-date</samp>
<a name="index-_002d_002daux_002ddate-1"></a>
</dt>
<dt><samp>--effective</samp>
<a name="index-_002d_002deffective-1"></a>
</dt>
<dd><p>Show auxiliary dates for all calculations (see <a href="#Effective-Dates">Effective Dates</a>).
</p>
</dd>
<dt><samp>--average</samp>
<a name="index-_002d_002daverage-2"></a>
</dt>
<dt><samp>-A</samp>
<a name="index-_002dA-1"></a>
</dt>
<dd><p>Print average values over the number of transactions instead of
running totals.
</p>
</dd>
<dt><samp>--balance-format <var>FORMAT_STRING</var></samp>
<a name="index-_002d_002dbalance_002dformat-FORMAT_005fSTRING-1"></a>
</dt>
<dd><p>Specify the format to use for the <code>balance</code> report (see <a href="#Format-Strings">Format Strings</a>).  The default is:
</p>
<div class="smallexample">
<pre class="smallexample">&quot;%(justify(scrub(display_total), 20, -1, true, color))&quot;
&quot;  %(!options.flat ? depth_spacer : \&quot;\&quot;)&quot;
&quot;%-(ansify_if(partial_account(options.flat), blue if color))\n%/&quot;
&quot;%$1\n%/&quot;
&quot;--------------------\n&quot;
</pre></div>

</dd>
<dt><samp>--base</samp>
<a name="index-_002d_002dbase"></a>
</dt>
<dd><p>Reduce convertible commodities down the bottom of the conversion, e.g.
display time in seconds.  This also applies to custom commodity
conversions (see <a href="#Commodity-equivalences">Commodity equivalences</a>).
</p>
</dd>
<dt><samp>--basis</samp>
<a name="index-_002d_002dbasis-1"></a>
</dt>
<dt><samp>-B</samp>
<a name="index-_002dB-1"></a>
</dt>
<dt><samp>--cost</samp>
<a name="index-_002d_002dcost"></a>
</dt>
<dd><p>Report the cost basis on all posting.
</p>
</dd>
<dt><samp>--begin <var>DATE</var></samp>
<a name="index-_002d_002dbegin-DATE-1"></a>
</dt>
<dd><p>Specify the start <var>DATE</var> of all calculations.  Transactions before
that date will be ignored.
</p>
</dd>
<dt><samp>--bold-if <var>VEXPR</var></samp>
<a name="index-_002d_002dbold_002dif-VEXPR"></a>
</dt>
<dd><p>Print the entire line in bold if the given value expression is true
(see <a href="#Value-Expressions">Value Expressions</a>).
</p>
<div class="smallexample">
<pre class="smallexample">$ ledger reg Expenses --begin Dec --bold-if &quot;amount&gt;100&quot;
</pre></div>

<p>list all transactions since the beginning of December and print in
bold any posting greater than $100.
</p>
</dd>
<dt><samp>--budget</samp>
<a name="index-_002d_002dbudget-2"></a>
</dt>
<dd><p>Only display budgeted items.  In a register report this
displays transactions in the budget, in a balance report this displays
accounts in the budget (see <a href="#Budgeting-and-Forecasting">Budgeting and Forecasting</a>).
</p>
</dd>
<dt><samp>--budget-format <var>FORMAT_STRING</var></samp>
<a name="index-_002d_002dbudget_002dformat-FORMAT_005fSTRING"></a>
</dt>
<dd><p>Specify the format to use for the <code>budget</code> report (see <a href="#Format-Strings">Format Strings</a>).  The default is:
</p>
<div class="smallexample">
<pre class="smallexample">&quot;%(justify(scrub(get_at(display_total, 0)), 12, -1, true, color))&quot;
&quot; %(justify(-scrub(get_at(display_total, 1)), 12, &quot;
&quot;           12 + 1 + 12, true, color))&quot;
&quot; %(justify(scrub(get_at(display_total, 1) + &quot;
&quot;                 get_at(display_total, 0)), 12, &quot;
&quot;           12 + 1 + 12 + 1 + 12, true, color))&quot;
&quot; %(ansify_if(&quot;
&quot;   justify((get_at(display_total, 1) ? &quot;
&quot;            (100% * quantity(scrub(get_at(display_total, 0)))) / &quot;
&quot;             -quantity(scrub(get_at(display_total, 1))) : 0), &quot;
&quot;           5, -1, true, false),&quot;
&quot;   magenta if (color and get_at(display_total, 1) and &quot;
&quot;               (abs(quantity(scrub(get_at(display_total, 0))) / &quot;
&quot;                    quantity(scrub(get_at(display_total, 1)))) &gt;= 1))))&quot;
&quot;  %(!options.flat ? depth_spacer : \&quot;\&quot;)&quot;
&quot;%-(ansify_if(partial_account(options.flat), blue if color))\n&quot;
&quot;%/%$1 %$2 %$3 %$4\n%/&quot;
&quot;%(prepend_width ? \&quot; \&quot; * int(prepend_width) : \&quot;\&quot;)&quot;
&quot;------------ ------------ ------------ -----\n&quot;
</pre></div>

</dd>
<dt><samp>--by-payee</samp>
<a name="index-_002d_002dby_002dpayee-4"></a>
</dt>
<dt><samp>-P</samp>
<a name="index-_002dP-2"></a>
</dt>
<dd><p>Group the register report by payee.
</p>
</dd>
<dt><samp>--cleared</samp>
<a name="index-_002d_002dcleared-2"></a>
</dt>
<dt><samp>-C</samp>
<a name="index-_002dC-1"></a>
</dt>
<dd><p>Consider only transactions that have been cleared for display and
calculation.
</p>
</dd>
<dt><samp>--cleared-format <var>FORMAT_STRING</var></samp>
<a name="index-_002d_002dcleared_002dformat-FORMAT_005fSTRING"></a>
</dt>
<dd><p>Specify the format to use for the <code>cleared</code> report (see <a href="#Format-Strings">Format Strings</a>).  The default is:
</p>
<div class="smallexample">
<pre class="smallexample">&quot;%(justify(scrub(get_at(total_expr, 0)), 16, 16 + prepend_width, &quot;
&quot; true, color))  %(justify(scrub(get_at(total_expr, 1)), 18, &quot;
&quot; 36 + prepend_width, true, color))&quot;
&quot;    %(latest_cleared ? format_date(latest_cleared) : \&quot;         \&quot;)&quot;
&quot;    %(!options.flat ? depth_spacer : \&quot;\&quot;)&quot;
&quot;%-(ansify_if(partial_account(options.flat), blue if color))\n%/&quot;
&quot;%$1  %$2    %$3\n%/&quot;
&quot;%(prepend_width ? \&quot; \&quot; * prepend_width : \&quot;\&quot;)&quot;
&quot;----------------    ----------------    ---------\n&quot;
</pre></div>

</dd>
<dt><samp>--collapse</samp>
<a name="index-_002d_002dcollapse-1"></a>
</dt>
<dt><samp>-n</samp>
<a name="index-_002dn-1"></a>
</dt>
<dd><p>By default ledger prints all accounts in an account tree.  With
<samp>--collapse</samp> it prints only the top level account specified.
</p>
</dd>
<dt><samp>--collapse-if-zero</samp>
<a name="index-_002d_002dcollapse_002dif_002dzero"></a>
</dt>
<dd><p>Collapse the account display only if it has a zero balance.
</p>
</dd>
<dt><samp>--color</samp>
<a name="index-_002d_002dcolor"></a>
</dt>
<dt><samp>--ansi</samp>
<a name="index-_002d_002dansi"></a>
</dt>
<dd><p>Use color if the terminal supports it.
</p>
</dd>
<dt><samp>--columns <var>INT</var></samp>
<a name="index-_002d_002dcolumns-INT"></a>
</dt>
<dd><p>Specify the width of the <code>register</code> report in characters.
</p>
</dd>
<dt><samp>--count</samp>
<a name="index-_002d_002dcount-1"></a>
</dt>
<dd><p>Direct ledger to report the number of items when appended to the
<code>commodities</code>, <code>accounts</code> or <code>payees</code> command.
</p>
</dd>
<dt><samp>--csv-format <var>FORMAT_STRING</var></samp>
<a name="index-_002d_002dcsv_002dformat-FORMAT_005fSTRING"></a>
</dt>
<dd><p>Specify the format to use for the <code>csv</code> report (see <a href="#Format-Strings">Format Strings</a>).  The default is:
</p>
<div class="smallexample">
<pre class="smallexample">&quot;%(quoted(date)),&quot;
&quot;%(quoted(code)),&quot;
&quot;%(quoted(payee)),&quot;
&quot;%(quoted(display_account)),&quot;
&quot;%(quoted(commodity(scrub(display_amount)))),&quot;
&quot;%(quoted(quantity(scrub(display_amount)))),&quot;
&quot;%(quoted(cleared ? \&quot;*\&quot; : (pending ? \&quot;!\&quot; : \&quot;\&quot;))),&quot;
&quot;%(quoted(join(note | xact.note)))\n&quot;
</pre></div>

</dd>
<dt><samp>--current</samp>
<a name="index-_002d_002dcurrent-1"></a>
</dt>
<dd><p>Shorthand for &lsquo;<samp>--limit &quot;date &lt;= today&quot;</samp>&rsquo;.
</p>
</dd>
<dt><samp>--daily</samp>
<a name="index-_002d_002ddaily-1"></a>
</dt>
<dt><samp>-D</samp>
<a name="index-_002dD-2"></a>
</dt>
<dd><p>Shorthand for &lsquo;<samp>--period &quot;daily&quot;</samp>&rsquo;.
</p>
</dd>
<dt><samp>--date <var>EXPR</var></samp>
<a name="index-_002d_002ddate-EXPR"></a>
</dt>
<dd><p>Transform the date of the transaction using <var>EXPR</var>.
</p>
</dd>
<dt><samp>--date-format <var>DATE_FORMAT</var></samp>
<a name="index-_002d_002ddate_002dformat-DATE_005fFORMAT-1"></a>
</dt>
<dt><samp>-y <var>DATE_FORMAT</var></samp>
<a name="index-_002dy-DATE_005fFORMAT-1"></a>
</dt>
<dd><p>Specify the format ledger should use to read and print dates
(see <a href="#Date-and-Time-Format-Codes">Date and Time Format Codes</a>).
</p>
</dd>
<dt><samp>--date-width <var>INT</var></samp>
<a name="index-_002d_002ddate_002dwidth-INT"></a>
</dt>
<dd><p>Specify the width, in characters, of the date column in the
<code>register</code> report.
</p>
</dd>
<dt><samp>--datetime-format <var>DATETIME_FORMAT</var></samp>
<a name="index-_002d_002ddatetime_002dformat-DATETIME_005fFORMAT"></a>
</dt>
<dd><p>Specify the format ledger should use to print datetimes.
</p>
</dd>
<dt><samp>--dc</samp>
<a name="index-_002d_002ddc-1"></a>
</dt>
<dd><p>Display register or balance in debit/credit format If you use
<samp>--dc</samp> with either the <code>register</code> (reg) or
<code>balance</code> (bal) commands, you will now get extra columns.
The register goes from this:
</p>
<div class="smallexample">
<pre class="smallexample">12-Mar-10 Employer           Assets:Cash                $100        $100
                             Income:Employer           $-100           0
12-Mar-10 KFC                Expenses:Food               $20         $20
                             Assets:Cash                $-20           0
12-Mar-10 KFC - Rebate       Assets:Cash                  $5          $5
                             Expenses:Food               $-5           0
12-Mar-10 KFC - Food &amp; Reb.. Expenses:Food               $20         $20
                             Expenses:Food               $-5         $15
                             Assets:Cash                $-15           0
</pre></div>

<p>To this:
</p>
<div class="smallexample">
<pre class="smallexample">12-Mar-10 Employer       Assets:Cash        $100           0        $100
                         In:Employer           0        $100           0
12-Mar-10 KFC            Expens:Food         $20           0         $20
                         Assets:Cash           0         $20           0
12-Mar-10 KFC - Rebate   Assets:Cash          $5           0          $5
                         Expens:Food           0          $5           0
12-Mar-10 KFC - Food &amp;.. Expens:Food         $20           0         $20
                         Expens:Food           0          $5         $15
                         Assets:Cash           0         $15           0
</pre></div>

<p>Where the first column is debits, the second is credits, and the third
is the running total.  Only the running total may contain negative
values.
</p>
<p>For the balance report without <samp>--dc</samp>:
</p>
<div class="smallexample">
<pre class="smallexample">                 $70  Assets:Cash
                 $30  Expenses:Food
               $-100  Income:Employer
--------------------
                   0
</pre></div>

<p>And with <samp>--dc</samp> it becomes this:
</p>
<div class="smallexample">
<pre class="smallexample">          $105            $35            $70  Assets:Cash
           $40            $10            $30  Expenses:Food
             0           $100          $-100  Income:Employer
--------------------------------------------
          $145           $145              0
</pre></div>

</dd>
<dt><samp>--depth <var>INT</var></samp>
<a name="index-_002d_002ddepth-INT"></a>
</dt>
<dd><p>Limit the depth of the account tree.  In a balance report, for example,
a &lsquo;<samp>--depth 2</samp>&rsquo; statement will print balances only for accounts with
two levels, i.e. &lsquo;<samp>Expenses:Entertainment</samp>&rsquo; but not
&lsquo;<samp>Expenses:Entertainment:Dining</samp>&rsquo;.  This is a display predicate, which
means it only affects display, not the total calculations.
</p>
</dd>
<dt><samp>--deviation</samp>
<a name="index-_002d_002ddeviation-1"></a>
</dt>
<dd><p>Report each postings deviation from the average.  It is only meaningful
in the register and prices reports.
</p>
</dd>
<dt><samp>--display <var>EXPR</var></samp>
<a name="index-_002d_002ddisplay-EXPR-3"></a>
</dt>
<dd><p>Display only lines that satisfy the expression <var>EXPR</var>.
</p>
</dd>
<dt><samp>--display-amount <var>EXPR</var></samp>
<a name="index-_002d_002ddisplay_002damount-EXPR"></a>
</dt>
<dd><p>Apply a transformation to the <em>displayed</em> amount.  This happens
after calculations occur.
</p>
</dd>
<dt><samp>--display-total <var>EXPR</var></samp>
<a name="index-_002d_002ddisplay_002dtotal-EXPR"></a>
</dt>
<dd><p>Apply a transformation to the <em>displayed</em> total.  This happens after
calculations occur.
</p>
</dd>
<dt><samp>--dow</samp>
<a name="index-_002d_002ddow-2"></a>
</dt>
<dt><samp>--days-of-week</samp>
<a name="index-_002d_002ddays_002dof_002dweek"></a>
</dt>
<dd><p>Group transactions by the day of the week.
</p>
<div class="smallexample">
<pre class="smallexample">$ ledger reg Expenses --dow --collapse
</pre></div>

<p>Will print all Expenses totaled for each day of the week.
</p>
</dd>
<dt><samp>--empty</samp>
<a name="index-_002d_002dempty-2"></a>
</dt>
<dt><samp>-E</samp>
<a name="index-_002dE-1"></a>
</dt>
<dd><p>Include empty accounts in the report and in average calculations.
</p>
</dd>
<dt><samp>--end <var>DATE</var></samp>
<a name="index-_002d_002dend-DATE-1"></a>
</dt>
<dd><p>Specify the end <var>DATE</var> for a transaction to be considered in the
report.  All transactions on or after this date are ignored.
</p>
</dd>
<dt><samp>--equity</samp>
<a name="index-_002d_002dequity"></a>
</dt>
<dd><p>Related to the <code>equity</code> command (see <a href="#The-equity-command">The <code>equity</code> command</a>).  Gives current account balances in the form of a register
report.
</p>
</dd>
<dt><samp>--exact</samp>
<a name="index-_002d_002dexact"></a>
</dt>
<dd><p>Report beginning and ending of periods by the date of the first and last
posting occurring in that period.
</p>
</dd>
<dt><samp>--exchange <var>COMMODITY</var></samp>
<a name="index-_002d_002dexchange-COMMODITY-2"></a>
</dt>
<dt><samp>-X <var>COMMODITY</var></samp>
<a name="index-_002dX-COMMODITY"></a>
</dt>
<dd><p>Display values in terms of the given <var>COMMODITY</var>.  The latest
available price is used.  The syntax
<samp>-X <var>COMMODITY1</var>:<var>COMMODITY2</var></samp> displays values in <var>COMMODITY1</var>
in terms of <var>COMMODITY2</var> using the latest available price, but
will not automatically covert any other commodities to
<var>COMMODITY2</var>.  Multiple <samp>-X</samp> arguments may be used on a
single command-line (as in
<samp>-X COMMODITY1:COMMODITY2 -X COMMODITY3:COMMODITY2</samp>),
which is particularly useful for situations where many prices are
available for reporting in terms of <var>COMMODITY2</var>, but only a few
should be displayed that way.
</p>
</dd>
<dt><samp>--flat</samp>
<a name="index-_002d_002dflat"></a>
</dt>
<dd><p>Force the full names of accounts to be used in the balance report.  The
balance report will not use an indented tree.
</p>
</dd>
<dt><samp>--force-color</samp>
<a name="index-_002d_002dforce_002dcolor"></a>
</dt>
<dd><p>Output TTY color codes even if the TTY doesn&rsquo;t support them.  Useful
for TTYs that don&rsquo;t advertise their capabilities correctly.
</p>
</dd>
<dt><samp>--force-pager</samp>
<a name="index-_002d_002dforce_002dpager"></a>
</dt>
<dd><p>Force Ledger to paginate its output.
</p>
</dd>
<dt><samp>--forecast-while <var>VEXPR</var></samp>
<a name="index-_002d_002dforecast_002dwhile-VEXPR-1"></a>
</dt>
<dt><samp>--forecast <var>VEXPR</var></samp>
<a name="index-_002d_002dforecast-VEXPR-1"></a>
</dt>
<dd><p>Continue forecasting while <var>VEXPR</var> is true.
</p>
</dd>
<dt><samp>--forecast-years <var>INT</var></samp>
<a name="index-_002d_002dforecast_002dyears-INT"></a>
</dt>
<dd><p>Forecast at most <var>INT</var> years into the future.
</p>
</dd>
<dt><samp>--format <var>FORMAT_STRING</var></samp>
<a name="index-_002d_002dformat-FORMAT_005fSTRING-1"></a>
</dt>
<dt><samp>-F <var>FORMAT_STRING</var></samp>
<a name="index-_002dF-FORMAT_005fSTRING-1"></a>
</dt>
<dd><p>Use the given format string to print output.
</p>
</dd>
<dt><samp>--gain</samp>
<a name="index-_002d_002dgain-1"></a>
</dt>
<dt><samp>-G</samp>
<a name="index-_002dG-1"></a>
</dt>
<dt><samp>--change</samp>
<a name="index-_002d_002dchange"></a>
</dt>
<dd><p>Report on gains using the latest available prices.
</p>
</dd>
<dt><samp>--generated</samp>
<a name="index-_002d_002dgenerated"></a>
</dt>
<dd><p>Include auto-generated postings (such as those from automated
transactions) in the report, in cases where you normally wouldn&rsquo;t want
them.
</p>
</dd>
<dt><samp>--group-by <var>EXPR</var></samp>
<a name="index-_002d_002dgroup_002dby-EXPR"></a>
</dt>
<dd><p>Group transactions together in the <code>register</code> report.
<var>EXPR</var> can be anything, although most common would be <code>payee</code>
or <code>commodity</code>.  The <code>tags()</code> function is also useful here.
</p>
</dd>
<dt><samp>--group-title-format <var>FORMAT_STRING</var></samp>
<a name="index-_002d_002dgroup_002dtitle_002dformat-FORMAT_005fSTRING"></a>
</dt>
<dd><p>Set the format for the headers that separates the report sections of
a grouped report.  Only has an effect with a <samp>--group-by
<var>EXPR</var></samp> register report.
</p>
<div class="smallexample">
<pre class="smallexample">$ ledger reg Expenses --group-by &quot;payee&quot; --group-title-format &quot;------------------------ %-20(value) ---------------------\n&quot;
</pre></div>
<div class="smallexample">
<pre class="smallexample">------------------------ 7-Eleven             ---------------------
2011/08/13 7-Eleven              Expenses:Auto:Misc          $ 5.80       $ 5.80

------------------------ AAA Dues             ---------------------
2011/06/02 AAA Dues              Expenses:Auto:Misc        $ 215.00     $ 215.00

------------------------ ABC Towing and Wrecking ---------------------
2011/03/17 ABC Towing and Wrec..  Expenses:Auto:Hobbies      $ 48.20      $ 48.20
...
</pre></div>

</dd>
<dt><samp>--head <var>INT</var></samp>
<a name="index-_002d_002dhead-INT-1"></a>
</dt>
<dt><samp>--first <var>INT</var></samp>
<a name="index-_002d_002dfirst-INT"></a>
</dt>
<dd><p>Print the first <var>INT</var> entries.  Opposite of <samp>--tail
<var>INT</var></samp>.
</p>
</dd>
<dt><samp>--historical</samp>
<a name="index-_002d_002dhistorical"></a>
</dt>
<dt><samp>-H</samp>
<a name="index-_002dH"></a>
</dt>
<dd><p>Value commodities at the time of their acquisition.
</p>
</dd>
<dt><samp>--immediate</samp>
<a name="index-_002d_002dimmediate-1"></a>
</dt>
<dd><p>Evaluate calculations immediately rather than lazily.
</p>
</dd>
<dt><samp>--inject</samp>
<a name="index-_002d_002dinject"></a>
</dt>
<dd><p>Use <code>Expected</code> amounts in calculations.  In case you know
what amount a transaction should be, but the actual transaction has the
wrong value you can use metadata to specify the expected amount:
</p>
<div class="smallexample">
<pre class="smallexample">2012-03-12  Paycheck
    Income  $-990;  Expected:: $-1000.00
    Checking
</pre></div>

<p>Then using the command <code>ledger reg --inject=Expected Income</code> would
treat the transaction as if the &ldquo;Expected Value&rdquo; was actual.
</p>
</dd>
<dt><samp>--invert</samp>
<a name="index-_002d_002dinvert-1"></a>
</dt>
<dd><p>Change the sign of all reported values.
</p>
</dd>
<dt><samp>--limit <var>EXPR</var></samp>
<a name="index-_002d_002dlimit-EXPR-3"></a>
</dt>
<dt><samp>-l <var>EXPR</var></samp>
<a name="index-_002dl-EXPR-1"></a>
</dt>
<dd><p>Only transactions that satisfy <var>EXPR</var> are considered in
calculations and for display.
</p>
</dd>
<dt><samp>--lot-dates</samp>
<a name="index-_002d_002dlot_002ddates-1"></a>
</dt>
<dd><p>Report the date on which each commodity in a balance report was
purchased.
</p>
</dd>
<dt><samp>--lot-notes</samp>
<a name="index-_002d_002dlot_002dnotes-1"></a>
</dt>
<dt><samp>--lot-tags</samp>
<a name="index-_002d_002dlot_002dtags"></a>
</dt>
<dd><p>Report the tag attached to each commodity in a balance report.
</p>
</dd>
<dt><samp>--lot-prices</samp>
<a name="index-_002d_002dlot_002dprices-1"></a>
</dt>
<dd><p>Report the price at which each commodity in a balance report was
purchased.
</p>
</dd>
<dt><samp>--lots</samp>
<a name="index-_002d_002dlots-1"></a>
</dt>
<dd><p>Report the date and price at which each commodity was purchased in
a balance report.
</p>
</dd>
<dt><samp>--lots-actual</samp>
<a name="index-_002d_002dlots_002dactual"></a>
</dt>
<dd><p>Preserve the uniqueness of commodities so they aren&rsquo;t merged during
reporting without printing the lot annotations.
</p>
</dd>
<dt><samp>--market</samp>
<a name="index-_002d_002dmarket-4"></a>
</dt>
<dt><samp>-V</samp>
<a name="index-_002dV-1"></a>
</dt>
<dd><p>Use the latest market value for all commodities.
</p>
</dd>
<dt><samp>--meta <var>TAG</var></samp>
<a name="index-_002d_002dmeta-TAG"></a>
</dt>
<dd><p>In the register report, prepend the transaction with the value of the
given <var>TAG</var>.
</p>
</dd>
<dt><samp>--meta-width <var>INT</var></samp>
<a name="index-_002d_002dmeta_002dwidth-INT"></a>
</dt>
<dd><p>Specify the width of the Meta column used for the <samp>--meta
<var>TAG</var></samp> options.
</p>
</dd>
<dt><samp>--monthly</samp>
<a name="index-_002d_002dmonthly-3"></a>
</dt>
<dt><samp>-M</samp>
<a name="index-_002dM-1"></a>
</dt>
<dd><p>Synonym for &lsquo;<samp>--period &quot;monthly&quot;</samp>&rsquo;.
</p>
</dd>
<dt><samp>--no-aliases</samp>
<a name="index-_002d_002dno_002daliases-1"></a>
</dt>
<dd><p>Aliases are completely ignored.
</p>
</dd>
<dt><samp>--no-color</samp>
<a name="index-_002d_002dno_002dcolor"></a>
</dt>
<dd><p>Suppress any color TTY output.
</p>
</dd>
<dt><samp>--no-pager</samp>
<a name="index-_002d_002dno_002dpager-1"></a>
</dt>
<dd><p>Direct output to stdout, avoiding pager program.
</p>
</dd>
<dt><samp>--no-revalued</samp>
<a name="index-_002d_002dno_002drevalued"></a>
</dt>
<dd><p>Stop Ledger from showing <code>&lt;Revalued&gt;</code> postings.  This option is useful
in combination with the <samp>--exchange</samp> or <samp>--market</samp> option.
</p>
</dd>
<dt><samp>--no-rounding</samp>
<a name="index-_002d_002dno_002drounding"></a>
</dt>
<dd><p>Don&rsquo;t output &lsquo;<samp>&lt;Adjustment&gt;</samp>&rsquo; postings.  Note that this will cause the
running total to often not add up!  Its main use is for
<samp>--amount-data (-j)</samp> and <samp>--total-data (-J)</samp> reports.
</p>
</dd>
<dt><samp>--no-titles</samp>
<a name="index-_002d_002dno_002dtitles"></a>
</dt>
<dd><p>Suppress the output of group titles.
</p>
</dd>
<dt><samp>--no-total</samp>
<a name="index-_002d_002dno_002dtotal"></a>
</dt>
<dd><p>Suppress printing the final total line in a balance report.
</p>
</dd>
<dt><samp>--now <var>DATE</var></samp>
<a name="index-_002d_002dnow-DATE"></a>
</dt>
<dd><p>Define the current date in case you want to calculate in the past or
future using <samp>--current</samp>.
</p>
</dd>
<dt><samp>--only <var>FIXME</var></samp>
<a name="index-_002d_002donly-FIXME"></a>
</dt>
<dd><p>This is a postings predicate that applies after certain transforms have
been executed, such as periodic gathering.
</p>
</dd>
<dt><samp>--output <var>FILE</var></samp>
<a name="index-_002d_002doutput-FILE-1"></a>
</dt>
<dd><p>Redirect the output of ledger to the file defined in <samp>FILE</samp>.
</p>
</dd>
<dt><samp>--pager <var>FILE</var></samp>
<a name="index-_002d_002dpager-FILE-1"></a>
</dt>
<dd><p>Direct output to <var>FILE</var> pager program.
</p>
</dd>
<dt><samp>--payee <var>VEXPR</var></samp>
<a name="index-_002d_002dpayee-VEXPR"></a>
</dt>
<dd><p>Sets a value expression for formatting the payee.  In the
<code>register</code> report this prevents the second entry from having
a date and payee for each transaction.
</p>
</dd>
<dt><samp>--payee-width <var>INT</var></samp>
<a name="index-_002d_002dpayee_002dwidth-INT"></a>
</dt>
<dd><p>Set the number of columns dedicated to the payee in the register
report to <var>INT</var>.
</p>
</dd>
<dt><samp>--pending</samp>
<a name="index-_002d_002dpending-1"></a>
</dt>
<dd><p>Use only postings that are marked pending.
</p>
</dd>
<dt><samp>--percent</samp>
<a name="index-_002d_002dpercent-1"></a>
</dt>
<dt><samp>-%</samp>
<a name="index-_002d_0025-1"></a>
</dt>
<dd><p>Calculate the percentage value of each account in balance reports.
Only works for accounts that have a single commodity.
</p>
</dd>
<dt><samp>--period <var>PERIOD_EXPRESSION</var></samp>
<a name="index-_002d_002dperiod-PERIOD_005fEXPRESSION-1"></a>
</dt>
<dd><p>Define a period expression that sets the time period during which
transactions are to be accounted.  For a <code>register</code> report only
the transactions that satisfy the period expression with be displayed.
For a <code>balance</code> report only those transactions will be accounted
in the final balances.
</p>
</dd>
<dt><samp>--pivot <var>TAG</var></samp>
<a name="index-_002d_002dpivot-TAG-1"></a>
</dt>
<dd><p>Produce a balance pivot report <em>around</em> the given <var>TAG</var>.  For
example, if you have multiple cars and track each fuel purchase in
&lsquo;<samp>Expenses:Auto:Fuel</samp>&rsquo; and tag each fuel purchase with a tag
identifying which car the purchase was for &lsquo;<samp>; Car: Prius</samp>&rsquo;, then the
command:
</p>
<div class="smallexample">
<pre class="smallexample">$ ledger bal Fuel --pivot &quot;Car&quot; --period &quot;this year&quot;
</pre></div>
<div class="smallexample">
<pre class="smallexample">           $ 3491.26  Car
           $ 1084.22    M3:Expenses:Auto:Fuel
            $ 149.65    MG V11:Expenses:Auto:Fuel
            $ 621.89    Prius:Expenses:Auto:Fuel
           $ 1635.50    Sienna:Expenses:Auto:Fuel
             $ 42.69  Expenses:Auto:Fuel
--------------------
           $ 3533.95
</pre></div>

<p>See <a href="#Metadata-values">Metadata values</a>.
</p>
</dd>
<dt><samp>--plot-amount-format <var>FORMAT_STRING</var></samp>
<a name="index-_002d_002dplot_002damount_002dformat-FORMAT_005fSTRING-1"></a>
</dt>
<dd><p>Define the output format for an amount data plot.  See <a href="#Visualizing-with-Gnuplot">Visualizing with Gnuplot</a>.
</p>
</dd>
<dt><samp>--plot-total-format <var>FORMAT_STRING</var></samp>
<a name="index-_002d_002dplot_002dtotal_002dformat-FORMAT_005fSTRING-1"></a>
</dt>
<dd><p>Define the output format for a total data plot.  See <a href="#Visualizing-with-Gnuplot">Visualizing with Gnuplot</a>.
</p>
</dd>
<dt><samp>--prepend-format <var>FORMAT_STRING</var></samp>
<a name="index-_002d_002dprepend_002dformat-FORMAT_005fSTRING"></a>
</dt>
<dd><p>Prepend <var>STR</var> to every line of the output.
</p>
</dd>
<dt><samp>--prepend-width <var>INT</var></samp>
<a name="index-_002d_002dprepend_002dwidth-INT"></a>
</dt>
<dd><p>Reserve <var>INT</var> spaces at the beginning of each line of the output.
</p>
</dd>
<dt><samp>--price</samp>
<a name="index-_002d_002dprice"></a>
</dt>
<dt><samp>-I</samp>
<a name="index-_002dI"></a>
</dt>
<dd><p>Use the price of the commodity purchase for performing calculations.
</p>
</dd>
<dt><samp>--pricedb-format <var>FORMAT_STRING</var></samp>
<a name="index-_002d_002dpricedb_002dformat-FORMAT_005fSTRING"></a>
</dt>
<dd><p>Set the format expected for the historical price file.
</p>
</dd>
<dt><samp>--prices-format <var>FORMAT_STRING</var></samp>
<a name="index-_002d_002dprices_002dformat-FORMAT_005fSTRING-1"></a>
</dt>
<dd><p>Set the format for the <code>prices</code> report.
</p>
</dd>
<dt><samp>--primary-date</samp>
<a name="index-_002d_002dprimary_002ddate"></a>
</dt>
<dt><samp>--actual-dates</samp>
<a name="index-_002d_002dactual_002ddates"></a>
</dt>
<dd><p>Show primary dates for all calculations (see <a href="#Effective-Dates">Effective Dates</a>).
</p>
</dd>
<dt><samp>--quantity</samp>
<a name="index-_002d_002dquantity-1"></a>
</dt>
<dt><samp>-O</samp>
<a name="index-_002dO-1"></a>
</dt>
<dd><p>Report commodity totals (this is the default).
</p>
</dd>
<dt><samp>--quarterly</samp>
<a name="index-_002d_002dquarterly-2"></a>
</dt>
<dd><p>Synonym for &lsquo;<samp>--period &quot;quarterly&quot;</samp>&rsquo;.
</p>
</dd>
<dt><samp>--raw</samp>
<a name="index-_002d_002draw"></a>
</dt>
<dd><p>In the <code>print</code> report, show transactions using the exact same
syntax as specified by the user in their data file.  Don&rsquo;t do any
massaging or interpreting.  This can be useful for minor cleanups, like
just aligning amounts.
</p>
</dd>
<dt><samp>--real</samp>
<a name="index-_002d_002dreal-3"></a>
</dt>
<dt><samp>-R</samp>
<a name="index-_002dR-1"></a>
</dt>
<dd><p>Account using only real transactions ignoring virtual and automatic
transactions.
</p>
</dd>
<dt><samp>--register-format <var>FORMAT_STRING</var></samp>
<a name="index-_002d_002dregister_002dformat-FORMAT_005fSTRING-1"></a>
</dt>
<dd><p>Define the output format for the <code>register</code> report.
</p>
</dd>
<dt><samp>--related</samp>
<a name="index-_002d_002drelated-2"></a>
</dt>
<dd><p>In a <code>register</code> report show the related account.  This is the
other <em>side</em> of the transaction.
</p>
</dd>
<dt><samp>--related-all</samp>
<a name="index-_002d_002drelated_002dall"></a>
</dt>
<dd><p>Show all postings in a transaction, similar to <samp>--related</samp> but
show both <em>sides</em> of each transaction.
</p>
</dd>
<dt><samp>--revalued</samp>
<a name="index-_002d_002drevalued"></a>
</dt>
<dd><p>Report discrepancy in values for manual reports by inserting <code>&lt;Revalued&gt;</code>
postings.  This is implied when using the <samp>--exchange</samp> or
<samp>--market</samp> option.
</p>
</dd>
<dt><samp>--revalued-only</samp>
<a name="index-_002d_002drevalued_002donly"></a>
</dt>
<dd><p>Show only <code>&lt;Revalued&gt;</code> postings.
</p>
</dd>
<dt><samp>--revalued-total <var>FIXME</var></samp>
<a name="index-_002d_002drevalued_002dtotal-FIXME"></a>
</dt>
<dd><p>Display the sum of the revalued postings as the running total, which serves
to show unrealized capital in a gain/losses report.
</p>
</dd>
<dt><samp>--rich-data</samp>
<a name="index-_002d_002drich_002ddata-1"></a>
</dt>
<dt><samp>--detail</samp>
<a name="index-_002d_002ddetail"></a>
</dt>
<dd><p>When generating a ledger transaction from a CSV file using the
<code>convert</code> command, add CSV, Imported, and UUID metadata.
</p>
</dd>
<dt><samp>--seed <var>INT</var></samp>
<a name="index-_002d_002dseed-INT"></a>
</dt>
<dd><p>Set the random seed to <var>INT</var> for the <code>generate</code> command.
Used as part of development testing.
</p>
</dd>
<dt><samp>--sort <var>VEXPR</var></samp>
<a name="index-_002d_002dsort-VEXPR-1"></a>
</dt>
<dt><samp>-S <var>VEXPR</var></samp>
<a name="index-_002dS-VEXPR-1"></a>
</dt>
<dd><p>Sort the <code>register</code> report based on the value expression given
to sort.
</p>
</dd>
<dt><samp>--sort-all <var>FIXME</var></samp>
<a name="index-_002d_002dsort_002dall-FIXME"></a>
</dt>
<dd><p><small>UNDOCUMENTED</small>! Please help by contributing documentation for this feature.
</p>
</dd>
<dt><samp>--sort-xacts <var>VEXPR</var></samp>
<a name="index-_002d_002dsort_002dxacts-VEXPR"></a>
</dt>
<dt><samp>--period-sort <var>VEXPR</var></samp>
<a name="index-_002d_002dperiod_002dsort-VEXPR-2"></a>
</dt>
<dd><p>Sort the postings within transactions using the given value expression.
</p>
</dd>
<dt><samp>--start-of-week <var>INT</var></samp>
<a name="index-_002d_002dstart_002dof_002dweek-INT"></a>
</dt>
<dd><p>Tell ledger to use a particular day of the week to start its &ldquo;weekly&rdquo;
summary.  &lsquo;<samp>--start-of-week=1</samp>&rsquo; specifies Monday as the start of the
week.
</p>
</dd>
<dt><samp>--subtotal</samp>
<a name="index-_002d_002dsubtotal-4"></a>
</dt>
<dt><samp>-s</samp>
<a name="index-_002ds-2"></a>
</dt>
<dd><p>Cause all transactions in a <code>register</code> report to be collapsed
into a single, subtotaled transaction.
</p>
</dd>
<dt><samp>--tail <var>INT</var></samp>
<a name="index-_002d_002dtail-INT-1"></a>
</dt>
<dt><samp>--last <var>INT</var></samp>
<a name="index-_002d_002dlast-INT"></a>
</dt>
<dd><p>Report only the last <var>INT</var> entries.  Only useful in
a <code>register</code> report.
</p>
</dd>
<dt><samp>--time-report</samp>
<a name="index-_002d_002dtime_002dreport"></a>
</dt>
<dd><p>Add two columns to the balance report to show the earliest checkin and
checkout times for timelog entries.
</p>
</dd>
<dt><samp>--total <var>VEXPR</var></samp>
<a name="index-_002d_002dtotal-VEXPR-1"></a>
</dt>
<dt><samp>-T <var>VEXPR</var></samp>
<a name="index-_002dT-VEXPR-1"></a>
</dt>
<dd><p>Define a value expression used to calculate the total in reports.
</p>
</dd>
<dt><samp>--total-data</samp>
<a name="index-_002d_002dtotal_002ddata-3"></a>
</dt>
<dt><samp>-J</samp>
<a name="index-_002dJ-1"></a>
</dt>
<dd><p>Show only dates and totals to format the output for plots.
</p>
</dd>
<dt><samp>--total-width <var>INT</var></samp>
<a name="index-_002d_002dtotal_002dwidth-INT"></a>
</dt>
<dd><p>Set the width of the total field in the register report.
</p>
</dd>
<dt><samp>--truncate <var>CODE</var></samp>
<a name="index-_002d_002dtruncate-CODE"></a>
</dt>
<dd><p>Indicates how truncation should happen when the contents of columns
exceed their width.  Valid arguments are &lsquo;<samp>leading</samp>&rsquo;, &lsquo;<samp>middle</samp>&rsquo;,
and &lsquo;<samp>trailing</samp>&rsquo;.  The default is smarter than any of these three,
as it considers sub-names within the account name (that style is
called &ldquo;abbreviate&rdquo;).
</p>
</dd>
<dt><samp>--unbudgeted</samp>
<a name="index-_002d_002dunbudgeted-1"></a>
</dt>
<dd><p>Show only unbudgeted postings.
</p>
</dd>
<dt><samp>--uncleared</samp>
<a name="index-_002d_002duncleared-2"></a>
</dt>
<dt><samp>-U</samp>
<a name="index-_002dU-1"></a>
</dt>
<dd><p>Use only uncleared transactions in calculations and reports.
</p>
</dd>
<dt><samp>--unrealized</samp>
<a name="index-_002d_002dunrealized"></a>
</dt>
<dd><p>Show generated unrealized gain and loss accounts in the balance
report.
</p>
</dd>
<dt><samp>--unrealized-gains <var>STR</var></samp>
<a name="index-_002d_002dunrealized_002dgains-STR"></a>
</dt>
<dd><p>Allow the user to specify what account name should be used for
unrealized gains.  Defaults to &lsquo;<samp>&quot;Equity:Unrealized Gains&quot;</samp>&rsquo;.
Often set in one&rsquo;s <samp>~/.ledgerrc</samp> file to change the default.
</p>
</dd>
<dt><samp>--unrealized-losses <var>STR</var></samp>
<a name="index-_002d_002dunrealized_002dlosses-STR"></a>
</dt>
<dd><p>Allow the user to specify what account name should be used for
unrealized losses.  Defaults to &lsquo;<samp>&quot;Equity:Unrealized Losses&quot;</samp>&rsquo;.
Often set in one&rsquo;s <samp>~/.ledgerrc</samp> file to change the default.
</p>
</dd>
<dt><samp>--unround</samp>
<a name="index-_002d_002dunround"></a>
</dt>
<dd><p>Perform all calculations without rounding and display results to full
precision.
</p>
</dd>
<dt><samp>--values</samp>
<a name="index-_002d_002dvalues-1"></a>
</dt>
<dd><p>Shows the values used by each tag when used in combination with the
<code>tags</code> command.
</p>
</dd>
<dt><samp>--weekly</samp>
<a name="index-_002d_002dweekly-2"></a>
</dt>
<dt><samp>-W</samp>
<a name="index-_002dW-2"></a>
</dt>
<dd><p>Synonym for &lsquo;<samp>--period &quot;weekly&quot;</samp>&rsquo;.
</p>
</dd>
<dt><samp>--wide</samp>
<a name="index-_002d_002dwide-1"></a>
</dt>
<dd><p>Let the register report use 132 columns instead of 80 (the default).
Identical to &lsquo;<samp>--columns &quot;132&quot;</samp>&rsquo;.
</p>
</dd>
<dt><samp>--yearly</samp>
<a name="index-_002d_002dyearly-2"></a>
</dt>
<dt><samp>-Y</samp>
<a name="index-_002dY-2"></a>
</dt>
<dd><p>Synonym for &lsquo;<samp>--period &quot;yearly&quot;</samp>&rsquo;.
</p>
</dd>
</dl>

<hr>
<a name="Basic-options"></a>
<div class="header">
<p>
Next: <a href="#Report-filtering" accesskey="n" rel="next">Report filtering</a>, Previous: <a href="#Report-Options" accesskey="p" rel="prev">Report Options</a>, Up: <a href="#Detailed-Option-Description" accesskey="u" rel="up">Detailed Option Description</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Basic-options-1"></a>
<h4 class="subsection">8.3.4 Basic options</h4>

<p>These are the most basic command options.  Most likely, the user will
want to set them using environment variables (see <a href="#Environment-variables">Environment variables</a>), instead of using actual command-line options:
</p>
<dl compact="compact">
<dt><samp>--help</samp>
<a name="index-_002d_002dhelp-2"></a>
</dt>
<dt><samp>-h</samp>
<a name="index-_002dh-2"></a>
</dt>
<dd><p>Display the man page for <samp>ledger</samp>.
</p>
</dd>
<dt><samp>--version</samp>
<a name="index-_002d_002dversion-2"></a>
</dt>
<dd><p>Print the current version of ledger and exits.  This is useful for
sending bug reports, to let the author know which version of ledger you
are using.
</p>
</dd>
<dt><samp>--file <var>FILE</var></samp>
<a name="index-_002d_002dfile-FILE-2"></a>
</dt>
<dt><samp>-f <var>FILE</var></samp>
<a name="index-_002df-FILE-2"></a>
</dt>
<dd><p>Read <samp>FILE</samp> as a ledger file.  <var>FILE</var> can be &lsquo;<samp>-</samp>&rsquo; which is
a synonym for &lsquo;<samp>/dev/stdin</samp>&rsquo;.  This command may be used multiple
times.  Typically, the environment variable <code>LEDGER_FILE</code> is set,
rather than using this command-line option.
</p>
</dd>
<dt><samp>--output <var>FILE</var></samp>
<a name="index-_002d_002doutput-FILE-2"></a>
</dt>
<dt><samp>-o <var>FILE</var></samp>
<a name="index-_002do-FILE-1"></a>
</dt>
<dd><p>Redirect output from any command to <samp>FILE</samp>.  By default, all output
goes to standard output.
</p>
</dd>
<dt><samp>--init-file <var>FILE</var></samp>
<a name="index-_002d_002dinit_002dfile-FILE-2"></a>
</dt>
<dt><samp>-i <var>FILE</var></samp>
<a name="index-_002di-FILE-1"></a>
</dt>
<dd><p>Causes <samp>FILE</samp> to be read by ledger before any other ledger file.
This file may not contain any postings, but it may contain option
settings.  To specify options in the init file, use the same syntax as
on the command-line, but put each option on its own line.  Here is an
example init file:
</p>
<div class="smallexample">
<pre class="smallexample">--price-db ~/finance/.pricedb
--wide
; ~/.ledgerrc ends here
</pre></div>

<p>Option settings on the command-line or in the environment always take
precedence over settings in the init file.
</p>
</dd>
<dt><samp>--account <var>STR</var></samp>
<a name="index-_002d_002daccount-STR-3"></a>
</dt>
<dt><samp>-a <var>STR</var></samp>
<a name="index-_002da-STR-1"></a>
</dt>
<dd><p>Specify the default account which QIF file postings are assumed to
relate to.
</p>
</dd>
</dl>

<hr>
<a name="Report-filtering"></a>
<div class="header">
<p>
Next: <a href="#Output-customization" accesskey="n" rel="next">Output customization</a>, Previous: <a href="#Basic-options" accesskey="p" rel="prev">Basic options</a>, Up: <a href="#Detailed-Option-Description" accesskey="u" rel="up">Detailed Option Description</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Report-filtering-1"></a>
<h4 class="subsection">8.3.5 Report filtering</h4>

<p>These options change which postings affect the outcome of a
report, in ways other than just using regular expressions:
</p>
<dl compact="compact">
<dt><samp>--current</samp>
<a name="index-_002d_002dcurrent-2"></a>
</dt>
<dt><samp>-c</samp>
<a name="index-_002dc-1"></a>
</dt>
<dd><p>Display only transactions occurring on or before the current date.
</p>
</dd>
<dt><samp>--begin <var>DATE</var></samp>
<a name="index-_002d_002dbegin-DATE-2"></a>
</dt>
<dt><samp>-b <var>DATE</var></samp>
<a name="index-_002db-DATE-1"></a>
</dt>
<dd><p>Constrain the report to transactions on or after <var>DATE</var>.  Only
transactions after that date will be calculated, which means that the
running total in the balance report will always start at zero with the
first matching transaction.  (Note: This is different from using
<samp>--display <var>EXPR</var></samp> to constrain what is displayed).
</p>
</dd>
<dt><samp>--end <var>DATE</var></samp>
<a name="index-_002d_002dend-DATE-2"></a>
</dt>
<dt><samp>-e <var>DATE</var></samp>
<a name="index-_002de-DATE-1"></a>
</dt>
<dd><p>Constrain the report so that transactions on or after <var>DATE</var> are
not considered.
</p>
</dd>
<dt><samp>--period <var>PERIOD_EXPRESSION</var></samp>
<a name="index-_002d_002dperiod-PERIOD_005fEXPRESSION-2"></a>
</dt>
<dt><samp>-p <var>PERIOD_EXPRESSION</var></samp>
<a name="index-_002dp-PERIOD_005fEXPRESSION-1"></a>
</dt>
<dd><p>Set the reporting period to <var>STR</var>.  This will subtotal all matching
transactions within each period separately, making it easy to see
weekly, monthly, quarterly, etc., posting totals.  A period string can
even specify the beginning and end of the report range, using simple
terms like &lsquo;<samp>last June</samp>&rsquo; or &lsquo;<samp>next month</samp>&rsquo;.  For more details on
period expressions, see <a href="#Period-Expressions">Period Expressions</a>.
</p>
</dd>
<dt><samp>--period-sort <var>VEXPR</var></samp>
<a name="index-_002d_002dperiod_002dsort-VEXPR-3"></a>
</dt>
<dd><p>Sort the postings within each reporting period using the value
expression <var>EXPR</var>.  This is most often useful when reporting
monthly expenses, in order to view the highest expense categories at
the top of each month:
</p>
<div class="smallexample">
<pre class="smallexample">$ ledger -M --period-sort total reg ^Expenses
</pre></div>

</dd>
<dt><samp>--cleared</samp>
<a name="index-_002d_002dcleared-3"></a>
</dt>
<dt><samp>-C</samp>
<a name="index-_002dC-2"></a>
</dt>
<dd><p>Display only postings whose transaction has been marked &ldquo;cleared&rdquo;
(by placing an asterisk to the right of the date).
</p>
</dd>
<dt><samp>--uncleared</samp>
<a name="index-_002d_002duncleared-3"></a>
</dt>
<dt><samp>-U</samp>
<a name="index-_002dU-2"></a>
</dt>
<dd><p>Display only postings whose transaction has not been marked &ldquo;cleared&rdquo;
(i.e., if there is no asterisk to the right of the date).
</p>
</dd>
<dt><samp>--real</samp>
<a name="index-_002d_002dreal-4"></a>
</dt>
<dt><samp>-R</samp>
<a name="index-_002dR-2"></a>
</dt>
<dd><p>Display only real postings, not virtual.  (A virtual posting is
indicated by surrounding the account name with parentheses or brackets;
see <a href="#Virtual-postings">Virtual postings</a> for more information).
</p>
</dd>
<dt><samp>--actual</samp>
<a name="index-_002d_002dactual-2"></a>
</dt>
<dt><samp>-L</samp>
<a name="index-_002dL-2"></a>
</dt>
<dd><p>Display only actual postings, and not those created by automated
transactions.
</p>
</dd>
<dt><samp>--related</samp>
<a name="index-_002d_002drelated-3"></a>
</dt>
<dt><samp>-r</samp>
<a name="index-_002dr-1"></a>
</dt>
<dd><p>Display postings that are related to whichever postings would
otherwise have matched the filtering criteria.  In the register
report, this shows where money went to, or the account it came from.
In the balance report, it shows all the accounts affected by
transactions having a related posting.  For example, if a file had
this transaction:
</p>
<div class="smallexample">
<pre class="smallexample">2004/03/20 Safeway
    Expenses:Food                       $65.00
    Expenses:Cash                       $20.00
    Assets:Checking                    $-85.00
</pre></div>

<p>And the register command was:
</p>
<div class="smallexample">
<pre class="smallexample">$ ledger -f example.dat -r register food
</pre></div>

<p>The following would be printed, showing the postings related to the
posting that matched:
</p>
<div class="smallexample">
<pre class="smallexample">04-Mar-20 Safeway               Expenses:Cash                $20.00       $20.00
                                Assets:Checking             $-85.00      $-65.00
</pre></div>

</dd>
<dt><samp>--budget</samp>
<a name="index-_002d_002dbudget-3"></a>
</dt>
<dd><p>Useful for displaying how close your postings meet your budget.
<samp>--add-budget</samp> also shows unbudgeted postings, while
<samp>--unbudgeted</samp> shows only those.  <samp>--forecast <var>VEXPR</var></samp>
is a related option that projects your budget into the future, showing
how it will affect future balances.  See <a href="#Budgeting-and-Forecasting">Budgeting and Forecasting</a>.
</p>
</dd>
<dt><samp>--limit <var>EXPR</var></samp>
<a name="index-_002d_002dlimit-EXPR-4"></a>
</dt>
<dt><samp>-l <var>EXPR</var></samp>
<a name="index-_002dl-EXPR-2"></a>
</dt>
<dd><p>Limit which postings take part in the calculations of a report.
</p>
</dd>
<dt><samp>--amount <var>EXPR</var></samp>
<a name="index-_002d_002damount-EXPR-2"></a>
</dt>
<dt><samp>-t <var>EXPR</var></samp>
<a name="index-_002dt-EXPR-2"></a>
</dt>
<dd><p>Change the value expression used to calculate the &ldquo;value&rdquo; column in
the <code>register</code> report, the amount used to calculate account
totals in the <code>balance</code> report, and the values printed in the
<code>equity</code> report.  See <a href="#Value-Expressions">Value Expressions</a>.
</p>
</dd>
<dt><samp>--total <var>VEXPR</var></samp>
<a name="index-_002d_002dtotal-VEXPR-2"></a>
</dt>
<dt><samp>-T <var>VEXPR</var></samp>
<a name="index-_002dT-VEXPR-2"></a>
</dt>
<dd><p>Set the value expression used for the &ldquo;totals&rdquo; column in the
<code>register</code> and <code>balance</code> reports.
</p>
</dd>
</dl>







<hr>
<a name="Output-customization"></a>
<div class="header">
<p>
Next: <a href="#Commodity-reporting" accesskey="n" rel="next">Commodity reporting</a>, Previous: <a href="#Report-filtering" accesskey="p" rel="prev">Report filtering</a>, Up: <a href="#Detailed-Option-Description" accesskey="u" rel="up">Detailed Option Description</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Output-customization-1"></a>
<h4 class="subsection">8.3.6 Output customization</h4>

<p>These options affect only the output, but not which postings are
used to create it:
</p>
<dl compact="compact">
<dt><samp>--collapse</samp>
<a name="index-_002d_002dcollapse-2"></a>
</dt>
<dt><samp>-n</samp>
<a name="index-_002dn-2"></a>
</dt>
<dd><p>Cause transactions in a <code>register</code> report with multiple
postings to be collapsed into a single, subtotaled transaction.
</p>
</dd>
<dt><samp>--subtotal</samp>
<a name="index-_002d_002dsubtotal-5"></a>
</dt>
<dt><samp>-s</samp>
<a name="index-_002ds-3"></a>
</dt>
<dd><p>Cause all transactions in a <code>register</code> report to be collapsed
into a single, subtotaled transaction.
</p>
</dd>
<dt><samp>--by-payee</samp>
<a name="index-_002d_002dby_002dpayee-5"></a>
</dt>
<dt><samp>-P</samp>
<a name="index-_002dP-3"></a>
</dt>
<dd><p>Report subtotals by payee.
</p>
</dd>
<dt><samp>--empty</samp>
<a name="index-_002d_002dempty-3"></a>
</dt>
<dt><samp>-E</samp>
<a name="index-_002dE-2"></a>
</dt>
<dd><p>Include even empty accounts in the <code>balance</code> report.
</p>
</dd>
<dt><samp>--weekly</samp>
<a name="index-_002d_002dweekly-3"></a>
</dt>
<dt><samp>-W</samp>
<a name="index-_002dW-3"></a>
</dt>
<dd><p>Report posting totals by the week.  The week begins on whichever day of
the week begins the month containing that posting.  To set a specific
begin date, use a period string, such as &lsquo;<samp>weekly from DATE</samp>&rsquo;.
</p>
</dd>
<dt><samp>--monthly</samp>
<a name="index-_002d_002dmonthly-4"></a>
</dt>
<dt><samp>-M</samp>
<a name="index-_002dM-2"></a>
</dt>
<dd><p>Report posting totals by month.
</p>
</dd>
<dt><samp>--yearly</samp>
<a name="index-_002d_002dyearly-3"></a>
</dt>
<dt><samp>-Y</samp>
<a name="index-_002dY-3"></a>
</dt>
<dd><p>Report posting totals by year.  For more complex periods, use
<samp>--period</samp>.
</p>
</dd>
<dt><samp>--period <var>PERIOD_EXPRESSION</var></samp>
<a name="index-_002d_002dperiod-PERIOD_005fEXPRESSION-3"></a>
</dt>
<dd><p>Option described above.
</p>
</dd>
<dt><samp>--dow</samp>
<a name="index-_002d_002ddow-3"></a>
</dt>
<dd><p>Report posting totals for each day of the week.  This is an easy way
to see if weekend spending is more than on weekdays.
</p>
</dd>
<dt><samp>--sort <var>VEXPR</var></samp>
<a name="index-_002d_002dsort-VEXPR-2"></a>
</dt>
<dt><samp>-S <var>VEXPR</var></samp>
<a name="index-_002dS-VEXPR-2"></a>
</dt>
<dd><p>Sort a report by comparing the values determined using the value
expression <var>VEXPR</var>.  For example, using &lsquo;<samp>-S &quot;-abs(total)&quot;</samp>&rsquo; in
the <code>balance</code> report will sort account balances from greatest to
least, using the absolute value of the total.  For more on how to use
value expressions, see <a href="#Value-Expressions">Value Expressions</a>.
</p>
</dd>
<dt><samp>--pivot <var>TAG</var></samp>
<a name="index-_002d_002dpivot-TAG-2"></a>
</dt>
<dd><p>Produce a pivot table around the <var>TAG</var> provided.  This requires
meta data using valued tags.
</p>
</dd>
<dt><samp>--wide</samp>
<a name="index-_002d_002dwide-2"></a>
</dt>
<dt><samp>-w</samp>
<a name="index-_002dw-1"></a>
</dt>
<dd><p>Cause the default <code>register</code> report to assume 132 columns
instead of 80.
</p>
</dd>
<dt><samp>--head <var>INT</var></samp>
<a name="index-_002d_002dhead-INT-2"></a>
</dt>
<dd><p>Cause only the first <var>INT</var> transactions to be printed.  This is
different from using the command-line utility <samp>head</samp>, which would
limit to the first <var>INT</var> postings.  <samp>--tail <var>INT</var></samp> outputs
only the last <var>INT</var> transactions.  Both options may be used
simultaneously.  If a negative amount is given, it will invert the
meaning of the flag (instead of the first five transactions being
printed, for example, it would print all but the first five).
</p>
</dd>
<dt><samp>--pager <var>FILE</var></samp>
<a name="index-_002d_002dpager-FILE-2"></a>
</dt>
<dd><p>Tell Ledger to pass its output to the given <var>FILE</var> pager program;
very useful when the output is especially long.  This behavior can be
made the default by setting the <code>LEDGER_PAGER</code> environment variable.
</p>
</dd>
<dt><samp>--no-pager</samp>
<a name="index-_002d_002dno_002dpager-2"></a>
</dt>
<dd><p>Tell Ledger to <em>not</em> pass its output to a pager program; useful
when a pager is set by default.
</p>
</dd>
<dt><samp>--average</samp>
<a name="index-_002d_002daverage-3"></a>
</dt>
<dt><samp>-A</samp>
<a name="index-_002dA-2"></a>
</dt>
<dd><p>Report the average posting value.
</p>
</dd>
<dt><samp>--deviation</samp>
<a name="index-_002d_002ddeviation-2"></a>
</dt>
<dt><samp>-D</samp>
<a name="index-_002dD-3"></a>
</dt>
<dd><p>Report each posting&rsquo;s deviation from the average.  It is only meaningful
in the <code>register</code> and <code>prices</code> reports.
</p>
</dd>
<dt><samp>--percent</samp>
<a name="index-_002d_002dpercent-2"></a>
</dt>
<dt><samp>-%</samp>
<a name="index-_002d_0025-2"></a>
</dt>
<dd><p>Show account subtotals in the <code>balance</code> report as percentages of
the parent account.
</p>

</dd>
<dt><samp>--amount-data</samp>
<a name="index-_002d_002damount_002ddata-4"></a>
</dt>
<dt><samp>-j</samp>
<a name="index-_002dj-2"></a>
</dt>
<dd><p>Change the <code>register</code> report so that it prints nothing but the
date and the value column, and the latter without commodities.  This is
only meaningful if the report uses a single commodity.  This data can
then be fed to other programs, which could plot the date, analyze it,
etc.
</p>
</dd>
<dt><samp>--total-data</samp>
<a name="index-_002d_002dtotal_002ddata-4"></a>
</dt>
<dt><samp>-J</samp>
<a name="index-_002dJ-2"></a>
</dt>
<dd><p>Change the <code>register</code> report so that it prints nothing but the
date and total columns, without commodities.
</p>
</dd>
<dt><samp>--display <var>EXPR</var></samp>
<a name="index-_002d_002ddisplay-EXPR-4"></a>
</dt>
<dt><samp>-d <var>EXPR</var></samp>
<a name="index-_002dd-EXPR-1"></a>
</dt>
<dd><p>Limit which postings or accounts are actually displayed in a report.
They might still be calculated, and be part of the running total of a
register report, for example, but they will not be displayed.  This is
useful for seeing last month&rsquo;s checking postings, against a running
balance which includes all posting values:
</p>
<div class="smallexample">
<pre class="smallexample">$ ledger -d &quot;d&gt;=[last month]&quot; reg checking
</pre></div>

<p>The output from this command is very different from the following,
whose running total includes only postings from the last month
onward:
</p>
<div class="smallexample">
<pre class="smallexample">$ ledger -p &quot;last month&quot; reg checking
</pre></div>

<p>Which is more useful depends on what you&rsquo;re looking to know: the total
amount for the reporting range (using <samp>--period
<var>PERIOD_EXPRESSION</var> (-p)</samp>), or simply a display restricted to the
reporting range (using <samp>--display <var>EXPR</var> (-d)</samp>).
</p>
</dd>
<dt><samp>--date-format <var>DATE_FORMAT</var></samp>
<a name="index-_002d_002ddate_002dformat-DATE_005fFORMAT-2"></a>
</dt>
<dt><samp>-y <var>DATE_FORMAT</var></samp>
<a name="index-_002dy-DATE_005fFORMAT-2"></a>
</dt>
<dd><p>Change the basic date format used by reports.  The default uses a date
like &lsquo;<samp>2004/08/01</samp>&rsquo;, which represents the default date format of
<code>%Y/%m/%d</code>.  To change the way dates are printed in general, the
easiest way is to put <samp>--date-format <var>DATE_FORMAT</var></samp> in the
Ledger initialization file <samp>~/.ledgerrc</samp> (or the file referred to
by <code>LEDGER_INIT</code>).
</p>
</dd>
<dt><samp>--format <var>FORMAT_STRING</var></samp>
<a name="index-_002d_002dformat-FORMAT_005fSTRING-2"></a>
</dt>
<dt><samp>-F <var>FORMAT_STRING</var></samp>
<a name="index-_002dF-FORMAT_005fSTRING-2"></a>
</dt>
<dd><p>Set the reporting format for whatever report ledger is about to make.
See <a href="#Format-Strings">Format Strings</a>.  There are also specific format commands for
each report type:
</p>
</dd>
<dt><samp>--balance-format <var>FORMAT_STRING</var></samp>
<a name="index-_002d_002dbalance_002dformat-FORMAT_005fSTRING-2"></a>
</dt>
<dd><p>Define the output format for the <code>balance</code> report.  The default
(defined in <samp>report.h</samp> is:
</p>
<div class="smallexample">
<pre class="smallexample">&quot;%(ansify_if(
        justify(scrub(display_total), 20,
                20 + int(prepend_width), true, color),
                  bold if should_bold))
        %(!options.flat ? depth_spacer : \&quot;\&quot;)
      %-(ansify_if(
         ansify_if(partial_account(options.flat), blue if color),
                   bold if should_bold))\n%/
      %$1\n%/
      %(prepend_width ? \&quot; \&quot; * int(prepend_width) : \&quot;\&quot;)
      --------------------\n&quot;
</pre></div>

</dd>
<dt><samp>--cleared-format <var>FORMAT_STRING</var></samp>
<a name="index-_002d_002dcleared_002dformat-FORMAT_005fSTRING-1"></a>
</dt>
<dd><p>Define the format for the cleared report.  The default is:
</p>
<div class="smallexample">
<pre class="smallexample">&quot;%(justify(scrub(get_at(display_total, 0)), 16, 16 + int(prepend_width),
       true, color))  %(justify(scrub(get_at(display_total, 1)), 18,
       36 + int(prepend_width), true, color))
          %(latest_cleared ? format_date(latest_cleared) : \&quot;         \&quot;)
          %(!options.flat ? depth_spacer : \&quot;\&quot;)
      %-(ansify_if(partial_account(options.flat), blue if color))\n%/
      %$1  %$2    %$3\n%/
      %(prepend_width ? \&quot; \&quot; * int(prepend_width) : \&quot;\&quot;)
      ----------------    ----------------    ---------\n&quot;
</pre></div>

</dd>
<dt><samp>--register-format <var>FORMAT_STRING</var></samp>
<a name="index-_002d_002dregister_002dformat-FORMAT_005fSTRING-2"></a>
</dt>
<dd><p>Define the output format for the <code>register</code> report.  The default
(defined in <samp>report.h</samp> is:
</p>
<div class="smallexample">
<pre class="smallexample">&quot;%(ansify_if(
        ansify_if(justify(format_date(date), int(date_width)),
                  green if color and date &gt; today),
                  bold if should_bold))
       %(ansify_if(
         ansify_if(justify(truncated(payee, int(payee_width)), int(payee_width)),
                   bold if color and !cleared and actual),
                   bold if should_bold))
       %(ansify_if(
         ansify_if(justify(truncated(display_account, int(account_width),
                                     int(abbrev_len)), int(account_width)),
                   blue if color),
                   bold if should_bold))
       %(ansify_if(
         justify(scrub(display_amount), int(amount_width),
                 3 + int(meta_width) + int(date_width) + int(payee_width)
                   + int(account_width) + int(amount_width) + int(prepend_width),
                 true, color),
                 bold if should_bold))
       %(ansify_if(
         justify(scrub(display_total), int(total_width),
                 4 + int(meta_width) + int(date_width) + int(payee_width)
                   + int(account_width) + int(amount_width) + int(total_width)
                   + int(prepend_width), true, color),
                 bold if should_bold))\n%/
      %(justify(\&quot; \&quot;, int(date_width)))
       %(ansify_if(
         justify(truncated(has_tag(\&quot;Payee\&quot;) ? payee : \&quot; \&quot;,
                           int(payee_width)), int(payee_width)),
                   bold if should_bold))
       %$3 %$4 %$5\n&quot;
</pre></div>

</dd>
<dt><samp>--csv-format <var>FORMAT_STRING</var></samp>
<a name="index-_002d_002dcsv_002dformat-FORMAT_005fSTRING-1"></a>
</dt>
<dd><p>Set the format for <code>csv</code> reports.  The default is:
</p>
<div class="smallexample">
<pre class="smallexample">&quot;%(quoted(date)),
 %(quoted(code)),
 %(quoted(payee)),
 %(quoted(display_account)),
 %(quoted(commodity(scrub(display_amount)))),
 %(quoted(quantity(scrub(display_amount)))),
 %(quoted(cleared ? \&quot;*\&quot; : (pending ? \&quot;!\&quot; : \&quot;\&quot;))),
 %(quoted(join(note | xact.note)))\n&quot;
</pre></div>

</dd>
<dt><samp>--plot-amount-format <var>FORMAT_STRING</var></samp>
<a name="index-_002d_002dplot_002damount_002dformat-FORMAT_005fSTRING-2"></a>
</dt>
<dd><p>Set the format for amount plots, using the <samp>--amount-data (-j)</samp>
option.  The default is:
</p>
<div class="smallexample">
<pre class="smallexample">&quot;%(format_date(date, \&quot;%Y-%m-%d\&quot;)) %(quantity(scrub(display_amount)))\n&quot;
</pre></div>

</dd>
<dt><samp>--plot-total-format <var>FORMAT_STRING</var></samp>
<a name="index-_002d_002dplot_002dtotal_002dformat-FORMAT_005fSTRING-2"></a>
</dt>
<dd><p>Set the format for total plots, using the <samp>--total-data (-J)</samp>
option.  The default is:
</p>
<div class="smallexample">
<pre class="smallexample">&quot;%(format_date(date, \&quot;%Y-%m-%d\&quot;)) %(quantity(scrub(display_total)))\n&quot;
</pre></div>

</dd>
<dt><samp>--pricedb-format <var>FORMAT_STRING</var></samp>
<a name="index-_002d_002dpricedb_002dformat-FORMAT_005fSTRING-1"></a>
</dt>
<dd><p>Set the format expected for the historical price file.  The default is:
</p>
<div class="smallexample">
<pre class="smallexample">&quot;P %(datetime) %(display_account) %(scrub(display_amount))\n&quot;
</pre></div>

</dd>
<dt><samp>--prices-format <var>FORMAT_STRING</var></samp>
<a name="index-_002d_002dprices_002dformat-FORMAT_005fSTRING-2"></a>
</dt>
<dd><p>Set the format for the <code>prices</code> report.  The default is:
</p>
<div class="smallexample">
<pre class="smallexample">&quot;%(date) %-8(display_account) %(justify(scrub(display_amount), 12,
           2 + 9 + 8 + 12, true, color))\n&quot;
</pre></div>

</dd>
</dl>

<hr>
<a name="Commodity-reporting"></a>
<div class="header">
<p>
Next: <a href="#Environment-variables" accesskey="n" rel="next">Environment variables</a>, Previous: <a href="#Output-customization" accesskey="p" rel="prev">Output customization</a>, Up: <a href="#Detailed-Option-Description" accesskey="u" rel="up">Detailed Option Description</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Commodity-reporting-1"></a>
<h4 class="subsection">8.3.7 Commodity reporting</h4>

<p>These options affect how commodity values are displayed:
</p>
<dl compact="compact">
<dt><samp>--price-db <var>FILE</var></samp>
<a name="index-_002d_002dprice_002ddb-FILE-3"></a>
</dt>
<dd><p>Set the file that is used for recording downloaded commodity prices.
It is always read on startup, to determine historical prices.  Other
settings can be placed in this file manually, to prevent downloading
quotes for a specific commodity, for example.  This is done by adding a
line like the following:
</p>
<div class="smallexample">
<pre class="smallexample">; Don't download quotes for the dollar, or timelog values
N $
N h
</pre></div>

<p>Note: Ledger NEVER writes output to files.  You are responsible for
updating the price-db file.  The best way is to have your price
download script maintain this file.
</p>
<p>The format of the file can be changed by telling ledger to use the
<samp>--pricedb-format <var>FORMAT_STRING</var></samp> you define.
</p>
</dd>
<dt><samp>--price-exp <var>INT</var></samp>
<a name="index-_002d_002dprice_002dexp-INT-2"></a>
</dt>
<dt><samp>--leeway <var>INT</var></samp>
<a name="index-_002d_002dleeway-INT-2"></a>
</dt>
<dt><samp>-Z <var>INT</var></samp>
<a name="index-_002dZ-INT-2"></a>
</dt>
<dd><p>Set the expected freshness of price quotes, in <var>INT</var> minutes.  That
is, if the last known quote for any commodity is older than this value,
and if <samp>--download</samp> is being used, then the Internet will be
consulted again for a newer price.  Otherwise, the old price is still
considered to be fresh enough.
</p>
</dd>
<dt><samp>--download</samp>
<a name="index-_002d_002ddownload-3"></a>
</dt>
<dt><samp>-Q</samp>
<a name="index-_002dQ-2"></a>
</dt>
<dd><p>Cause quotes to be automagically downloaded, as needed, by running
a script named <samp>getquote</samp> and expecting that script to return
a value understood by ledger.  A sample implementation of
a <samp>getquote</samp> script, implemented in Perl, is provided in the
distribution.  Downloaded quote price are then appended to the price
database, usually specified using the environment variable
<code>LEDGER_PRICE_DB</code>.
</p>
</dd>
</dl>

<p>There are several different ways that ledger can report the totals it
displays.  The most flexible way to adjust them is by using value
expressions, and the <samp>--amount <var>EXPR</var> (-t)</samp> and
<samp>--total <var>VEXPR</var> (-T)</samp> options.  However, there are also
several &ldquo;default&rdquo; reports, which will satisfy most users&rsquo; basic
reporting needs:
</p>
<dl compact="compact">
<dt><samp>--quantity</samp>
<a name="index-_002d_002dquantity-2"></a>
</dt>
<dt><samp>-O</samp>
<a name="index-_002dO-2"></a>
</dt>
<dd><p>Report commodity totals (this is the default).
</p>
</dd>
<dt><samp>--basis</samp>
<a name="index-_002d_002dbasis-2"></a>
</dt>
<dt><samp>-B</samp>
<a name="index-_002dB-2"></a>
</dt>
<dd><p>Report the cost basis for all postings.
</p>
</dd>
<dt><samp>--market</samp>
<a name="index-_002d_002dmarket-5"></a>
</dt>
<dt><samp>-V</samp>
<a name="index-_002dV-2"></a>
</dt>
<dd><p>Use the last known value for commodities to calculate final values.
</p>
</dd>
<dt><samp>--gain</samp>
<a name="index-_002d_002dgain-2"></a>
</dt>
<dt><samp>-G</samp>
<a name="index-_002dG-2"></a>
</dt>
<dd><p>Report the net gain/loss for all commodities in the report that have
a price history.
</p>
</dd>
</dl>

<p>Often you will be more interested in the value of your entire holdings,
in your preferred currency.  It might be nice to know you hold 10,000
shares of PENNY, but you are more interested in whether or not that is
worth $1000.00 or $10,000.00.  However, the current day value of a
commodity can mean different things to different people, depending on
the accounts involved, the commodities, the nature of the transactions,
etc.
</p>
<a name="index-_002d_002dnow-DATE-1"></a>
<a name="index-_002d_002dmarket-6"></a>
<a name="index-_002d_002dexchange-COMMODITY-3"></a>

<p>When you specify <samp>--market (-V)</samp>, or <samp>--exchange
<var>COMMODITY</var> (-X)</samp>, you are requesting that some or all of the
commodities be valuated as of today (or whatever <samp>--now
<var>DATE</var></samp> is set to).  But what does such a valuation mean? This
meaning is governed by the presence of a <var>VALUE</var> meta-data property,
whose content is an expression used to compute that value.
</p>
<p>If no <var>VALUE</var> property is specified, each posting is assumed to have
a default, as if you&rsquo;d specified a global, automated transaction as
follows:
</p>
<div class="smallexample">
<pre class="smallexample">= expr true
    ; VALUE:: market(amount, date, exchange)
</pre></div>

<p>This definition emulates the present day behavior of <samp>--market
(-V)</samp> and <samp>--exchange <var>COMMODITY</var> (-X)</samp> (in the case of
&lsquo;<samp>-X</samp>&rsquo;, the requested commodity is passed via the string
&lsquo;<samp>exchange</samp>&rsquo; above).
</p>
<a name="index-Euro-conversion"></a>
<p>One thing many people have wanted to do is to fixate the valuation of
old European currencies in terms of the Euro after a certain date:
</p>
<div class="smallexample">
<pre class="smallexample">= expr commodity == &quot;DM&quot;
    ; VALUE:: date &lt; [Jun 2008] ? market(amount, date, exchange) : 1.44 EUR
</pre></div>

<p>This says: If <samp>--now <var>DATE</var></samp> is some old date, use market
prices as they were at that time; but if <samp>--now <var>DATE</var></samp> is
past June 2008, use a fixed price for converting Deutsch Mark to Euro.
</p>
<p>Or how about never re-valuating commodities used in Expenses, since
they cannot have a different future value:
</p>
<div class="smallexample">
<pre class="smallexample">= /^Expenses:/
    ; VALUE:: market(amount, post.date, exchange)
</pre></div>

<p>This says the future valuation is the same as the valuation at the time
of posting.  <code>post.date</code> equals the posting&rsquo;s date, while just &rsquo;date&rsquo; is
the value of <samp>--now <var>DATE</var></samp> (defaults to today).
</p>
<p>Or how about valuating miles based on a reimbursement rate during a
specific time period:
</p>
<div class="smallexample">
<pre class="smallexample">= expr commodity == &quot;miles&quot; and date &gt;= [2007] and date &lt; [2008]
    ; VALUE:: market($1.05, date, exchange)
</pre></div>

<p>In this case, miles driven in 2007 will always be valuated at $1.05
each.  If you use &lsquo;<samp>-X EUR</samp>&rsquo; to expressly request all amounts in
Euro, Ledger shall convert $1.05 to Euro by whatever means are
appropriate for dollars.
</p>
<p>Note that you can have a valuation expression specific to a particular
posting or transaction, by overriding these general defaults using
specific meta-data:
</p>
<div class="smallexample">
<pre class="smallexample">2010-12-26 Example
    Expenses:Food                $20
    ; Just to be silly, always valuate *these* $20 as 30 DM, no matter what
    ; the user asks for with -V or -X
    ; VALUE:: 30 DM
    Assets:Cash
</pre></div>

<p>This example demonstrates that your value expression should be as
symbolic as possible, using terms like &rsquo;amount&rsquo; and &rsquo;date&rsquo;, rather than
specific amounts and dates.  Also, you should pass the amount along to
the function &rsquo;market&rsquo; so it can be further revalued if the user has
asked for a specific currency.
</p>
<p>Or, if it better suits your accounting, you can be less symbolic,
which allows you to report most everything in EUR if you use &lsquo;<samp>-X
EUR</samp>&rsquo;, except for certain accounts or postings which should always be
valuated in another currency.  For example:
</p>
<div class="smallexample">
<pre class="smallexample">= /^Assets:Brokerage:CAD$/
    ; Always report the value of commodities in this account in
    ; terms of present day dollars, despite what was asked for
    ; on the command-line VALUE:: market(amount, date, &lsquo;<samp>$</samp>&rsquo;)
</pre></div>

<a name="index-FIFO_002fLIFO"></a>
<a name="index-LIFO_002fFIFO"></a>
<a name="index-_002d_002dlots-2"></a>
<a name="index-_002d_002dlot_002dprices-2"></a>
<a name="index-_002d_002dexchange-COMMODITY-4"></a>
<a name="index-_002d_002dhistorical-1"></a>
<a name="index-_002d_002dbasis-3"></a>
<a name="index-_002d_002dprice-1"></a>

<p>Ledger presently has no way of handling such things as FIFO and LIFO.
</p>
<p>If you specify an unadorned commodity name, like AAPL, it will balance
against itself.  If <samp>--lots</samp> are not being displayed, then it
will appear to balance against any lot of AAPL.
</p>
<a name="index-adorned-commodity"></a>
<a name="index-_002d_002dlot_002dprices-3"></a>
<p>If you specify an adorned commodity, like AAPL {$10.00}, it will also
balance against itself, and against any AAPL if <samp>--lots</samp> is not
specified.  But if you do specify <samp>--lot-prices</samp>, for example,
then it will balance against that specific price for AAPL.
</p>
<p>Normally when you use <samp>--exchange <var>COMMODITY</var> (-X)</samp> to
request that amounts be reported in a specific commodity, Ledger uses
these values:
</p>
<ul>
<li> Register Report
For the <code>register</code> report, use the value of that commodity on
the date of the posting being reported, with a &lsquo;<samp>&lt;Revalued&gt;</samp>&rsquo; posting
added at the end if today&rsquo;s value is different from the value of the
last posting.

</li><li> Balance Report
For the <code>balance</code> report, use the value of that commodity as of
today.

</li></ul>

<p>You can now specify <samp>--historical (-H)</samp> to ask that all
valuations for any amount be done relative to the date that amount was
encountered.
</p>
<p>You can also now use <samp>--exchange <var>COMMODITY</var> (-X)</samp> (and
<samp>--historical (-H)</samp>) in conjunction with <samp>--basis (-B)</samp>
and <samp>--price (-I)</samp>, to see valuation reports of just your basis
costs or lot prices.
</p>
<p>Finally, sometimes, you may seek to only report one (or some subset) of
the commodities in terms of another commodity.  In this situation, you
can use the syntax <samp>--exchange <var>COMMODITY1</var>:<var>COMMODITY2</var></samp>
to request that ledger always display <var>COMMODITY1</var> in terms of
<var>COMMODITY2</var>, but you want no other commodities to be automatically
displayed in terms of <var>COMMODITY2</var> without additional
<samp>--exchange</samp> options.  For example, if you wanted to report EUR
and BTC in terms of USD, but report all other commodities without
conversion to USD, you could use: <samp>--exchange EUR:USD --exchange
BTC:USD</samp>.
</p>
<hr>
<a name="Environment-variables"></a>
<div class="header">
<p>
Previous: <a href="#Commodity-reporting" accesskey="p" rel="prev">Commodity reporting</a>, Up: <a href="#Detailed-Option-Description" accesskey="u" rel="up">Detailed Option Description</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Environment-variables-1"></a>
<h4 class="subsection">8.3.8 Environment variables</h4>

<p>Every option to ledger may be set using an environment variable if the
option has a long name.  For example setting the environment variable
&lsquo;<samp><code>LEDGER_DATE_FORMAT</code>=&quot;%d.%m.%Y&quot;</samp>&rsquo; will have the same effect as specifying
&lsquo;<samp><samp>--date-format</samp> '%d.%m.%Y'</samp>&rsquo; on the command-line.  Options on the
command-line always take precedence over environment variable settings, however.
</p>
<p>Note that you may also permanently specify option values by placing
option settings in the file <samp>~/.ledgerrc</samp> one option per line, for example:
</p>
<div class="smallexample">
<pre class="smallexample">--pager /bin/cat
</pre></div>

<hr>
<a name="Period-Expressions"></a>
<div class="header">
<p>
Previous: <a href="#Detailed-Option-Description" accesskey="p" rel="prev">Detailed Option Description</a>, Up: <a href="#Command_002dLine-Syntax" accesskey="u" rel="up">Command-Line Syntax</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Period-Expressions-1"></a>
<h3 class="section">8.4 Period Expressions</h3>

<p>A period expression indicates a span of time, or a reporting interval,
or both. Ledger&rsquo;s end dates are always exclusive, imagine the date is
followed by 00:00:00 time. They are instants in time not entire days.
The full syntax is:
</p>
<div class="smallexample">
<pre class="smallexample">[INTERVAL] [BEGIN] [END]
</pre></div>

<p>The optional <var>INTERVAL</var> part may be any one of:
</p>
<div class="smallexample">
<pre class="smallexample">every day
every week
every month
every quarter
every year
every N days     # N is any integer
every N weeks
every N months
every N quarters
every N years
daily
weekly
biweekly
monthly
bimonthly
quarterly
yearly
</pre></div>

<p>After the interval, a begin time, end time, both or neither may be
specified.  As for the begin time, it can be either of:
</p>
<div class="smallexample">
<pre class="smallexample">from &lt;SPEC&gt;
since &lt;SPEC&gt;
</pre></div>

<p>The end time can be either of:
</p>
<div class="smallexample">
<pre class="smallexample">to &lt;SPEC&gt;
until &lt;SPEC&gt;
</pre></div>

<p>Where <var>SPEC</var> can be any of:
</p>
<div class="smallexample">
<pre class="smallexample">2004
2004/10
2004/10/1
10/1
october
oct
this week  # or day, month, quarter, year
next week
last week
</pre></div>

<p>The beginning and ending can be given at the same time, if it spans a
single period.  In that case, just use <var>SPEC</var> by itself.  In that
case, the period &lsquo;<samp>oct</samp>&rsquo;, for example, will cover all the days in
October.  The possible forms are:
</p>
<div class="smallexample">
<pre class="smallexample">&lt;SPEC&gt;
in &lt;SPEC&gt;
</pre></div>

<p>Here are a few examples of period expressions:
</p>
<div class="smallexample">
<pre class="smallexample">monthly
monthly in 2004
weekly from oct
weekly from last month
from sep to oct
from 10/1 to 10/5
monthly until 2005
from apr
until nov
last oct
weekly last august
</pre></div>

<hr>
<a name="Budgeting-and-Forecasting"></a>
<div class="header">
<p>
Next: <a href="#Time-Keeping" accesskey="n" rel="next">Time Keeping</a>, Previous: <a href="#Command_002dLine-Syntax" accesskey="p" rel="prev">Command-Line Syntax</a>, Up: <a href="#Top" accesskey="u" rel="up">Top</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Budgeting-and-Forecasting-1"></a>
<h2 class="chapter">9 Budgeting and Forecasting</h2>

<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top">&bull; <a href="#Budgeting" accesskey="1">Budgeting</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Forecasting" accesskey="2">Forecasting</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
</table>

<hr>
<a name="Budgeting"></a>
<div class="header">
<p>
Next: <a href="#Forecasting" accesskey="n" rel="next">Forecasting</a>, Previous: <a href="#Budgeting-and-Forecasting" accesskey="p" rel="prev">Budgeting and Forecasting</a>, Up: <a href="#Budgeting-and-Forecasting" accesskey="u" rel="up">Budgeting and Forecasting</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Budgeting-1"></a>
<h3 class="section">9.1 Budgeting</h3>
<a name="index-_002d_002dbudget-4"></a>
<a name="index-_002d_002dadd_002dbudget-2"></a>
<a name="index-_002d_002dunbudgeted-2"></a>
<a name="index-_002d_002dmonthly-5"></a>

<p>Keeping a budget allows you to pay closer attention to your income and
expenses, by reporting how far your actual financial activity is from
your expectations.
</p>
<p>To start keeping a budget, put some periodic transactions
(see <a href="#Periodic-Transactions">Periodic Transactions</a>) at the top of your ledger file.  A
periodic transaction is almost identical to a regular transaction, except
that it begins with a tilde and has a period expression in place of a
payee.  For example:
</p>
<div class="smallexample">
<pre class="smallexample">~ Monthly
    Expenses:Rent               $500.00
    Expenses:Food               $450.00
    Expenses:Auto:Gas           $120.00
    Expenses:Insurance          $150.00
    Expenses:Phone              $125.00
    Expenses:Utilities          $100.00
    Expenses:Movies              $50.00
    Expenses                    $200.00  ; all other expenses
    Assets

~ Yearly
    Expenses:Auto:Repair        $500.00
    Assets
</pre></div>

<p>These two periodic transactions give the usual monthly expenses, as well
as one typical yearly expense.  For help on finding out what your
average monthly expenses are for any category, use a command like:
</p>
<div class="smallexample">
<pre class="smallexample">$ ledger -p &quot;this year&quot; --monthly --average balance ^expenses
</pre></div>

<p>The reported totals are the current year&rsquo;s average for each account.
</p>
<p>Once these periodic transactions are defined, creating a budget report is
as easy as adding <samp>--budget</samp> to the command-line.  For example,
a typical monthly expense report would be:
</p>
<div class="smallexample">
<pre class="smallexample">$ ledger --monthly register ^expenses
</pre></div>

<p>To see the same report balanced against your budget, use:
</p>
<div class="smallexample">
<pre class="smallexample">$ ledger --budget --monthly register ^expenses
</pre></div>

<p>A budget report includes only those accounts that appear in the budget.
To see all expenses balanced against the budget, use
<samp>--add-budget</samp>.  You can even see only the unbudgeted expenses
using <samp>--unbudgeted</samp>:
</p>
<div class="smallexample">
<pre class="smallexample">$ ledger --unbudgeted --monthly register ^expenses
</pre></div>

<p>You can also use these flags with the <code>balance</code> command.
</p>
<hr>
<a name="Forecasting"></a>
<div class="header">
<p>
Previous: <a href="#Budgeting" accesskey="p" rel="prev">Budgeting</a>, Up: <a href="#Budgeting-and-Forecasting" accesskey="u" rel="up">Budgeting and Forecasting</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Forecasting-1"></a>
<h3 class="section">9.2 Forecasting</h3>
<a name="index-_002d_002dforecast-VEXPR-2"></a>

<p>Sometimes it&rsquo;s useful to know what your finances will look like in the
future, such as determining when an account will reach zero.  Ledger
makes this easy to do, using the same periodic transactions as are used
for budgeting.  An example forecast report can be generated with:
</p>
<div class="smallexample">
<pre class="smallexample">$ ledger --file drewr3.dat --forecast &quot;T&gt;{\$-500.00}&quot; register ^assets ^liabilities
</pre></div>

<p>This report continues outputting postings until the running total
is greater than $-500.00.  A final posting is always shown, to
inform you what the total afterwards would be.
</p>
<p>Forecasting can also be used with the <code>balance</code> report,
but by date only, and not against the running total:
</p>
<div class="smallexample">
<pre class="smallexample">$ ledger --forecast &quot;d&lt;[2010]&quot; bal ^assets ^liabilities
</pre></div>

<hr>
<a name="Time-Keeping"></a>
<div class="header">
<p>
Next: <a href="#Value-Expressions" accesskey="n" rel="next">Value Expressions</a>, Previous: <a href="#Budgeting-and-Forecasting" accesskey="p" rel="prev">Budgeting and Forecasting</a>, Up: <a href="#Top" accesskey="u" rel="up">Top</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Time-Keeping-1"></a>
<h2 class="chapter">10 Time Keeping</h2>
<a name="index-_002d_002dday_002dbreak-1"></a>

<a name="timelog"></a><p>Ledger directly supports &ldquo;timelog&rdquo; entries, which have this form:
</p>
<div class="smallexample">
<pre class="smallexample">i 2013/03/28 22:13:00 ACCOUNT[  PAYEE]
o 2013/03/29 03:39:00
</pre></div>

<p>This records a check-in to the given ACCOUNT, and a check-out.  You can
be checked-in to multiple accounts at a time, if you wish, and they can
span multiple days (use <samp>--day-break</samp> to break them up in the
report).  The number of seconds between check-in and check-out is
accumulated as time to that ACCOUNT.  If the checkout uses a capital
&lsquo;<samp>O</samp>&rsquo;, the transaction is marked &ldquo;cleared&rdquo;.  You can use an
optional PAYEE for whatever meaning you like.
</p>
<p>Now, there are a few ways to generate this information.  You can use
the <samp>timeclock.el</samp> package, which is part of Emacs.  Or you can
write a simple script in whichever language you prefer to emit similar
information.  Or you can use Org mode&rsquo;s time-clocking abilities and
the <samp>org2tc</samp> script developed by John Wiegley.
</p>
<p>These timelog entries can appear in a separate file, or directly in
your main ledger file.  The initial &lsquo;<samp>i</samp>&rsquo; and &lsquo;<samp>o</samp>&rsquo; characters
count as Ledger &ldquo;directives&rdquo;, and are accepted anywhere that
ordinary transactions are valid.
</p>
<hr>
<a name="Value-Expressions"></a>
<div class="header">
<p>
Next: <a href="#Format-Strings" accesskey="n" rel="next">Format Strings</a>, Previous: <a href="#Time-Keeping" accesskey="p" rel="prev">Time Keeping</a>, Up: <a href="#Top" accesskey="u" rel="up">Top</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Value-Expressions-1"></a>
<h2 class="chapter">11 Value Expressions</h2>
<a name="index-_002d_002dlimit-EXPR-5"></a>
<a name="index-_002d_002ddisplay-EXPR-5"></a>

<p>Ledger uses value expressions to make calculations for many different
purposes:
</p>
<ol>
<li> The values displayed in reports.

</li><li> For predicates (where truth is anything non-zero), to determine which
postings are calculated (option <samp>--limit <var>EXPR</var> (-l)</samp>) or
displayed (option <samp>--display <var>EXPR</var> (-d)</samp>).

</li><li> For sorting criteria, to yield the sort key.

</li><li> In the matching criteria used by automated postings.

</li></ol>

<p>Value expressions support most simple math and logic operators, in
addition to a set of functions and variables.
</p>



<p>Display predicates are also very handy with register reports, to
constrain which transactions are printed.  For example, the following
command shows only transactions from the beginning of the current month,
while still calculating the running balance based on all transactions:
</p>
<div class="smallexample">
<pre class="smallexample">$ ledger -d &quot;d&gt;[this month]&quot; register checking
</pre></div>

<p>The advantage of this command&rsquo;s complexity is that it prints the
running total in terms of all transactions in the register.  The
following, simpler command is similar, but totals only the displayed
postings:
</p>
<div class="smallexample">
<pre class="smallexample">$ ledger -b &quot;this month&quot; register checking
</pre></div>

<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top">&bull; <a href="#Variables" accesskey="1">Variables</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Functions" accesskey="2">Functions</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Operators" accesskey="3">Operators</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Complex-expressions" accesskey="4">Complex expressions</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
</table>

<hr>
<a name="Variables"></a>
<div class="header">
<p>
Next: <a href="#Functions" accesskey="n" rel="next">Functions</a>, Previous: <a href="#Value-Expressions" accesskey="p" rel="prev">Value Expressions</a>, Up: <a href="#Value-Expressions" accesskey="u" rel="up">Value Expressions</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Variables-1"></a>
<h3 class="section">11.1 Variables</h3>
<a name="index-_002d_002damount-EXPR-3"></a>
<a name="index-_002d_002dtotal-VEXPR-3"></a>

<p>Below are the one letter variables available in any value expression.
For the <code>register</code> and <code>print</code> commands, these variables
relate to individual postings, and sometimes the account affected by a
posting.  For the <code>balance</code> command, these variables relate to
accounts, often with a subtle difference in meaning.  The use of each
variable for both is specified.
</p>
<dl compact="compact">
<dt><code>t</code></dt>
<dd><p>This maps to whatever the user specified with <samp>--amount
<var>EXPR</var> (-t)</samp>.  In a <code>register</code> report, <samp>--amount
<var>EXPR</var> (-t)</samp> changes the value column; in a <code>balance</code>
report, it has no meaning by default.  If <samp>--amount <var>EXPR</var>
(-t)</samp> was not specified, the current report style&rsquo;s value expression is
used.
</p>
</dd>
<dt><code>T</code></dt>
<dd><p>This maps to whatever the user specified with <samp>--total
<var>VEXPR</var> (-T)</samp>.  In a register report, <samp>--total <var>VEXPR</var>
(-T)</samp> changes the totals column; in a balance report, this is the value
given for each account.  If <samp>--total <var>VEXPR</var> (-T)</samp> was not
specified, the current report style&rsquo;s value expression is used.
</p>
</dd>
<dt><code>m</code></dt>
<dd><p>This is always the present moment/date.
</p>
</dd>
</dl>

<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top">&bull; <a href="#Posting_002faccount-details" accesskey="1">Posting/account details</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Calculated-totals" accesskey="2">Calculated totals</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
</table>

<hr>
<a name="Posting_002faccount-details"></a>
<div class="header">
<p>
Next: <a href="#Calculated-totals" accesskey="n" rel="next">Calculated totals</a>, Previous: <a href="#Variables" accesskey="p" rel="prev">Variables</a>, Up: <a href="#Variables" accesskey="u" rel="up">Variables</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Posting_002faccount-details-1"></a>
<h4 class="subsection">11.1.1 Posting/account details</h4>

<dl compact="compact">
<dt><code>d</code></dt>
<dd><p>A posting&rsquo;s date, as the number of seconds past the epoch.  This
is always &ldquo;today&rdquo; for an account.
</p>
</dd>
<dt><code>a</code></dt>
<dd><p>The posting&rsquo;s amount; the balance of an account, without
considering children.
</p>
</dd>
<dt><code>b</code></dt>
<dd><p>The cost of a posting; the cost of an account, without its
children.
</p>
</dd>
<dt><code>v</code></dt>
<dd><p>The market value of a posting or an account, without its children.
</p>
</dd>
<dt><code>g</code></dt>
<dd><p>The net gain (market value minus cost basis), for a posting or an
account, without its children.  It is the same as &lsquo;<samp>v-b</samp>&rsquo;.
</p>
</dd>
<dt><code>l</code></dt>
<dd><p>The depth (&ldquo;level&rdquo;) of an account.  If an account has one parent,
its depth is one.
</p>
</dd>
<dt><code>n</code></dt>
<dd><p>The index of a posting, or the count of postings affecting an
account.
</p>
</dd>
<dt><code>X</code></dt>
<dd><p>&lsquo;<samp>1</samp>&rsquo; if a posting&rsquo;s transaction has been cleared, &lsquo;<samp>0</samp>&rsquo; otherwise.
</p>
</dd>
<dt><code>R</code></dt>
<dd><p>&lsquo;<samp>1</samp>&rsquo; if a posting is not virtual, &lsquo;<samp>0</samp>&rsquo; otherwise.
</p>
</dd>
<dt><code>Z</code></dt>
<dd><p>&lsquo;<samp>1</samp>&rsquo; if a posting is not automated, &lsquo;<samp>0</samp>&rsquo; otherwise.
</p>
</dd>
</dl>

<hr>
<a name="Calculated-totals"></a>
<div class="header">
<p>
Previous: <a href="#Posting_002faccount-details" accesskey="p" rel="prev">Posting/account details</a>, Up: <a href="#Variables" accesskey="u" rel="up">Variables</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Calculated-totals-1"></a>
<h4 class="subsection">11.1.2 Calculated totals</h4>

<dl compact="compact">
<dt><code>O</code></dt>
<dd><p>The total of all postings seen so far, or the total of an account
and all its children.
</p>
</dd>
<dt><code>N</code></dt>
<dd><p>The total count of postings affecting an account and all its
children.
</p>
</dd>
</dl>

<hr>
<a name="Functions"></a>
<div class="header">
<p>
Next: <a href="#Operators" accesskey="n" rel="next">Operators</a>, Previous: <a href="#Variables" accesskey="p" rel="prev">Variables</a>, Up: <a href="#Value-Expressions" accesskey="u" rel="up">Value Expressions</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Functions-1"></a>
<h3 class="section">11.2 Functions</h3>

<p>The available one letter functions are:
</p>
<dl compact="compact">
<dt><code>-</code></dt>
<dd><p>Negates the argument.
</p>
</dd>
<dt><code>U</code></dt>
<dd><p>The absolute (unsigned) value of the argument.
</p>
</dd>
<dt><code>S</code></dt>
<dd><p>Strips the commodity from the argument.
</p>
</dd>
<dt><code>P</code></dt>
<dd><p>The present market value of the argument.  The syntax &lsquo;<samp>P(x,d)</samp>&rsquo; is
supported, which yields the market value at time &lsquo;<samp>d</samp>&rsquo;.  If no date
is given, then the current moment is used.
</p>
</dd>
</dl>

<hr>
<a name="Operators"></a>
<div class="header">
<p>
Next: <a href="#Complex-expressions" accesskey="n" rel="next">Complex expressions</a>, Previous: <a href="#Functions" accesskey="p" rel="prev">Functions</a>, Up: <a href="#Value-Expressions" accesskey="u" rel="up">Value Expressions</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Operators-1"></a>
<h3 class="section">11.3 Operators</h3>

<p>The binary and ternary operators, in order of precedence, are:
</p>
<ol>
<li> <code>* /</code>
</li><li> <code>+ -</code>
</li><li> <code>! &lt; &gt; =</code>
</li><li> <code>&amp; | ?:</code>
</li></ol>

<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top">&bull; <a href="#Unary-Operators" accesskey="1">Unary Operators</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Binary-Operators" accesskey="2">Binary Operators</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
</table>

<hr>
<a name="Unary-Operators"></a>
<div class="header">
<p>
Next: <a href="#Binary-Operators" accesskey="n" rel="next">Binary Operators</a>, Previous: <a href="#Operators" accesskey="p" rel="prev">Operators</a>, Up: <a href="#Operators" accesskey="u" rel="up">Operators</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Unary-Operators-1"></a>
<h4 class="subsection">11.3.1 Unary Operators</h4>

<p><code>not</code>
<code>neg</code>
</p>
<hr>
<a name="Binary-Operators"></a>
<div class="header">
<p>
Previous: <a href="#Unary-Operators" accesskey="p" rel="prev">Unary Operators</a>, Up: <a href="#Operators" accesskey="u" rel="up">Operators</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Binary-Operators-1"></a>
<h4 class="subsection">11.3.2 Binary Operators</h4>

<p><code>==</code>
<code>&lt;</code>
<code>&lt;=</code>
<code>&gt;</code>
<code>&gt;=</code>
<code>and</code>
<code>or</code>
<code>+</code>
<code>-</code>
<code>*</code>
<code>/</code>
<code>QUERY</code>
<code>COLON</code>
<code>CONS</code>
<code>SEQ</code>
<code>DEFINE</code>
<code>LOOKUP</code>
<code>LAMBDA</code>
<code>CALL</code>
<code>MATCH</code>
</p>
<hr>
<a name="Complex-expressions"></a>
<div class="header">
<p>
Previous: <a href="#Operators" accesskey="p" rel="prev">Operators</a>, Up: <a href="#Value-Expressions" accesskey="u" rel="up">Value Expressions</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Complex-expressions-1"></a>
<h3 class="section">11.4 Complex expressions</h3>

<p>More complicated expressions are possible using:
</p>
<dl compact="compact">
<dt><code>&quot;amount == COMMODITY AMOUNT&quot;</code></dt>
<dd><p>The amount can be any kind of amount supported by ledger,
with or without a commodity.  Use this for decimal values.
</p>
</dd>
<dt><code>/REGEX/</code></dt>
<dt><code>account =~ /REGEX/</code></dt>
<dd><p>A regular expression that matches against an account&rsquo;s full name.  If
a posting, this will match against the account affected by the
posting.
</p>
</dd>
<dt><code>@/REGEX/</code></dt>
<dt><code>expr payee =~ /REGEX/</code></dt>
<dd><p>A regular expression that matches against a transaction&rsquo;s payee name.
</p>
</dd>
<dt><code>%/REGEX/</code></dt>
<dt><code>tag(REGEX)</code></dt>
<dd><p>A regular expression that matches against a transaction&rsquo;s tags.
</p>
</dd>
<dt><code>expr date =~ /REGEX/</code></dt>
<dd><p>Useful for specifying a date in plain terms.  For example, you could say
&lsquo;<samp>expr date =~ /2014/</samp>&rsquo;.
</p>
</dd>
<dt><code>expr comment =~ /REGEX/</code></dt>
<dd><p>A regular expression that matches against a posting&rsquo;s comment
field.  This searches only a posting&rsquo;s field, not the transaction&rsquo;s note
or comment field.  For example, <code>ledger reg &quot;expr&quot; &quot;comment =~
/landline/&quot;</code> will match:
</p>
<div class="smallexample">
<pre class="smallexample">2014/1/29  Phone bill
    Assets:Checking                           $50.00
    Expenses:Phone                           $-50.00  ; landline bill
</pre></div>

<p>but will not match:
</p>
<div class="smallexample">
<pre class="smallexample">2014/1/29  Phone bill  ; landline bill
    ; landline bill
    Assets:Checking                           $50.00
    Expenses:Phone                           $-50.00
</pre></div>

<p>To match the latter, use &lsquo;<samp>ledger reg &quot;expr&quot; &quot;note =~ /landline/&quot;</samp>&rsquo;
instead.
</p>
</dd>
<dt><code>expr note =~ /REGEX/</code></dt>
<dd><p>A regular expression that matches against a transaction&rsquo;s note field.
This searches all comments in the transaction, including comments on
individual postings.  Thus, &lsquo;<samp>ledger reg &quot;expr&quot; &quot;note =~ /landline/&quot;</samp>&rsquo;
will match both all the three examples below:
</p>
<div class="smallexample">
<pre class="smallexample">2014/1/29  Phone bill
    Assets:Checking                           $50.00
    Expenses:Phone                           $-50.00  ; landline bill
</pre></div>

<div class="smallexample">
<pre class="smallexample">2014/1/29  Phone bill  ; landline bill
    Assets:Checking                           $50.00
    Expenses:Phone                           $-50.00
</pre></div>

<div class="smallexample">
<pre class="smallexample">2014/1/29  Phone bill
    ; landline bill
    Assets:Checking                           $50.00
    Expenses:Phone                           $-50.00
</pre></div>

</dd>
<dt><code>(EXPR)</code></dt>
<dd><p>A sub-expression is nested in parenthesis.  This can be useful passing
more complicated arguments to functions, or for overriding the natural
precedence order of operators.
</p>
</dd>
<dt><code>expr base =~ /REGEX/</code></dt>
<dd><p>A regular expression that matches against an account&rsquo;s base name.  If
a posting, this will match against the account affected by the
posting.
</p>
</dd>
<dt><code>expr code =~ /REGEX/</code></dt>
<dd><p>A regular expression that matches against the transaction code (the
text that occurs between parentheses before the payee).
</p>
</dd>
</dl>

<p>The <code>query</code> command can be used to see how Ledger interprets
your query.  This can be useful if you are not getting the results you
expect (see <a href="#Pre_002dCommands">Pre-Commands</a>).
</p>
<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top">&bull; <a href="#Miscellaneous" accesskey="1">Miscellaneous</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
</table>

<hr>
<a name="Miscellaneous"></a>
<div class="header">
<p>
Previous: <a href="#Complex-expressions" accesskey="p" rel="prev">Complex expressions</a>, Up: <a href="#Complex-expressions" accesskey="u" rel="up">Complex expressions</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Miscellaneous-1"></a>
<h4 class="subsection">11.4.1 Miscellaneous</h4>

<p>The following Ledger journal data (saved as <samp>expr.dat</samp>) is used to explain the behaviour of the
functions and variables below:
<a name="expr_002edat"></a></p><div class="smallexample">
<pre class="smallexample">2015/01/16 * (C0D3) Payee
  Assets:Cash                  -123,45
    ; Payee: PiggyBank
  Expenses:Office Supplies
</pre></div>

<dl>
<dt><a name="index-abs"></a>Function: <strong>abs</strong> <em>value</em></dt>
<dt><a name="index-U"></a>Function: <strong>U</strong> <em>value</em></dt>
<dd><p>Return the absolute value of the given <var>value</var>, e.g. <var>amount</var>.
</p><div class="smallexample">
<pre class="smallexample">$ ledger -f expr.dat --format &quot;%(account) %(abs(amount))\n&quot; reg assets
</pre></div>
<div class="smallexample">
<pre class="smallexample">Assets:Cash  123,45
</pre></div>
</dd></dl>

<dl>
<dt><a name="index-amount_005fexpr"></a>Function: <strong>amount_expr</strong></dt>
<dd><p>Return the calculated amount of the posting according to the <samp>--amount</samp>
option.
</p></dd></dl>

<dl>
<dt><a name="index-ansify_005fif"></a>Function: <strong>ansify_if</strong> <em>value color bool</em></dt>
<dd><p>Render the given <var>expression</var> as a string, applying the proper ANSI escape
codes to display it in the given <var>color</var> if <var>bool</var> is true.  It
typically checks the value of the option <samp>--color</samp>.  Since ANSI escape
codes include non-printable character sequences, such as escape <kbd>^[</kbd>
the following example may not appear as the final result on the command-line.
</p><div class="smallexample">
<pre class="smallexample">$ ledger -f expr.dat --format &quot;%(ansify_if(account, blue, options.color))\n&quot; reg
</pre></div>
<div class="smallexample">
<pre class="smallexample">[34mAssets:Cash[0m
[34mExpenses:Office Supplies[0m
</pre></div>
</dd></dl>

<dl>
<dt><a name="index-ceiling"></a>Function: <strong>ceiling</strong> <em>value</em></dt>
<dd><p>Return the next integer of <var>value</var> toward <em>+</em>infinity.
</p><div class="smallexample">
<pre class="smallexample">$ ledger -f expr.dat --format &quot;%(account) %(ceiling(amount))\n&quot; reg
</pre></div>
<div class="smallexample">
<pre class="smallexample">Assets:Cash  -123,00
Expenses:Office Supplies  124,00
</pre></div>
</dd></dl>

<dl>
<dt><a name="index-code"></a>Variable: <strong>code</strong></dt>
<dd><p>Return the transaction code, the string between the parenthesis after the date.
</p><div class="smallexample">
<pre class="smallexample">$ ledger -f expr.dat --format &quot;%(account) %(code)\n&quot; reg assets
</pre></div>
<div class="smallexample">
<pre class="smallexample">Assets:Cash C0D3
</pre></div>
</dd></dl>

<dl>
<dt><a name="index-commodity-2"></a>Variable: <strong>commodity</strong></dt>
<dd><p>Return the commodity of the posting amount.
</p></dd></dl>
<div class="smallexample">
<pre class="smallexample">$ ledger -f expr.dat --format &quot;%(account) %(commodity)\n&quot; reg
</pre></div>
<div class="smallexample">
<pre class="smallexample">Assets:Cash 
Expenses:Office Supplies 
</pre></div>

<dl>
<dt><a name="index-date"></a>Variable: <strong>date</strong></dt>
<dd><p>Return the date of the posting.
</p></dd></dl>
<div class="smallexample">
<pre class="smallexample">$ ledger -f expr.dat --format &quot;%(date) %(account)\n&quot; reg assets
</pre></div>
<div class="smallexample">
<pre class="smallexample">2015/01/16 Assets:Cash
</pre></div>

<dl>
<dt><a name="index-display_005famount"></a>Variable: <strong>display_amount</strong></dt>
<dt><a name="index-t"></a>Variable: <strong>t</strong></dt>
<dd><p><small>UNDOCUMENTED</small>! Please help by contributing documentation for this feature.
</p></dd></dl>

<dl>
<dt><a name="index-display_005ftotal-1"></a>Variable: <strong>display_total</strong></dt>
<dt><a name="index-T"></a>Variable: <strong>T</strong></dt>
<dd><p><small>UNDOCUMENTED</small>! Please help by contributing documentation for this feature.
</p></dd></dl>

<dl>
<dt><a name="index-floor"></a>Function: <strong>floor</strong> <em>value</em></dt>
<dd><p>Return the next integer of <var>value</var> toward <em>-</em>infinity.
</p><div class="smallexample">
<pre class="smallexample">$ ledger -f expr.dat --format &quot;%(account) %(floor(amount))\n&quot; reg
</pre></div>
<div class="smallexample">
<pre class="smallexample">Assets:Cash  -124,00
Expenses:Office Supplies  123,00
</pre></div>
</dd></dl>

<dl>
<dt><a name="index-format"></a>Function: <strong>format</strong> <em>string</em></dt>
<dd><p>Evaluate <var>string</var> as format just like the <samp>--format</samp> option.
</p></dd></dl>

<dl>
<dt><a name="index-format_005fdate"></a>Function: <strong>format_date</strong> <em>date format</em></dt>
<dd><p>Return the <var>date</var> as a string using <var>format</var>.  See
<code>strftime (3)</code> for format string details.
</p><div class="smallexample">
<pre class="smallexample">$ ledger -f expr.dat --format &quot;%(format_date(date, '%A, %B %d. %Y'))\n&quot; reg assets
</pre></div>
<div class="smallexample">
<pre class="smallexample">Friday, January 16. 2015
</pre></div>
</dd></dl>

<dl>
<dt><a name="index-format_005fdatetime"></a>Function: <strong>format_datetime</strong> <em>datetime format</em></dt>
<dd><p>Return the <var>datetime</var> as a string using <var>format</var>.  Refer to
<code>strftime (3)</code> for format string details.
</p></dd></dl>

<dl>
<dt><a name="index-get_005fat"></a>Function: <strong>get_at</strong> <em>sequence index</em></dt>
<dd><p>Return the value in <var>sequence</var> at <var>index</var>.  The first element is <var>index</var> 0.
For internal use only.
</p></dd></dl>

<dl>
<dt><a name="index-is_005fseq"></a>Function: <strong>is_seq</strong> <em>value</em></dt>
<dd><p>Return true if <var>value</var> is a sequence.  For internal use only.
</p></dd></dl>

<dl>
<dt><a name="index-join"></a>Function: <strong>join</strong> <em>value</em></dt>
<dd><p>Replace all newlines in <var>value</var> with <code>\n</code>.
</p></dd></dl>

<dl>
<dt><a name="index-justify"></a>Function: <strong>justify</strong> <em>value first_width latter_width right_justify colorize</em></dt>
<dd><p>Right or left justify the string representing <var>value</var>.  The width
of the field in the first line is given by <var>first_width</var>.  For
subsequent lines the width is given by <var>latter_width</var>.  If
<var>latter_width=-1</var>, then <var>first_width</var> is used for all lines.
If <var>right_justify=true</var> then the field is right justified within
the width of the field.  If it is <var>false</var>, then the field is left
justified and padded to the full width of the field.  If
<var>colorize</var> is true, then ledger will honor color settings.
</p><div class="smallexample">
<pre class="smallexample">$ ledger -f expr.dat --format &quot;%(justify(account, 30, 30, true))\n&quot; reg
</pre></div>
<div class="smallexample">
<pre class="smallexample">                   Assets:Cash
      Expenses:Office Supplies
</pre></div>
</dd></dl>

<dl>
<dt><a name="index-market"></a>Function: <strong>market</strong> <em>value datetime</em></dt>
<dt><a name="index-P-1"></a>Function: <strong>P</strong></dt>
<dd><p>Return the price of <var>value</var> at <var>datetime</var>.  Note that <var>datetime</var>
must be surrounded by brackets in order to be parsed correctly,
e.g. <code>[2012/03/23]</code>.
</p></dd></dl>

<dl>
<dt><a name="index-nail_005fdown"></a>Function: <strong>nail_down</strong></dt>
<dd><p><small>UNDOCUMENTED</small>! Please help by contributing documentation for this feature.
</p></dd></dl>

<dl>
<dt><a name="index-now"></a>Variable: <strong>now</strong></dt>
<dt><a name="index-d"></a>Variable: <strong>d</strong></dt>
<dt><a name="index-m"></a>Variable: <strong>m</strong></dt>
<dd><p>Return the current datetime.
</p></dd></dl>

<dl>
<dt><a name="index-options"></a>Variable: <strong>options</strong></dt>
<dd><p>A variable that allows access to the values of the given command-line options
using the long option names, e.g. to see whether <samp>--daily</samp> or <samp>-D</samp>
was given use <code>option.daily</code>.
</p><div class="smallexample">
<pre class="smallexample">$ ledger -f expr.dat -X $ -D --format &quot;%(options.daily) %(options.exchange)\n&quot; reg assets
</pre></div>
<div class="smallexample">
<pre class="smallexample">true $
</pre></div>
</dd></dl>

<dl>
<dt><a name="index-percent"></a>Function: <strong>percent</strong> <em>value_a value_b</em></dt>
<dd><p>Return the percentage of <var>value_a</var> in relation to <var>value_b</var> (used as 100%)
</p><div class="smallexample">
<pre class="smallexample">$ ledger -f expr.dat --format &quot;%(percent(amount, 200))\n&quot; reg
</pre></div>
<div class="smallexample">
<pre class="smallexample">-61.73%
61.73%
</pre></div>
</dd></dl>

<dl>
<dt><a name="index-print-5"></a>Function: <strong>print</strong> <em>value</em></dt>
<dd><p>Print <var>value</var> to stdout.  For internal use only.
</p></dd></dl>

<dl>
<dt><a name="index-quantity"></a>Function: <strong>quantity</strong> <em>value</em></dt>
<dd><p>Return the quantity of <var>value</var> for values that have a per-unit cost.
</p></dd></dl>

<dl>
<dt><a name="index-quoted"></a>Function: <strong>quoted</strong> <em>expression</em></dt>
<dd><p>Surround <var>expression</var> with double-quotes.  If expression contains a double-quote, it will be escaped with a backslash.
</p><div class="smallexample">
<pre class="smallexample">$ ledger -f expr.dat --format &quot;%(quoted(account)) %(quoted(amount))\n&quot; reg
</pre></div>
<div class="smallexample">
<pre class="smallexample">&quot;Assets:Cash&quot; &quot; -123,45&quot;
&quot;Expenses:Office Supplies&quot; &quot; 123,45&quot;
</pre></div>
</dd></dl>


<dl>
<dt><a name="index-round"></a>Function: <strong>round</strong></dt>
<dd><p><small>UNDOCUMENTED</small>! Please help by contributing documentation for this feature.
</p></dd></dl>

<dl>
<dt><a name="index-rounded"></a>Function: <strong>rounded</strong></dt>
<dd><p><small>UNDOCUMENTED</small>! Please help by contributing documentation for this feature.
</p></dd></dl>

<dl>
<dt><a name="index-roundto"></a>Function: <strong>roundto</strong> <em>value n</em></dt>
<dd><p>Return <var>value</var> rounded to <var>n</var> digits.  Does not affect formatting.
</p><div class="smallexample">
<pre class="smallexample">$ ledger -f expr.dat --format &quot;%(account) %(roundto(amount, 1))\n&quot; reg
</pre></div>
<div class="smallexample">
<pre class="smallexample">Assets:Cash  -123,40
Expenses:Office Supplies  123,50
</pre></div>
</dd></dl>

<dl>
<dt><a name="index-scrub"></a>Function: <strong>scrub</strong> <em>value</em></dt>
<dd><p>Clean <var>value</var> using various transformations such as <code>round</code>, stripping
value annotations, and more.
</p></dd></dl>

<dl>
<dt><a name="index-should_005fbold"></a>Function: <strong>should_bold</strong></dt>
<dd><p>Return true if expression given to <samp>--bold-if</samp> evaluates to true.  For internal use only.
</p></dd></dl>

<dl>
<dt><a name="index-strip"></a>Function: <strong>strip</strong> <em>value</em></dt>
<dt><a name="index-S"></a>Function: <strong>S</strong></dt>
<dd><p>Strip value annotation from <var>value</var>.
</p></dd></dl>

<dl>
<dt><a name="index-to_005famount"></a>Function: <strong>to_amount</strong> <em>value</em></dt>
<dd><p>Convert <var>value</var> to an amount.  For internal use only.
</p></dd></dl>

<dl>
<dt><a name="index-to_005fbalance"></a>Function: <strong>to_balance</strong> <em>value</em></dt>
<dd><p>Convert <var>value</var> to a balance.  For internal use only.
</p></dd></dl>

<dl>
<dt><a name="index-to_005fboolean"></a>Function: <strong>to_boolean</strong> <em>value</em></dt>
<dd><p>Convert <var>value</var> to a boolean.  For internal use only.
</p></dd></dl>

<dl>
<dt><a name="index-to_005fdate"></a>Function: <strong>to_date</strong> <em>value</em></dt>
<dd><p>Convert <var>value</var> to a date.  For internal use only.
</p></dd></dl>

<dl>
<dt><a name="index-to_005fdatetime"></a>Function: <strong>to_datetime</strong> <em>value</em></dt>
<dd><p>Convert <var>value</var> to a datetime.  For internal use only.
</p></dd></dl>

<dl>
<dt><a name="index-to_005fint"></a>Function: <strong>to_int</strong> <em>value</em></dt>
<dt><a name="index-int"></a>Function: <strong>int</strong> <em>value</em></dt>
<dd><p>Return the integer value for <var>value</var>.
</p><div class="smallexample">
<pre class="smallexample">$ ledger -f expr.dat --format &quot;%(1 + to_int('1'))\n%(2,5 + int(2,5))\n&quot; reg assets
</pre></div>
<div class="smallexample">
<pre class="smallexample">2
4.5
</pre></div>
</dd></dl>

<dl>
<dt><a name="index-to_005fmask"></a>Function: <strong>to_mask</strong> <em>value</em></dt>
<dd><p>Convert <var>value</var> to a mask.  For internal use only.
</p></dd></dl>

<dl>
<dt><a name="index-to_005fsequence"></a>Function: <strong>to_sequence</strong> <em>value</em></dt>
<dd><p>Convert <var>value</var> to a sequence.  For internal use only.
</p></dd></dl>

<dl>
<dt><a name="index-to_005fstring"></a>Function: <strong>to_string</strong> <em>value</em></dt>
<dt><a name="index-str"></a>Function: <strong>str</strong> <em>value</em></dt>
<dd><p>Convert <var>value</var> to a character string.
</p></dd></dl>

<dl>
<dt><a name="index-today"></a>Variable: <strong>today</strong></dt>
<dd><p>Return today&rsquo;s date.
</p></dd></dl>
<div class="smallexample">
<pre class="smallexample">$ ledger -f expr.dat --now 2015/01/01 --format &quot;%(today)\n&quot; reg assets
</pre></div>
<div class="smallexample">
<pre class="smallexample">2015/01/01
</pre></div>

<dl>
<dt><a name="index-top_005famount"></a>Function: <strong>top_amount</strong></dt>
<dd><p><small>UNDOCUMENTED</small>! Please help by contributing documentation for this feature.
</p></dd></dl>

<dl>
<dt><a name="index-total_005fexpr"></a>Function: <strong>total_expr</strong></dt>
<dd><p>Return the calculated total of the posting according to the <samp>--total</samp>
option.
</p></dd></dl>

<dl>
<dt><a name="index-trim"></a>Function: <strong>trim</strong> <em>value</em></dt>
<dd><p>Trim leading and trailing whitespace from <var>value</var>.
</p><div class="smallexample">
<pre class="smallexample">$ ledger -f expr.dat --format &quot;%(trim(' 	Trimmed	 '))\n&quot; reg assets
</pre></div>
<div class="smallexample">
<pre class="smallexample">Trimmed
</pre></div>
</dd></dl>

<dl>
<dt><a name="index-truncatedstring"></a>Function: <strong>truncatedstring</strong> <em>total_len account_len</em></dt>
<dd><p>Truncate <var>string</var> to <var>total_len</var> ensuring that each account is at least
<var>account_len</var> long.
</p></dd></dl>

<dl>
<dt><a name="index-unround"></a>Function: <strong>unround</strong></dt>
<dd><p><small>UNDOCUMENTED</small>! Please help by contributing documentation for this feature.
</p></dd></dl>

<dl>
<dt><a name="index-unrounded"></a>Function: <strong>unrounded</strong></dt>
<dd><p><small>UNDOCUMENTED</small>! Please help by contributing documentation for this feature.
</p></dd></dl>

<dl>
<dt><a name="index-value_005fdate"></a>Function: <strong>value_date</strong></dt>
<dd><p><small>UNDOCUMENTED</small>! Please help by contributing documentation for this feature.
</p></dd></dl>


<hr>
<a name="Format-Strings"></a>
<div class="header">
<p>
Next: <a href="#Extending-with-Python" accesskey="n" rel="next">Extending with Python</a>, Previous: <a href="#Value-Expressions" accesskey="p" rel="prev">Value Expressions</a>, Up: <a href="#Top" accesskey="u" rel="up">Top</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Format-Strings-1"></a>
<h2 class="chapter">12 Format Strings</h2>

<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top">&bull; <a href="#Format-String-Basics" accesskey="1">Format String Basics</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Format-String-Structure" accesskey="2">Format String Structure</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Format-Expressions" accesskey="3">Format Expressions</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Balance-format" accesskey="4">Balance format</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Formatting-Functions-and-Codes" accesskey="5">Formatting Functions and Codes</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
</table>

<hr>
<a name="Format-String-Basics"></a>
<div class="header">
<p>
Next: <a href="#Format-String-Structure" accesskey="n" rel="next">Format String Structure</a>, Previous: <a href="#Format-Strings" accesskey="p" rel="prev">Format Strings</a>, Up: <a href="#Format-Strings" accesskey="u" rel="up">Format Strings</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Format-String-Basics-1"></a>
<h3 class="section">12.1 Format String Basics</h3>
<a name="index-_002d_002dformat-FORMAT_005fSTRING-3"></a>
<a name="index-_002d_002dbalance_002dformat-FORMAT_005fSTRING-3"></a>
<a name="index-_002d_002dbudget_002dformat-FORMAT_005fSTRING-1"></a>
<a name="index-_002d_002dcleared_002dformat-FORMAT_005fSTRING-2"></a>
<a name="index-_002d_002dcsv_002dformat-FORMAT_005fSTRING-2"></a>
<a name="index-_002d_002dplot_002damount_002dformat-FORMAT_005fSTRING-3"></a>
<a name="index-_002d_002dplot_002dtotal_002dformat-FORMAT_005fSTRING-3"></a>
<a name="index-_002d_002dpricedb_002dformat-FORMAT_005fSTRING-2"></a>
<a name="index-_002d_002dprices_002dformat-FORMAT_005fSTRING-3"></a>
<a name="index-_002d_002dregister_002dformat-FORMAT_005fSTRING-3"></a>

<p>Format strings may be used to change the output format of reports.  They
are specified by passing a formatting string to the <samp>--format
<var>FORMAT_STRING</var> (-F)</samp> option.  Within that string, constructs are
allowed which make it possible to display the various parts of an
account or posting in custom ways.
</p>
<p>There are several additional flags that allow you to define formats
for specific reports.  These are useful to define in your configuration
file and will allow you to run ledger reports from the command-line
without having to enter a new format for each command.
</p>
<ul>
<li> <samp>--balance-format <var>FORMAT_STRING</var></samp>
</li><li> <samp>--budget-format <var>FORMAT_STRING</var></samp>
</li><li> <samp>--cleared-format <var>FORMAT_STRING</var></samp>
</li><li> <samp>--csv-format <var>FORMAT_STRING</var></samp>
</li><li> <samp>--plot-amount-format <var>FORMAT_STRING</var></samp>
</li><li> <samp>--plot-total-format <var>FORMAT_STRING</var></samp>
</li><li> <samp>--pricedb-format <var>FORMAT_STRING</var></samp>
</li><li> <samp>--prices-format <var>FORMAT_STRING</var></samp>
</li><li> <samp>--register-format <var>FORMAT_STRING</var></samp>
</li></ul>

<hr>
<a name="Format-String-Structure"></a>
<div class="header">
<p>
Next: <a href="#Format-Expressions" accesskey="n" rel="next">Format Expressions</a>, Previous: <a href="#Format-String-Basics" accesskey="p" rel="prev">Format String Basics</a>, Up: <a href="#Format-Strings" accesskey="u" rel="up">Format Strings</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Format-String-Structure-1"></a>
<h3 class="section">12.2 Format String Structure</h3>

<p>Within a format string, a substitution is specified using a percent
&lsquo;<samp>%</samp>&rsquo; character.  The basic format of all substitutions is:
</p>
<div class="smallexample">
<pre class="smallexample">%[-][MIN WIDTH][.MAX WIDTH](VALEXPR)
</pre></div>

<p>If the optional minus sign &lsquo;<samp>-</samp>&rsquo; follows the percent character
&lsquo;<samp>%</samp>&rsquo;, whatever is substituted will be left justified.  The default
is right justified.  If a minimum width is given next, the substituted
text will be at least that wide, perhaps wider.  If a period and
a maximum width is given, the substituted text will never be wider
than this, and will be truncated to fit.  Here are some examples:
</p>
<dl compact="compact">
<dt><code>%-20P</code></dt>
<dd><p>A transaction&rsquo;s payee, left justified and padded to 20 characters wide.
</p>
</dd>
<dt><code>%20P</code></dt>
<dd><p>The same, right justified, at least 20 chars wide.
</p>
</dd>
<dt><code>%.20P</code></dt>
<dd><p>The same, no more than 20 chars wide.
</p>
</dd>
</dl>

<p>The expression following the format constraints can be a single letter,
or an expression enclosed in parentheses or brackets.
</p>
<hr>
<a name="Format-Expressions"></a>
<div class="header">
<p>
Next: <a href="#Balance-format" accesskey="n" rel="next">Balance format</a>, Previous: <a href="#Format-String-Structure" accesskey="p" rel="prev">Format String Structure</a>, Up: <a href="#Format-Strings" accesskey="u" rel="up">Format Strings</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Format-Expressions-1"></a>
<h3 class="section">12.3 Format Expressions</h3>
<a name="index-_002d_002damount-EXPR-4"></a>
<a name="index-_002d_002dtotal-VEXPR-4"></a>

<p>For demonstration purposes the journal data from <a href="#expr_002edat">expr.dat</a> is used.
The allowable expressions are:
</p>
<dl compact="compact">
<dt><code>%</code></dt>
<dd><p>Inserts a percent sign.
</p><div class="smallexample">
<pre class="smallexample">$ ledger -f expr.dat --format &quot;%%\n&quot; reg assets
</pre></div>
<div class="smallexample">
<pre class="smallexample">%
</pre></div>

</dd>
<dt><code>t</code></dt>
<dd><p>Inserts the results of the value expression specified by
<samp>--amount <var>EXPR</var> (-t)</samp>.  If <samp>--amount <var>EXPR</var> (-t)</samp>
was not specified, the current report style&rsquo;s value expression is used.
</p>
</dd>
<dt><code>T</code></dt>
<dd><p>Inserts the results of the value expression specified by <samp>--total
<var>VEXPR</var> (-T)</samp>.  If <samp>--total <var>VEXPR</var> (-T)</samp> was not
specified, the current report style&rsquo;s value expression is used.
</p>
</dd>
<dt><code>(EXPR)</code></dt>
<dd><p>Inserts the amount resulting from the value expression given in
parentheses.  To insert five times the total value of an account, for
example, one could say &lsquo;<samp>%12(5*O)</samp>&rsquo;.  Note: It&rsquo;s important to put the
five first in that expression, so that the commodity doesn&rsquo;t get
stripped from the total.
</p><div class="smallexample">
<pre class="smallexample">$ ledger -f expr.dat --format &quot;%12(5*O)\n&quot; reg assets
</pre></div>
<div class="smallexample">
<pre class="smallexample">    -617,25
</pre></div>

</dd>
<dt><code>[DATEFMT]</code></dt>
<dd><p>Inserts the result of formatting a posting&rsquo;s date with a date format
string, exactly like those supported by <code>strftime (3)</code>.  For
example: &lsquo;<samp>%[%Y/%m/%d %H:%M:%S]</samp>&rsquo;.
</p>
</dd>
<dt><code>S</code></dt>
<dd><p>Insert the path name of the file from which the transaction&rsquo;s data was
read.  Only sensible in a <code>register</code> report.
</p><div class="smallexample">
<pre class="smallexample">$ ledger -f ~/journal.dat --format &quot;%S\n&quot; reg assets
</pre></div>
<div class="smallexample">
<pre class="smallexample">/home/jwiegley/journal.dat
</pre></div>

</dd>
<dt><code>B</code></dt>
<dd><p>Inserts the beginning character position of that transaction within the
file.
</p><div class="smallexample">
<pre class="smallexample">$ ledger -f expr.dat --format &quot;%B\n&quot; reg assets
</pre></div>
<div class="smallexample">
<pre class="smallexample">26
</pre></div>

</dd>
<dt><code>b</code></dt>
<dd><p>Inserts the beginning line of that transaction within the file.
</p><div class="smallexample">
<pre class="smallexample">$ ledger -f expr.dat --format &quot;%b\n&quot; reg assets
</pre></div>
<div class="smallexample">
<pre class="smallexample">2
</pre></div>

</dd>
<dt><code>E</code></dt>
<dd><p>Inserts the ending character position of that transaction within the
file.
</p><div class="smallexample">
<pre class="smallexample">$ ledger -f expr.dat --format &quot;%E\n&quot; reg assets
</pre></div>
<div class="smallexample">
<pre class="smallexample">90
</pre></div>

</dd>
<dt><code>e</code></dt>
<dd><p>Inserts the ending line of that transaction within the file.
</p><div class="smallexample">
<pre class="smallexample">$ ledger -f expr.dat --format &quot;%e\n&quot; reg assets
</pre></div>
<div class="smallexample">
<pre class="smallexample">3
</pre></div>

</dd>
<dt><code>D</code></dt>
<dd><p>Returns the date according to the default format.
</p>
</dd>
<dt><code>d</code></dt>
<dd><p>Returns the date according to the default format.  If the transaction
has an effective date, it prints <code>ACTUAL_DATE=EFFECTIVE_DATE</code>.
</p>
</dd>
<dt><code>X</code></dt>
<dd><p>If a posting has been cleared, this returns a 1, otherwise returns 0.
</p>
</dd>
<dt><code>Y</code></dt>
<dd><p>This is the same as &lsquo;<samp>%X</samp>&rsquo;, except that it only displays a state
character if all of the member postings have the same state.
</p>
</dd>
<dt><code>C</code></dt>
<dd><p>Inserts the transaction code.  This is the value specified between
parentheses on the first line of the transaction.
</p><div class="smallexample">
<pre class="smallexample">$ ledger -f expr.dat --format &quot;%C\n&quot; reg assets
</pre></div>
<div class="smallexample">
<pre class="smallexample">(C0D3) 
</pre></div>

</dd>
<dt><code>P</code></dt>
<dd><p>Inserts the payee related to a posting.
</p><div class="smallexample">
<pre class="smallexample">$ ledger -f expr.dat --format &quot;%P\n&quot; reg assets
</pre></div>
<div class="smallexample">
<pre class="smallexample">PiggyBank
</pre></div>


</dd>
<dt><code>A</code></dt>
<dd><p>Inserts the full name of an account.
</p><div class="smallexample">
<pre class="smallexample">$ ledger -f expr.dat --format &quot;%A\n&quot; reg
</pre></div>
<div class="smallexample">
<pre class="smallexample">Assets:Cash
Expenses:Office Supplies
</pre></div>



</dd>
<dt><code>N</code></dt>
<dd><p>Inserts the note associated with a posting, if one exists.
</p><div class="smallexample">
<pre class="smallexample">$ ledger -f expr.dat --format &quot;%N\n&quot; reg assets
</pre></div>
<div class="smallexample">
<pre class="smallexample"> Payee: PiggyBank
</pre></div>

</dd>
<dt><code>/</code></dt>
<dd><p>The &lsquo;<samp>%/</samp>&rsquo; construct is special.  It separates a format string
between what is printed for the first posting of a transaction, and
what is printed for all subsequent postings.  If not used, the
same format string is used for all postings.
</p><div class="smallexample">
<pre class="smallexample">$ ledger -f expr.dat --format &quot;%P\n%/%A\n&quot; reg
</pre></div>
<div class="smallexample">
<pre class="smallexample">PiggyBank
Expenses:Office Supplies
</pre></div>

</dd>
</dl>

<hr>
<a name="Balance-format"></a>
<div class="header">
<p>
Next: <a href="#Formatting-Functions-and-Codes" accesskey="n" rel="next">Formatting Functions and Codes</a>, Previous: <a href="#Format-Expressions" accesskey="p" rel="prev">Format Expressions</a>, Up: <a href="#Format-Strings" accesskey="u" rel="up">Format Strings</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Balance-format-1"></a>
<h3 class="section">12.4 Balance format</h3>
<a name="index-_002d_002dbalance_002dformat-FORMAT_005fSTRING-4"></a>
<a name="index-_002d_002dformat-FORMAT_005fSTRING-4"></a>

<p>As an example of how flexible the <samp>--format <var>FORMAT_STRING</var></samp>
strings can be, the default balance format looks like this (the various
functions are described later):
</p>
<div class="smallexample">
<pre class="smallexample">&quot;%(justify(scrub(display_total), 20, -1, true, color))&quot;
&quot;  %(!options.flat ? depth_spacer : \&quot;\&quot;)&quot;
&quot;%-(ansify_if(partial_account(options.flat), blue if color))\n%/&quot;
&quot;%$1\n%/&quot;
&quot;--------------------\n&quot;
</pre></div>

<hr>
<a name="Formatting-Functions-and-Codes"></a>
<div class="header">
<p>
Previous: <a href="#Balance-format" accesskey="p" rel="prev">Balance format</a>, Up: <a href="#Format-Strings" accesskey="u" rel="up">Format Strings</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Formatting-Functions-and-Codes-1"></a>
<h3 class="section">12.5 Formatting Functions and Codes</h3>

<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top">&bull; <a href="#Field-Widths" accesskey="1">Field Widths</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Colors" accesskey="2">Colors</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Quantities-and-Calculations" accesskey="3">Quantities and Calculations</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Date-Functions" accesskey="4">Date Functions</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Date-and-Time-Format-Codes" accesskey="5">Date and Time Format Codes</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Text-Formatting" accesskey="6">Text Formatting</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Data-File-Parsing-Information" accesskey="7">Data File Parsing Information</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
</table>

<hr>
<a name="Field-Widths"></a>
<div class="header">
<p>
Next: <a href="#Colors" accesskey="n" rel="next">Colors</a>, Previous: <a href="#Formatting-Functions-and-Codes" accesskey="p" rel="prev">Formatting Functions and Codes</a>, Up: <a href="#Formatting-Functions-and-Codes" accesskey="u" rel="up">Formatting Functions and Codes</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Field-Widths-1"></a>
<h4 class="subsection">12.5.1 Field Widths</h4>

<p>The following codes return the width allocated for the specific fields.
The defaults can be changed using the corresponding command-line
options:
</p>
<ul>
<li> <code>date_width</code>
</li><li> <code>payee_width</code>
</li><li> <code>account_width</code>
</li><li> <code>amount_width</code>
</li><li> <code>total_width</code>
</li></ul>

<hr>
<a name="Colors"></a>
<div class="header">
<p>
Next: <a href="#Quantities-and-Calculations" accesskey="n" rel="next">Quantities and Calculations</a>, Previous: <a href="#Field-Widths" accesskey="p" rel="prev">Field Widths</a>, Up: <a href="#Formatting-Functions-and-Codes" accesskey="u" rel="up">Formatting Functions and Codes</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Colors-1"></a>
<h4 class="subsection">12.5.2 Colors</h4>

<p>The character-based formatting ledger can do is limited to the ANSI
terminal character colors and font highlights in a normal TTY session.
</p>
<table>
<tr><td width="30%"><code>red</code></td><td width="30%"><code>magenta</code></td><td width="30%"><code>bold</code></td></tr>
<tr><td width="30%"><code>green</code></td><td width="30%"><code>cyan</code></td><td width="30%"><code>underline</code></td></tr>
<tr><td width="30%"><code>yellow</code></td><td width="30%"><code>white</code></td><td width="30%"><code>blink</code></td></tr>
<tr><td width="30%"><code>blue</code></td><td width="30%"><code>black</code></td></tr>
</table>

<hr>
<a name="Quantities-and-Calculations"></a>
<div class="header">
<p>
Next: <a href="#Date-Functions" accesskey="n" rel="next">Date Functions</a>, Previous: <a href="#Colors" accesskey="p" rel="prev">Colors</a>, Up: <a href="#Formatting-Functions-and-Codes" accesskey="u" rel="up">Formatting Functions and Codes</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Quantities-and-Calculations-1"></a>
<h4 class="subsection">12.5.3 Quantities and Calculations</h4>

<dl compact="compact">
<dt><code>amount_expr</code></dt>
<dt><code>abs</code></dt>
<dt><code>commodity</code></dt>
<dt><code>display_amount</code></dt>
<dt><code>display_total</code></dt>
<dt><code>floor</code></dt>
<dt><code>get_at</code></dt>
<dt><code>is_seq</code></dt>
<dt><code>market</code></dt>
<dt><code>percent</code></dt>
<dt><code>price</code></dt>
<dt><code>quantity</code></dt>
<dt><code>rounded</code></dt>
<dt><code>truncated</code></dt>
<dt><code>total_expr</code></dt>
<dt><code>top_amount</code></dt>
<dt><code>to_boolean</code></dt>
<dt><code>to_int</code></dt>
<dt><code>to_amount</code></dt>
<dt><code>to_balance</code></dt>
<dt><code>unrounded</code></dt>
</dl>

<hr>
<a name="Date-Functions"></a>
<div class="header">
<p>
Next: <a href="#Date-and-Time-Format-Codes" accesskey="n" rel="next">Date and Time Format Codes</a>, Previous: <a href="#Quantities-and-Calculations" accesskey="p" rel="prev">Quantities and Calculations</a>, Up: <a href="#Formatting-Functions-and-Codes" accesskey="u" rel="up">Formatting Functions and Codes</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Date-Functions-1"></a>
<h4 class="subsection">12.5.4 Date Functions</h4>
<a name="index-_002d_002dnow-DATE-2"></a>

<p>The following functions allow you to manipulate and format dates.
</p>
<dl compact="compact">
<dt><code>date</code></dt>
<dd><p>Return the date of the current transaction.
</p>
</dd>
<dt><code>format_date(date, &quot;FORMAT_STRING&quot;)</code></dt>
<dd><p>Format the date using the given format string.
</p>
</dd>
<dt><code>now</code></dt>
<dd><p>Return the current date and time.  If the <samp>--now <var>DATE</var></samp>
option is defined it will return that value.
</p>
</dd>
<dt><code>today</code></dt>
<dd><p>Return the current date.  If the <samp>--now <var>DATE</var></samp> option is
defined it will return that value.
</p>
</dd>
<dt><code>to_datetime</code></dt>
<dd><p>Convert a string to a date-time value.
</p>
</dd>
<dt><code>to_date</code></dt>
<dd><p>Convert a string to date value.
</p>
</dd>
<dt><code>value_date</code></dt>
</dl>

<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top">&bull; <a href="#Date-and-Time-Format-Codes" accesskey="1">Date and Time Format Codes</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
</table>

<hr>
<a name="Date-and-Time-Format-Codes"></a>
<div class="header">
<p>
Next: <a href="#Text-Formatting" accesskey="n" rel="next">Text Formatting</a>, Previous: <a href="#Date-Functions" accesskey="p" rel="prev">Date Functions</a>, Up: <a href="#Formatting-Functions-and-Codes" accesskey="u" rel="up">Formatting Functions and Codes</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Date-and-Time-Format-Codes-1"></a>
<h4 class="subsection">12.5.5 Date and Time Format Codes</h4>

<p>Date and time format are specified as strings of single letter codes
preceded by percent signs.  Any separator, or no separator can be
specified.
</p>
<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top">&bull; <a href="#Days" accesskey="1">Days</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Weekdays" accesskey="2">Weekdays</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Month" accesskey="3">Month</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Miscellaneous-Date-Codes" accesskey="4">Miscellaneous Date Codes</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
</table>

<hr>
<a name="Days"></a>
<div class="header">
<p>
Next: <a href="#Weekdays" accesskey="n" rel="next">Weekdays</a>, Previous: <a href="#Date-and-Time-Format-Codes" accesskey="p" rel="prev">Date and Time Format Codes</a>, Up: <a href="#Date-and-Time-Format-Codes" accesskey="u" rel="up">Date and Time Format Codes</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Days-1"></a>
<h4 class="subsubsection">12.5.5.1 Days</h4>

<p>Dates are formed from a combination of day, month and year codes, in
whatever order you prefer:
</p>
<dl compact="compact">
<dt><code>%Y</code></dt>
<dd><p>Four digit year.
</p>
</dd>
<dt><code>%y</code></dt>
<dd><p>Two digit year.
</p>
</dd>
<dt><code>%m</code></dt>
<dd><p>Two digit month.
</p>
</dd>
<dt><code>%d</code></dt>
<dd><p>Two digit date.
</p>
</dd>
</dl>

<p>So <code>&quot;%Y%m%d&quot;</code> yields &lsquo;<samp>20111214</samp>&rsquo; which provides a date that
is simple to sort on.
</p>
<hr>
<a name="Weekdays"></a>
<div class="header">
<p>
Next: <a href="#Month" accesskey="n" rel="next">Month</a>, Previous: <a href="#Days" accesskey="p" rel="prev">Days</a>, Up: <a href="#Date-and-Time-Format-Codes" accesskey="u" rel="up">Date and Time Format Codes</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Weekdays-1"></a>
<h4 class="subsubsection">12.5.5.2 Weekdays</h4>

<p>You can have additional weekday information in your date with &lsquo;<samp>%A</samp>&rsquo;
as
</p>
<dl compact="compact">
<dt><code>%m-%d-%Y %A</code></dt>
<dd><p>yields &lsquo;<samp>02-10-2010 Wednesday</samp>&rsquo;.
</p>
</dd>
<dt><code>%A %m-%d-%Y</code></dt>
<dd><p>yields &lsquo;<samp>Wednesday 02-10-2010</samp>&rsquo;.
</p>
</dd>
</dl>

<p>These are options you can select for weekday
</p>
<dl compact="compact">
<dt><code>%a</code></dt>
<dd><p>weekday, abbreviated Wed.
</p>
</dd>
<dt><code>%A</code></dt>
<dd><p>weekday, full Wednesday.
</p>
</dd>
<dt><code>%d</code></dt>
<dd><p>day of the month (dd), zero padded up to 10.
</p>
</dd>
<dt><code>%e</code></dt>
<dd><p>day of the month (dd), no leading zero up to 10.
</p>
</dd>
<dt><code>%j</code></dt>
<dd><p>day of year, zero padded 000&ndash;366.
</p>
</dd>
<dt><code>%u</code></dt>
<dd><p>day of week starting with Monday (1), i.e. <code>mtwtfss</code> 3.
</p>
</dd>
<dt><code>%w</code></dt>
<dd><p>day of week starting with Sunday (0), i.e. <code>smtwtfs</code> 3.
</p>
</dd>
</dl>

<hr>
<a name="Month"></a>
<div class="header">
<p>
Next: <a href="#Miscellaneous-Date-Codes" accesskey="n" rel="next">Miscellaneous Date Codes</a>, Previous: <a href="#Weekdays" accesskey="p" rel="prev">Weekdays</a>, Up: <a href="#Date-and-Time-Format-Codes" accesskey="u" rel="up">Date and Time Format Codes</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Month-1"></a>
<h4 class="subsubsection">12.5.5.3 Month</h4>

<p>You can have additional month information in your date with &lsquo;<samp>%B</samp>&rsquo;
as
</p>
<dl compact="compact">
<dt><code>%m-%d-%Y %B</code></dt>
<dd><p>yields &lsquo;<samp>02-10-2010 February</samp>&rsquo;.
</p>
</dd>
<dt><code>%B %m-%d-%Y</code></dt>
<dd><p>yields &lsquo;<samp>February 02-10-2010</samp>&rsquo;.
</p>
</dd>
</dl>

<p>These are options you can select for month
</p>
<dl compact="compact">
<dt><code>%m</code></dt>
<dd><p>&lsquo;<samp>mm</samp>&rsquo; month as two digits.
</p>
</dd>
<dt><code>%b</code></dt>
<dd><p>Locales abbreviated month, for example &lsquo;<samp>02</samp>&rsquo; might be abbreviated
as &lsquo;<samp>Feb</samp>&rsquo;.
</p>
</dd>
<dt><code>%B</code></dt>
<dd><p>Locales full month, variable length, e.g. February.
</p>
</dd>
</dl>

<hr>
<a name="Miscellaneous-Date-Codes"></a>
<div class="header">
<p>
Previous: <a href="#Month" accesskey="p" rel="prev">Month</a>, Up: <a href="#Date-and-Time-Format-Codes" accesskey="u" rel="up">Date and Time Format Codes</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Miscellaneous-Date-Codes-1"></a>
<h4 class="subsubsection">12.5.5.4 Miscellaneous Date Codes</h4>

<p>Additional date format parameters which can be used:
</p>
<dl compact="compact">
<dt><code>%U</code></dt>
<dd><p>week number Sunday as first day of week, ranging 01&ndash;53.
</p>
</dd>
<dt><code>%W</code></dt>
<dd><p>week number Monday as first day of week, ranging 01&ndash;53.
</p>
</dd>
<dt><code>%V</code></dt>
<dd><p>week of the year, ranging 01&ndash;53.
</p>
</dd>
<dt><code>%C</code></dt>
<dd><p>century, ranging 00&ndash;99.
</p>
</dd>
<dt><code>%D</code></dt>
<dd><p>yields <code>%m/%d/%y</code> as in &lsquo;<samp>02/10/10</samp>&rsquo;.
</p>
</dd>
<dt><code>%x</code></dt>
<dd><p>locales date representation, as &lsquo;<samp>02/10/2010</samp>&rsquo; for the U.S.
</p>
</dd>
<dt><code>%F</code></dt>
<dd><p>yields <code>%Y-%m-%d</code> as in &lsquo;<samp>2010-02-10</samp>&rsquo;.
</p>
</dd>
</dl>

<hr>
<a name="Text-Formatting"></a>
<div class="header">
<p>
Next: <a href="#Data-File-Parsing-Information" accesskey="n" rel="next">Data File Parsing Information</a>, Previous: <a href="#Date-and-Time-Format-Codes" accesskey="p" rel="prev">Date and Time Format Codes</a>, Up: <a href="#Formatting-Functions-and-Codes" accesskey="u" rel="up">Formatting Functions and Codes</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Text-Formatting-1"></a>
<h4 class="subsection">12.5.6 Text Formatting</h4>

<p>The following format functions allow you limited formatting of text:
</p>
<dl compact="compact">
<dt><code>ansify_if(value, color)</code></dt>
<dd><p>Surrounds the string representing value with ANSI codes to give it
<code>color</code> on an TTY display.  Has no effect if directed to a file.
</p>
</dd>
<dt><code>justify(value, first_width, latter_width, right_justify, colorize)</code></dt>
<dd><p>Right or left justify the string representing <code>value</code>.  The width
of the field in the first line is given by <code>first_width</code>.  For
subsequent lines the width is given by <code>latter_width</code>.  If
<code>latter_width=-1</code>, then <code>first_width</code> is use for all lines.
If <code>right_justify=true</code> then the field is right justify within
the width of the field.  If it is <code>false</code>, then the field is left
justified and padded to the full width of the field.  If
<code>colorize</code> is true, then ledger will honor color settings.
</p>
</dd>
<dt><code>join(STR)</code></dt>
<dd><p>Replaces line feeds in <code>STR</code> with &lsquo;<samp>\n</samp>&rsquo;.
</p>
</dd>
<dt><code>quoted(STR)</code></dt>
<dd><p>Return <code>STR</code> surrounded by double quotes, &lsquo;<samp>&quot;STR&quot;</samp>&rsquo;.
</p>
</dd>
<dt><code>strip(value)</code></dt>
<dd><p>Values can have numerous annotations, such as effective dates and lot
prices.  <code>strip</code> removes these annotations.
</p>
</dd>
</dl>

<hr>
<a name="Data-File-Parsing-Information"></a>
<div class="header">
<p>
Previous: <a href="#Text-Formatting" accesskey="p" rel="prev">Text Formatting</a>, Up: <a href="#Formatting-Functions-and-Codes" accesskey="u" rel="up">Formatting Functions and Codes</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Data-File-Parsing-Information-1"></a>
<h4 class="subsection">12.5.7 Data File Parsing Information</h4>

<p>The following format strings provide locational metadata
regarding the coordinates of entries in the source data file(s) that
generated the posting.
</p>
<dl compact="compact">
<dt><code>filename</code></dt>
<dd><p>the name of the ledger data file from whence the posting came,
abbreviated &lsquo;<samp>S</samp>&rsquo;.
</p>
</dd>
<dt><code>beg_pos</code></dt>
<dd><p>character position in <code>filename</code> where entry for posting begins,
abbreviated &lsquo;<samp>B</samp>&rsquo;.
</p>
</dd>
<dt><code>end_pos</code></dt>
<dd><p>character position in <code>filename</code> where entry for posting ends,
abbreviated &lsquo;<samp>E</samp>&rsquo;.
</p>
</dd>
<dt><code>beg_line</code></dt>
<dd><p>line number in <code>filename</code> where entry for posting begins,
abbreviated &lsquo;<samp>b</samp>&rsquo;.
</p>
</dd>
<dt><code>end_line</code></dt>
<dd><p>line number in <code>filename</code> where entry for posting ends,
abbreviated &lsquo;<samp>e</samp>&rsquo;.
</p>
</dd>
</dl>

<hr>
<a name="Extending-with-Python"></a>
<div class="header">
<p>
Next: <a href="#Ledger-for-Developers" accesskey="n" rel="next">Ledger for Developers</a>, Previous: <a href="#Format-Strings" accesskey="p" rel="prev">Format Strings</a>, Up: <a href="#Top" accesskey="u" rel="up">Top</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Extending-with-Python-1"></a>
<h2 class="chapter">13 Extending with Python</h2>

<p>Python can be used to extend your Ledger experience.  But first,
a word must be said about Ledger&rsquo;s data model, so that other things
make sense later.
</p>
<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top">&bull; <a href="#Basic-data-traversal" accesskey="1">Basic data traversal</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Raw-versus-Cooked" accesskey="2">Raw versus Cooked</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Queries" accesskey="3">Queries</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Embedded-Python" accesskey="4">Embedded Python</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Amounts" accesskey="5">Amounts</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
</table>

<hr>
<a name="Basic-data-traversal"></a>
<div class="header">
<p>
Next: <a href="#Raw-versus-Cooked" accesskey="n" rel="next">Raw versus Cooked</a>, Previous: <a href="#Extending-with-Python" accesskey="p" rel="prev">Extending with Python</a>, Up: <a href="#Extending-with-Python" accesskey="u" rel="up">Extending with Python</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Basic-data-traversal-1"></a>
<h3 class="section">13.1 Basic data traversal</h3>

<p>Every interaction with Ledger happens in the context of a Session.
Even if you don&rsquo;t create a session manually, one is created for you by
the top-level interface functions.  The Session is where objects live
like the Commodities that Amounts refer to.
</p>
<p>To make a Session useful, you must read a Journal into it, using the
function &lsquo;<code>read_journal</code>&lsquo;.  This reads Ledger data from the given
file, populates a Journal object within the current Session, and
returns a reference to that Journal object.
</p>
<p>Within the Journal live all the Transactions, Postings, and other
objects related to your data.  There are also AutomatedTransactions
and PeriodicTransactions, etc.
</p>
<p>Here is how you would traverse all the postings in your data file:
</p>
<div class="smallexample">
<pre class="smallexample">import ledger

for xact in ledger.read_journal(&quot;sample.dat&quot;).xacts():
    for post in xact.posts():
        print &quot;Transferring %s to/from %s&quot; % (post.amount, post.account)
</pre></div>

<hr>
<a name="Raw-versus-Cooked"></a>
<div class="header">
<p>
Next: <a href="#Queries" accesskey="n" rel="next">Queries</a>, Previous: <a href="#Basic-data-traversal" accesskey="p" rel="prev">Basic data traversal</a>, Up: <a href="#Extending-with-Python" accesskey="u" rel="up">Extending with Python</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Raw-versus-Cooked-1"></a>
<h3 class="section">13.2 Raw versus Cooked</h3>

<p>Ledger data exists in one of two forms: raw and cooked.  Raw objects are
what you get from a traversal like the above, and represent exactly what
was seen in the data file.  Consider this journal:
</p>
<div class="smallexample">
<pre class="smallexample">= true
    (Assets:Cash)    $100

2012-03-01 KFC
    Expenses:Food    $100
    Assets:Credit
</pre></div>

<p>In this case, the <em>raw</em> regular transaction in this file is:
</p>
<div class="smallexample">
<pre class="smallexample">2012-03-01 KFC
    Expenses:Food    $100
    Assets:Credit
</pre></div>

<p>While the <em>cooked</em> form is:
</p>
<div class="smallexample">
<pre class="smallexample">2012-03-01 KFC
    Expenses:Food    $100
    Assets:Credit   $-100
    (Assets:Cash)    $100
</pre></div>

<p>So the easy way to think about raw vs. cooked is that raw is the
unprocessed data, and cooked has had all considerations applied.
</p>
<p>When you traverse a Journal by iterating over its transactions, you are
generally looking at raw data.  In order to look at cooked data, you
must generate a report of some kind by querying the journal:
</p>
<div class="smallexample">
<pre class="smallexample">for post in ledger.read_journal(&quot;sample.dat&quot;).query(&quot;food&quot;):
    print &quot;Transferring %s to/from %s&quot; % (post.amount, post.account)
</pre></div>

<p>The reason why queries iterate over postings instead of transactions is
that queries often return only a &ldquo;slice&rdquo; of the transactions they
apply to.  You can always get at a matching posting&rsquo;s transaction by
looking at its <code>xact</code> member:
</p>
<div class="smallexample">
<pre class="smallexample">last_xact = None
for post in ledger.read_journal(&quot;sample.dat&quot;).query(&quot;&quot;):
    if post.xact != last_xact:
        for post in post.xact.posts():
            print &quot;Transferring %s to/from %s&quot; % (post.amount,
            post.account)
        last_xact = post.xact
</pre></div>

<p>This query ends up reporting every cooked posting in the Journal, but
does it transaction-wise.  It relies on the fact that an unsorted report
returns postings in the exact order they were parsed from the journal
file.
</p>
<hr>
<a name="Queries"></a>
<div class="header">
<p>
Next: <a href="#Embedded-Python" accesskey="n" rel="next">Embedded Python</a>, Previous: <a href="#Raw-versus-Cooked" accesskey="p" rel="prev">Raw versus Cooked</a>, Up: <a href="#Extending-with-Python" accesskey="u" rel="up">Extending with Python</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Queries-1"></a>
<h3 class="section">13.3 Queries</h3>

<p>The Journal.query() method accepts every argument you can specify on the
command-line, including <samp>--options</samp>.
</p>
<p>Since a query &ldquo;cooks&rdquo; the journal it applies to, only one query may be
active for that journal at a given time.  Once the query object is gone
(after the for loop), then the data reverts back to its raw state.
</p>
<hr>
<a name="Embedded-Python"></a>
<div class="header">
<p>
Next: <a href="#Amounts" accesskey="n" rel="next">Amounts</a>, Previous: <a href="#Queries" accesskey="p" rel="prev">Queries</a>, Up: <a href="#Extending-with-Python" accesskey="u" rel="up">Extending with Python</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Embedded-Python-1"></a>
<h3 class="section">13.4 Embedded Python</h3>

<p>You can embed Python into your data files using the &rsquo;python&rsquo; directive:
</p>
<div class="smallexample">
<pre class="smallexample">python
    import os
    def check_path(path_value):
        print &quot;%s =&gt; %s&quot; % (str(path_value), os.path.isfile(str(path_value)))
        return os.path.isfile(str(path_value))

tag PATH
    assert check_path(value)

2012-02-29 KFC
    ; PATH: somebogusfile.dat
    Expenses:Food                $20
    Assets:Cash
</pre></div>

<p>Any Python functions you define this way become immediately available as
valexpr functions.
</p>
<hr>
<a name="Amounts"></a>
<div class="header">
<p>
Previous: <a href="#Embedded-Python" accesskey="p" rel="prev">Embedded Python</a>, Up: <a href="#Extending-with-Python" accesskey="u" rel="up">Extending with Python</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Amounts-1"></a>
<h3 class="section">13.5 Amounts</h3>

<p>When numbers come from Ledger, like post.amount, the type of the value
is Amount.  It can be used just like an ordinary number, except that
addition and subtraction are restricted to amounts with the same
commodity.  If you need to create sums of multiple commodities, use
a Balance.  For example:
</p>
<div class="smallexample">
<pre class="smallexample">total = Balance()
for post in ledger.read_journal(&quot;sample.dat&quot;).query(&quot;&quot;):
    total += post.amount
print total
</pre></div>

<hr>
<a name="Ledger-for-Developers"></a>
<div class="header">
<p>
Next: <a href="#Major-Changes-from-version-2_002e6" accesskey="n" rel="next">Major Changes from version 2.6</a>, Previous: <a href="#Extending-with-Python" accesskey="p" rel="prev">Extending with Python</a>, Up: <a href="#Top" accesskey="u" rel="up">Top</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Ledger-for-Developers-1"></a>
<h2 class="chapter">14 Ledger for Developers</h2>

<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top">&bull; <a href="#Internal-Design" accesskey="1">Internal Design</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Journal-File-Format-for-Developers" accesskey="2">Journal File Format for Developers</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Developer-Commands" accesskey="3">Developer Commands</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Ledger-Development-Environment" accesskey="4">Ledger Development Environment</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
</table>

<hr>
<a name="Internal-Design"></a>
<div class="header">
<p>
Next: <a href="#Journal-File-Format-for-Developers" accesskey="n" rel="next">Journal File Format for Developers</a>, Previous: <a href="#Ledger-for-Developers" accesskey="p" rel="prev">Ledger for Developers</a>, Up: <a href="#Ledger-for-Developers" accesskey="u" rel="up">Ledger for Developers</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Internal-Design-1"></a>
<h3 class="section">14.1 Internal Design</h3>

<p>Ledger is developed as a tiered set of functionality, where lower tiers
know nothing about the higher tiers.  In fact, multiple libraries are
built during the development the process, and link unit tests to these
libraries, so that it is a link error for a lower tier to violate this
modularity.
</p>
<p>Those tiers are:
</p>
<ul>
<li> Utility code

<p>There&rsquo;s lots of general utility in Ledger for doing time parsing, using
Boost.Regex, error handling, etc.  It&rsquo;s all done in a way that can be
reused in other projects as needed.
</p>
</li><li> Commoditized Amounts (amount_t, commodity_t and friends)

<p>A numerical abstraction combining multi-precision rational numbers (via
GMP) with commodities.  These structures can be manipulated like regular
numbers in either C++ or Python (as Amount objects).
</p>
</li><li> Commodity Pool

<p>Commodities are all owned by a commodity pool, so that future parsing of
amounts can link to the same commodity and established a consistent
price history and record of formatting details.
</p>
</li><li> Balances

<p>Adds the concept of multiple amounts with varying commodities.  Supports
simple arithmetic, and multiplication and division with non-commoditized
values.
</p>
</li><li> Price history

<p>Amounts have prices, and these are kept in a data graph which the amount
code itself is only dimly aware of (there&rsquo;s three points of access so an
amount can query its revalued price on a given date).
</p>
</li><li> Values

<p>Often the higher layers in Ledger don&rsquo;t care if something is an amount
or a balance, they just want to add stuff to it or print it.  For this,
I created a type-erasure class, value_t/Value, into which many things
can be stuffed and then operated on.  They can contain amounts,
balances, dates, strings, etc.  If you try to apply an operation between
two values that makes no sense (like dividing an amount by a balance),
an error occurs at runtime, rather than at compile-time (as would happen
if you actually tried to divide an <code>amount_t</code> by
a <code>balance_t</code>).
</p>
<p>This is the core data type for the value expression language.
</p>
</li><li> Value expressions

<p>The next layer up adds functions and operators around the Value concept.
This lets you apply transformations and tests to Values at runtime
without having to bake it into C++.  The set of functions available is
defined by each object type in Ledger (posts, accounts, transactions,
etc.), though the core engine knows nothing about these.  At its base,
it only knows how to apply operators to values, and how to pass them to
and receive them from functions.
</p>
</li><li> Query expressions

<p>Expressions can be onerous to type at the command-line, so there&rsquo;s
a shorthand for reporting called &ldquo;query expressions&rdquo;.  These add no
functionality of their own, but are purely translated from the input
string  down to the corresponding value expression, for example the
input string &lsquo;<samp>cash</samp>&rsquo; is translated to &lsquo;<samp>(account
=~ /cash/)</samp>&rsquo;.  This is a convenience layer.
</p>
</li><li> Format strings

<p>Format strings let you interpolate value expressions into strings, with
the requirement that any interpolated value have a string
representation.  Really all this does is calculate the value expression
in the current report context, call the resulting value&rsquo;s
<code>to_string()</code> method, and stuffs the result into the output string.
It also provides printf-like behavior, such as min/max width, right/left
justification, etc.
</p>
</li><li> Journal items

<p>Next is a base type shared by anything that can appear in a journal: an
item_t.  It contains details common to all such parsed entities, like
what file and line it was found on, etc.
</p>
</li><li> Journal posts

<p>The most numerous object found in a Journal, postings are a type of item
that contain an account, an amount, a cost, and metadata.  There are
some other complications, like the account can be marked virtual, the
amount could be an expression, etc.
</p>
</li><li> Journal transactions

<p>Postings are owned by transactions, always.  This subclass of <code>item_t</code>
knows about the date, the payee, etc.  If a date or metadata tag is
requested from a posting and it doesn&rsquo;t have that information, the
transaction is queried to see if it can provide it.
</p>
</li><li> Journal accounts

<p>Postings are also shared by accounts, though the actual memory is
managed by the transaction.  Each account knows all the postings within
it, but contains relatively little information of its own.
</p>
</li><li> The Journal object

<p>Finally, all transactions with their postings, and all accounts, are
owned by a <code>journal_t</code> object.  This is the go-to object for
querying and reporting on your data.
</p>
</li><li> Textual journal parser

<p>There is a textual parser, wholly contained in <samp>textual.cc</samp>, which
knows how to parse text into journal objects, which then get
&ldquo;finalized&rdquo; and added to the journal.  Finalization is the step that
enforces the double-entry guarantee.
</p>
</li><li> Iterators

<p>Every journal object is &ldquo;iterable&rdquo;, and these iterators are defined in
<samp>iterators.h</samp> and <samp>iterators.cc</samp>.  This iteration logic is kept out of the
basic journal objects themselves for the sake of modularity.
</p>
</li><li> Comparators

<p>Another abstraction isolated to its own layer, this class encapsulating
the comparison of journal objects, based on whatever value expression
the user passed to <samp>--sort <var>VEXPR</var></samp>.
</p>
</li><li> Temporaries

<p>Many reports bring pseudo-journal objects into existence, like postings
which report totals in a &lsquo;<samp>Total</samp>&rsquo; account.  These objects are
created and managed by a <code>temporaries_t</code> object, which gets used in
many places by the reporting filters.
</p>
</li><li> Option handling

<p>There is an option handling subsystem used by many of the layers further
down.  It makes it relatively easy for me to add new options, and to
have those option settings immediately accessible to value expressions.
</p>
</li><li> Session objects

<p>Every journal object is owned by a session, with the session providing
support for that object.  In GUI terms, this is the Controller object
for the journal Data object, where every document window would be
a separate session.  They are all owned by the global scope.
</p>
</li><li> Report objects

<p>Every time you create any report output, a report object is created to
determine what you want to see.  In the Ledger REPL, a new report object
is created every time a command is executed.  In CLI mode, only one
report object ever comes into being, as Ledger immediately exits after
displaying the results.
</p>
</li><li> Reporting filters

<p>The way Ledger generates data is this: it asks the session for the
current journal, and then creates an iterator applied to that journal.
The kind of iterator depends on the type of report.
</p>
<p>This iterator is then walked, and every object yielded from the iterator
is passed to an &ldquo;item handler&rdquo;, whose type is directly related to the
type of the iterator.
</p>
<p>There are many, many item handlers, which can be chained together.  Each
one receives an item (post, account, xact, etc.), performs some action
on it, and then passes it down to the next handler in the chain.  There
are filters which compute the running totals; that queue and sort all
the input items before playing them back out in a new order; that filter
out items which fail to match a predicate, etc.  Almost every reporting
feature in Ledger is related to one or more filters.  Looking at
<samp>filters.h</samp>, there are over 25 of them defined currently.
</p>
</li><li> The filter chain

<p>How filters get wired up, and in what order, is a complex process based
on all the various options specified by the user.  This is the job of
the chain logic, found entirely in <samp>chain.cc</samp>.  It took a really
long time to get this logic exactly right, which is why I haven&rsquo;t
exposed this layer to the Python bridge yet.
</p>
</li><li> Output modules

<p>Although filters are great and all, in the end you want to see stuff.
This is the job of special &ldquo;leaf&rdquo; filters called output modules.  They
are implemented just like a regular filter, but they don&rsquo;t have
a &ldquo;next&rdquo; filter to pass the data on down to.  Instead, they are the
end of the line and must do something with the item that results in the
user seeing something on their screen or in a file.
</p>
</li><li> Select queries

<p>Select queries know a lot about everything, even though they implement
their logic by implementing the user&rsquo;s query in terms of all the other
features thus presented.  Select queries have no functionality of their
own, they are simple a shorthand to provide access to much of Ledger&rsquo;s
functionality via a cleaner, more consistent syntax.
</p>
</li><li> The Global Scope

<p>There is a master object which owns every other objects, and this is
Ledger&rsquo;s global scope.  It creates the other objects, provides REPL
behavior for the command-line utility, etc.  In GUI terms, this is the
Application object.
</p>
</li><li> The Main Driver

<p>This creates the global scope object, performs error reporting, and
handles command-line options which must precede even the creation of the
global scope, such as <samp>--debug <var>CODE</var></samp>.
</p>
</li></ul>

<p>And that&rsquo;s Ledger in a nutshell.  All the rest are details, such as
which value expressions each journal item exposes, how many filters
currently exist, which options the report and session scopes define,
etc.
</p>
<hr>
<a name="Journal-File-Format-for-Developers"></a>
<div class="header">
<p>
Next: <a href="#Developer-Commands" accesskey="n" rel="next">Developer Commands</a>, Previous: <a href="#Internal-Design" accesskey="p" rel="prev">Internal Design</a>, Up: <a href="#Ledger-for-Developers" accesskey="u" rel="up">Ledger for Developers</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Journal-File-Format-for-Developers-1"></a>
<h3 class="section">14.2 Journal File Format for Developers</h3>

<p>This chapter offers a complete description of the journal data format,
suitable for implementers in other languages to follow.  For users, the
chapter on keeping a journal is less extensive, but more typical of
common usage (see <a href="#Keeping-a-Journal">Keeping a Journal</a>).
</p>
<p>Data is collected in the form of <em>transactions</em> which occur in one
or more <em>journal files</em>.  Each transaction, in turn, is made up of
one or more <em>postings</em>, which describe how <em>amounts</em> flow from
one <em>account</em> to another.  Here is an example of the simplest of
journal files:
</p>
<div class="smallexample">
<pre class="smallexample">2010/05/31 Just an example
    Expenses:Some:Account                $100.00
    Income:Another:Account
</pre></div>

<p>In this example, there is a transaction date, a payee, or description of
the transaction, and two postings.  The postings show movement of one
hundred dollars from an account within the Income hierarchy, to the
specified expense account.  The name and meaning of these accounts is
arbitrary, with no preferences implied, although you will find it useful
to follow standard accounting practices (see <a href="#Principles-of-Accounting-with-Ledger">Principles of Accounting with Ledger</a>).
</p>
<p>Since an amount is missing from the second posting, it is assumed to be
the inverse of the first.  This guarantees the cardinal rule of
double-entry accounting: the sum of every transaction must balance to
zero, or it is in error.  Whenever Ledger encounters a <em>null
posting</em> in a transaction, it uses it to balance the remainder.
</p>
<p>It is also typical, though not enforced, to think of the first posting
as the destination, and the final as the source.  Thus, the amount of
the first posting is typically positive.  Consider:
</p>
<div class="smallexample">
<pre class="smallexample">2010/05/31 An income transaction
    Assets:Checking       $1,000.00
    Income:Salary

2010/05/31 An expense transaction
    Expenses:Dining         $100.00
    Assets:Checking
</pre></div>

<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top">&bull; <a href="#Comments-and-meta_002ddata" accesskey="1">Comments and meta-data</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Specifying-Amounts" accesskey="2">Specifying Amounts</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Posting-costs" accesskey="3">Posting costs</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Primary-commodities" accesskey="4">Primary commodities</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
</table>

<hr>
<a name="Comments-and-meta_002ddata"></a>
<div class="header">
<p>
Next: <a href="#Specifying-Amounts" accesskey="n" rel="next">Specifying Amounts</a>, Previous: <a href="#Journal-File-Format-for-Developers" accesskey="p" rel="prev">Journal File Format for Developers</a>, Up: <a href="#Journal-File-Format-for-Developers" accesskey="u" rel="up">Journal File Format for Developers</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Comments-and-meta_002ddata-1"></a>
<h4 class="subsection">14.2.1 Comments and meta-data</h4>

<p>Comments are generally started using a &lsquo;<samp>;</samp>&rsquo;.  However, in order to
increase compatibility with other text manipulation programs and methods
three additional comment characters are valid if used at the beginning
of a line: &lsquo;<samp>#</samp>&rsquo;, &lsquo;<samp>|</samp>&rsquo;, and &lsquo;<samp>*</samp>&rsquo;.
</p>
<hr>
<a name="Specifying-Amounts"></a>
<div class="header">
<p>
Next: <a href="#Posting-costs" accesskey="n" rel="next">Posting costs</a>, Previous: <a href="#Comments-and-meta_002ddata" accesskey="p" rel="prev">Comments and meta-data</a>, Up: <a href="#Journal-File-Format-for-Developers" accesskey="u" rel="up">Journal File Format for Developers</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Specifying-Amounts-1"></a>
<h4 class="subsection">14.2.2 Specifying Amounts</h4>
<a name="index-amounts"></a>

<p>The heart of a journal is the amounts it records, and this fact is
reflected in the diversity of amount expressions allowed.  All of them
are covered here, though it must be said that sometimes, there are
multiple ways to achieve a desired result.
</p>
<p><em>Note:</em> It is important to note that there must be at least two
spaces between the end of the account and the beginning of the amount
(including a commodity designator).
</p>
<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top">&bull; <a href="#Integer-Amounts" accesskey="1">Integer Amounts</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Commoditized-Amounts" accesskey="2">Commoditized Amounts</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
</table>

<hr>
<a name="Integer-Amounts"></a>
<div class="header">
<p>
Next: <a href="#Commoditized-Amounts" accesskey="n" rel="next">Commoditized Amounts</a>, Previous: <a href="#Specifying-Amounts" accesskey="p" rel="prev">Specifying Amounts</a>, Up: <a href="#Specifying-Amounts" accesskey="u" rel="up">Specifying Amounts</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Integer-Amounts-1"></a>
<h4 class="subsubsection">14.2.2.1 Integer Amounts</h4>

<p>In the simplest form, bare decimal numbers are accepted:
</p>
<div class="smallexample">
<pre class="smallexample">2010/05/31 An income transaction
    Assets:Checking        1000.00
    Income:Salary
</pre></div>

<a name="index-uncommoditized-amounts"></a>
<p>Such amounts may only use an optional period for a decimal point.  These
are referred to as <em>integer amounts</em> or <em>uncommoditized
amounts</em>.  In most ways they are similar to <em>commoditized amounts</em>,
but for one significant difference: They always display in reports with
<em>full precision</em>.  More on this in a moment.  For now, a word must
be said about how Ledger stores numbers.
</p>
<p>Every number parsed by Ledger is stored internally as an
infinite-precision rational value.  Floating-point math is never used,
as it cannot be trusted to maintain precision of values.  So, in the
case of &lsquo;<samp>1000.00</samp>&rsquo; above, the internal value is &lsquo;<samp>100000/100</samp>&rsquo;.
</p>
<p>While rational numbers are great at not losing precision, the question
arises: How should they be displayed?  A number like &lsquo;<samp>100000/100</samp>&rsquo;
is no problem, since it represents a clean decimal fraction.  But what
about when the number &lsquo;<samp>1/1</samp>&rsquo; is divided by three?  How should one
print &lsquo;<samp>1/3</samp>&rsquo;, an infinitely repeating decimal?
</p>
<p>Ledger gets around this problem by rendering rationals into decimal at
the last possible moment, and only for display.  As such, some
rounding must, at times, occur.  If this rounding would affect the
calculation of a running total, special accommodation postings are
generated to make you aware it has happened.  In practice, it happens
rarely, but even then it does not reflect adjustment of the
<em>internal amount</em>, only the displayed amount.
</p>
<p>What has still not been answered is how Ledger rounds values.  Should
&lsquo;<samp>1/3</samp>&rsquo; be printed as &lsquo;<samp>0.33</samp>&rsquo; or &lsquo;<samp>0.33333</samp>&rsquo;?  For
commoditized amounts, the number of decimal places is decided by
observing how each commodity is used; but in the case of integer
amounts, an arbitrary factor must be chosen.  Initially, this factor
is six.  Thus, &lsquo;<samp>1/3</samp>&rsquo; is printed back as &lsquo;<samp>0.333333</samp>&rsquo;.
Further, this rounding factor becomes associated with each particular
value, and is carried through mathematical operations.  For example,
if that particular number were multiplied by itself, the decimal
precision of the result would be twelve.  Addition and subtraction do
not affect precision.
</p>
<p>Since each integer amount retains its own display precision, this is
called <em>full precision</em>, as opposed to commoditized amounts, which
always look to their commodity to know what precision they should
round to, and so use <em>commodity precision</em>.
</p>
<hr>
<a name="Commoditized-Amounts"></a>
<div class="header">
<p>
Previous: <a href="#Integer-Amounts" accesskey="p" rel="prev">Integer Amounts</a>, Up: <a href="#Specifying-Amounts" accesskey="u" rel="up">Specifying Amounts</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Commoditized-Amounts-1"></a>
<h4 class="subsubsection">14.2.2.2 Commoditized Amounts</h4>

<p>A <em>commoditized amount</em> is an integer amount which has an
associated commodity.  This commodity can appear before or after the
amount, and may or may not be separated from it by a space.  Most
characters are allowed in a commodity name, except for the following:
</p>
<ul>
<li> Any kind of white-space
</li><li> Numerical digits
</li><li> Punctuation: <code>.,;:?!</code>
</li><li> Mathematical and logical operators: <code>-+*/^&amp;|=</code>
</li><li> Bracketing characters: <code>&lt;&gt;[]()</code>{}
</li><li> The at symbol: <code>@</code>
</li></ul>

<p>And yet, any of these may appear in a commodity name if it is
surrounded by double quotes, for example:
</p>
<div class="smallexample">
<pre class="smallexample">100 &quot;EUN+133&quot;
</pre></div>

<p>If a <em>quoted commodity</em> is found, it is displayed in quotes as
well, to avoid any confusion as to which part is the amount, and which
part is the commodity.
</p>
<p>Another feature of commoditized amounts is that they are reported back
in the same form as parsed.  If you specify dollar amounts using
&lsquo;<samp>$100</samp>&rsquo;, they will print the same; likewise with &lsquo;<samp>100 $</samp>&rsquo; or
&lsquo;<samp>$100.000</samp>&rsquo;.  You may even use decimal commas, such as
&lsquo;<samp>$100,00</samp>&rsquo;, or thousand-marks, as in &lsquo;<samp>$10,000.00</samp>&rsquo;.
</p>
<p>These display characteristics become associated with the commodity,
with the result being that all amounts of the same commodity are
reported consistently.  Where this is most noticeable is the
<em>display precision</em>, which is determined by the most precise value
seen for a given commodity&mdash;in most cases.
</p>
<p>Ledger makes a distinction between <em>observed amounts</em> and
unobserved amounts.  An observed amount is critiqued by Ledger to
determine how amounts using that commodity should be displayed;
unobserved amounts are significant in their value only&mdash;no matter how
they are specified, it does not change how other amounts in that
commodity will be displayed.
</p>
<p>An example of this is found in cost expressions, covered next.
</p>
<hr>
<a name="Posting-costs"></a>
<div class="header">
<p>
Next: <a href="#Primary-commodities" accesskey="n" rel="next">Primary commodities</a>, Previous: <a href="#Specifying-Amounts" accesskey="p" rel="prev">Specifying Amounts</a>, Up: <a href="#Journal-File-Format-for-Developers" accesskey="u" rel="up">Journal File Format for Developers</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Posting-costs-1"></a>
<h4 class="subsection">14.2.3 Posting costs</h4>

<p>You have seen how to specify either a commoditized or an integer
amount for a posting.  But what if the amount you paid for something
was in one commodity, and the amount received was another?  There are
two main ways to express this:
</p>
<div class="smallexample">
<pre class="smallexample">2010/05/31 Farmer's Market
    Assets:My Larder           100 apples
    Assets:Checking                -$20.00
</pre></div>

<p>In this example, you have paid twenty dollars for one hundred apples.
The cost to you is twenty cents per apple, and Ledger calculates this
implied cost for you.  You can also make the cost explicit using a
<em>cost amount</em>:
</p>
<div class="smallexample">
<pre class="smallexample">2010/05/31 Farmer's Market
    Assets:My Larder           100 apples @ $0.200000
    Assets:Checking
</pre></div>

<p>Here the <em>per-unit cost</em> is given explicitly in the form of a cost
amount; and since cost amounts are <em>unobserved</em>, the use of six
decimal places has no effect on how dollar amounts are displayed in
the final report.  You can also specify the <em>total cost</em>:
</p>
<div class="smallexample">
<pre class="smallexample">2010/05/31 Farmer's Market
    Assets:My Larder           100 apples @@ $20
    Assets:Checking
</pre></div>

<p>These three forms have identical meaning.  In most cases the first is
preferred, but the second two are necessary when more than two
postings are involved:
</p>
<div class="smallexample">
<pre class="smallexample">2010/05/31 Farmer's Market
    Assets:My Larder           100 apples        @ $0.200000
    Assets:My Larder           100 pineapples    @ $0.33
    Assets:My Larder           100 &quot;crab apples&quot; @ $0.04
    Assets:Checking
</pre></div>

<p>Here the implied cost is &lsquo;<samp>$57.00</samp>&rsquo;, which is entered into the null
posting automatically so that the transaction balances.
</p>
<hr>
<a name="Primary-commodities"></a>
<div class="header">
<p>
Previous: <a href="#Posting-costs" accesskey="p" rel="prev">Posting costs</a>, Up: <a href="#Journal-File-Format-for-Developers" accesskey="u" rel="up">Journal File Format for Developers</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Primary-commodities-1"></a>
<h4 class="subsection">14.2.4 Primary commodities</h4>
<a name="index-_002d_002dmarket-7"></a>
<a name="index-_002d_002dbasis-4"></a>

<p>In every transaction involving more than one commodity, there is
always one which is the <em>primary commodity</em>.  This commodity
should be thought of as the exchange commodity, or the commodity used
to buy and sell units of the other commodity.  In the fruit examples
above, dollars are the primary commodity.  This is decided by Ledger
based on the placement of the commodity in the transaction:
</p>
<div class="smallexample">
<pre class="smallexample">2010/05/31 Sample Transaction
    Expenses               100 secondary
    Assets                  -50 primary

2010/05/31 Sample Transaction
    Expenses               100 secondary @ 0.5 primary
    Assets

2010/05/31 Sample Transaction
    Expenses               100 secondary @@ 50 primary
    Assets
</pre></div>

<p>The only case where knowledge of primary versus secondary comes into
play is in reports that use the <samp>--market (-V)</samp> or
<samp>--basis (-B)</samp> options.  With these, only primary commodities are
shown.
</p>
<p>If a transaction uses only one commodity, this commodity is also
considered a primary.  In fact, when Ledger goes about ensuring that
all transactions balance to zero, it only ever asks this of primary
commodities.
</p>
<hr>
<a name="Developer-Commands"></a>
<div class="header">
<p>
Next: <a href="#Ledger-Development-Environment" accesskey="n" rel="next">Ledger Development Environment</a>, Previous: <a href="#Journal-File-Format-for-Developers" accesskey="p" rel="prev">Journal File Format for Developers</a>, Up: <a href="#Ledger-for-Developers" accesskey="u" rel="up">Ledger for Developers</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Developer-Commands-1"></a>
<h3 class="section">14.3 Developer Commands</h3>

<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top">&bull; <a href="#echo" accesskey="1"><code>echo</code></a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#reload" accesskey="2"><code>reload</code></a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#source" accesskey="3"><code>source</code></a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Debug-Options" accesskey="4">Debug Options</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Pre_002dCommands" accesskey="5">Pre-Commands</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
</table>

<hr>
<a name="echo"></a>
<div class="header">
<p>
Next: <a href="#reload" accesskey="n" rel="next"><code>reload</code></a>, Previous: <a href="#Developer-Commands" accesskey="p" rel="prev">Developer Commands</a>, Up: <a href="#Developer-Commands" accesskey="u" rel="up">Developer Commands</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="echo-1"></a>
<h4 class="subsection">14.3.1 <code>echo</code></h4>
<a name="index-echo"></a>

<p>This command simply echoes its argument back to the output.
</p>
<hr>
<a name="reload"></a>
<div class="header">
<p>
Next: <a href="#source" accesskey="n" rel="next"><code>source</code></a>, Previous: <a href="#echo" accesskey="p" rel="prev"><code>echo</code></a>, Up: <a href="#Developer-Commands" accesskey="u" rel="up">Developer Commands</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="reload-1"></a>
<h4 class="subsection">14.3.2 <code>reload</code></h4>
<a name="index-reload"></a>

<p>Forces ledger to reload any journal files.  This function exists to
support external programs controlling a running ledger process and does
nothing for a command-line user.
</p>
<hr>
<a name="source"></a>
<div class="header">
<p>
Next: <a href="#Debug-Options" accesskey="n" rel="next">Debug Options</a>, Previous: <a href="#reload" accesskey="p" rel="prev"><code>reload</code></a>, Up: <a href="#Developer-Commands" accesskey="u" rel="up">Developer Commands</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="source-1"></a>
<h4 class="subsection">14.3.3 <code>source</code></h4>
<a name="index-source"></a>

<p>The <code>source</code> command takes a journal file as an argument and
parses it checking for errors; no other reports are generated, and no
other arguments are necessary.  Ledger will return success if no errors
are found.
</p>
<hr>
<a name="Debug-Options"></a>
<div class="header">
<p>
Next: <a href="#Pre_002dCommands" accesskey="n" rel="next">Pre-Commands</a>, Previous: <a href="#source" accesskey="p" rel="prev"><code>source</code></a>, Up: <a href="#Developer-Commands" accesskey="u" rel="up">Developer Commands</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Debug-Options-1"></a>
<h4 class="subsection">14.3.4 Debug Options</h4>

<p>These options are primarily for Ledger developers, but may be of some
use to a user trying something new.
</p>
<dl compact="compact">
<dt><samp>--args-only</samp>
<a name="index-_002d_002dargs_002donly-1"></a>
</dt>
<dd><p>Ignore init files and environment variables for the ledger run.
</p>
</dd>
<dt><samp>--debug <var>CODE</var></samp>
<a name="index-_002d_002ddebug-CODE-1"></a>
</dt>
<dd><p>If Ledger has been built with debug options this will provide extra
data during the run.  The following are the available <var>CODES</var> to
debug:
</p>
<table>
<tr><td width="32%"><code>account.display</code></td><td width="43%"><code>draft.xact</code></td><td width="27%"><code>option.names</code></td></tr>
<tr><td width="32%"><code>account.sorted</code></td><td width="43%"><code>expr.calc</code></td><td width="27%"><code>org.next_amount</code></td></tr>
<tr><td width="32%"><code>amount.commodities</code></td><td width="43%"><code>expr.compile</code></td><td width="27%"><code>org.next_total</code></td></tr>
<tr><td width="32%"><code>amount.convert</code></td><td width="43%"><code>expr.merged.compile</code></td><td width="27%"><code>parser.error</code></td></tr>
<tr><td width="32%"><code>amount.is_zero</code></td><td width="43%"><code>filters.changed_value</code></td><td width="27%"><code>pool.commodities</code></td></tr>
<tr><td width="32%"><code>amount.parse</code></td><td width="43%"><code>filters.changed_value.rounding</code></td><td width="27%"><code>post.assign</code></td></tr>
<tr><td width="32%"><code>amount.price</code></td><td width="43%"><code>filters.collapse</code></td><td width="27%"><code>python.init</code></td></tr>
<tr><td width="32%"><code>amount.refs</code></td><td width="43%"><code>filters.forecast</code></td><td width="27%"><code>python.interp</code></td></tr>
<tr><td width="32%"><code>amount.roundto</code></td><td width="43%"><code>filters.interval</code></td><td width="27%"><code>query.mask</code></td></tr>
<tr><td width="32%"><code>amount.truncate</code></td><td width="43%"><code>filters.revalued</code></td><td width="27%"><code>report.predicate</code></td></tr>
<tr><td width="32%"><code>amount.unround</code></td><td width="43%"><code>format.abbrev</code></td><td width="27%"><code>scope.search</code></td></tr>
<tr><td width="32%"><code>annotate.less</code></td><td width="43%"><code>format.expr</code></td><td width="27%"><code>scope.symbols</code></td></tr>
<tr><td width="32%"><code>archive.journal</code></td><td width="43%"><code>generate.post</code></td><td width="27%"><code>select.parse</code></td></tr>
<tr><td width="32%"><code>auto.columns</code></td><td width="43%"><code>generate.post.string</code></td><td width="27%"><code>textual.include</code></td></tr>
<tr><td width="32%"><code>budget.generate</code></td><td width="43%"><code>history.find</code></td><td width="27%"><code>textual.parse</code></td></tr>
<tr><td width="32%"><code>commodity.annotated.strip</code></td><td width="43%"><code>history.map</code></td><td width="27%"><code>timelog</code></td></tr>
<tr><td width="32%"><code>commodity.annotations</code></td><td width="43%"><code>item.meta</code></td><td width="27%"><code>times.epoch</code></td></tr>
<tr><td width="32%"><code>commodity.compare</code></td><td width="43%"><code>ledger.read</code></td><td width="27%"><code>times.interval</code></td></tr>
<tr><td width="32%"><code>commodity.download</code></td><td width="43%"><code>ledger.validate</code></td><td width="27%"><code>times.parse</code></td></tr>
<tr><td width="32%"><code>commodity.exchange</code></td><td width="43%"><code>lookup</code></td><td width="27%"><code>value.sort</code></td></tr>
<tr><td width="32%"><code>commodity.price.find</code></td><td width="43%"><code>lookup.account</code></td><td width="27%"><code>value.storage.refcount</code></td></tr>
<tr><td width="32%"><code>commodity.prices.add</code></td><td width="43%"><code>mask.match</code></td><td width="27%"><code>xact.extend</code></td></tr>
<tr><td width="32%"><code>commodity.prices.find</code></td><td width="43%"><code>memory.debug</code></td><td width="27%"><code>xact.extend.cleared</code></td></tr>
<tr><td width="32%"><code>csv.mappings</code></td><td width="43%"><code>op.memory</code></td><td width="27%"><code>xact.extend.fail</code></td></tr>
<tr><td width="32%"><code>csv.parse</code></td><td width="43%"><code>option.args</code></td><td width="27%"><code>xact.finalize</code></td></tr>
</table>
<p>&nbsp;</p>
</dd>
<dt><samp>--trace <var>INT</var></samp>
<a name="index-_002d_002dtrace-INT-1"></a>
</dt>
<dd><p>Enable tracing.  The <var>INT</var> specifies the level of trace desired:
</p>
<table>
<tr><td width="30%"><code>LOG_OFF</code></td><td width="70%">0</td></tr>
<tr><td width="30%"><code>LOG_CRIT</code></td><td width="70%">1</td></tr>
<tr><td width="30%"><code>LOG_FATAL</code></td><td width="70%">2</td></tr>
<tr><td width="30%"><code>LOG_ASSERT</code></td><td width="70%">3</td></tr>
<tr><td width="30%"><code>LOG_ERROR</code></td><td width="70%">4</td></tr>
<tr><td width="30%"><code>LOG_VERIFY</code></td><td width="70%">5</td></tr>
<tr><td width="30%"><code>LOG_WARN</code></td><td width="70%">6</td></tr>
<tr><td width="30%"><code>LOG_INFO</code></td><td width="70%">7</td></tr>
<tr><td width="30%"><code>LOG_EXCEPT</code></td><td width="70%">8</td></tr>
<tr><td width="30%"><code>LOG_DEBUG</code></td><td width="70%">9</td></tr>
<tr><td width="30%"><code>LOG_TRACE</code></td><td width="70%">10</td></tr>
<tr><td width="30%"><code>LOG_ALL</code></td><td width="70%">11</td></tr>
</table>
<p>&nbsp;</p>
</dd>
<dt><samp>--verbose</samp>
<a name="index-_002d_002dverbose-1"></a>
</dt>
<dt><samp>-v</samp>
<a name="index-_002dv-1"></a>
</dt>
<dd><p>Print detailed information on the execution of Ledger.
</p>
</dd>
<dt><samp>--verify</samp>
<a name="index-_002d_002dverify-1"></a>
</dt>
<dd><p>Enable additional assertions during run-time.  This causes a significant
slowdown.  When combined with <samp>--debug <var>CODE</var></samp> ledger will
produce memory trace information.
</p>
</dd>
<dt><samp>--verify-memory</samp>
<a name="index-_002d_002dverify_002dmemory-1"></a>
</dt>
<dd><p>Verify that every constructed object is properly destructed.  This is for
debugging purposes only.
</p>
</dd>
<dt><samp>--version</samp>
<a name="index-_002d_002dversion-3"></a>
</dt>
<dd><p>Print version information and exit.
</p>
</dd>
</dl>

<hr>
<a name="Pre_002dCommands"></a>
<div class="header">
<p>
Previous: <a href="#Debug-Options" accesskey="p" rel="prev">Debug Options</a>, Up: <a href="#Developer-Commands" accesskey="u" rel="up">Developer Commands</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Pre_002dCommands-1"></a>
<h4 class="subsection">14.3.5 Pre-Commands</h4>
<a name="index-pre_002dcommands"></a>

<p>Pre-commands are useful when you aren&rsquo;t sure how a command or option
will work.  The difference between a pre-command and a regular command
is that pre-commands ignore the journal data file completely, nor is
the user&rsquo;s init file read.
</p>
<dl compact="compact">
<dt><code>eval <var>VEXPR</var></code>
<a name="index-eval-VEXPR"></a>
</dt>
<dd><p>Evaluate the given value expression against the model transaction.
</p>
</dd>
<dt><code>format <var>FORMAT_STRING</var></code>
<a name="index-format-FORMAT_005fSTRING"></a>
</dt>
<dd><p>Print details of how ledger uses the given formatting description and
apply it against a model transaction.
</p>
</dd>
<dt><code>generate</code>
<a name="index-generate"></a>
</dt>
<dd><p>Randomly generates syntactically valid Ledger data from a seed.  Used
by the &lsquo;<samp>GenerateTests</samp>&rsquo; harness for development testing.
</p>
</dd>
<dt><code>parse <var>VEXPR</var></code>
<a name="index-parse-VEXPR"></a>
</dt>
<dt><code>expr <var>VEXPR</var></code>
<a name="index-expr-VEXPR"></a>
</dt>
<dd><p>Print details of how ledger uses the given value expression description
and apply it against a model transaction.
</p>
</dd>
<dt><code>period <var>PERIOD_EXPRESSION</var></code>
<a name="index-period-PERIOD_005fEXPRESSION"></a>
</dt>
<dd><p>Evaluate the given period and report how Ledger interprets it:
</p>
<div class="smallexample">
<pre class="smallexample">$ ledger period &quot;this year&quot;  --now 2011-01-01
</pre></div>
<div class="smallexample">
<pre class="smallexample">--- Period expression tokens ---
TOK_THIS: this
TOK_YEAR: year
END_REACHED: &lt;EOF&gt;

--- Before stabilization ---
   range: in year 2011

--- After stabilization ---
   range: in year 2011
   start: 11-Jan-01
  finish: 12-Jan-01

--- Sample dates in range (max. 20) ---
 1: 11-Jan-01
</pre></div>

</dd>
<dt><code>query</code>
<a name="index-query"></a>
</dt>
<dt><code>args</code>
<a name="index-args"></a>
</dt>
<dd><p>Evaluate the given arguments and report how Ledger interprets it against
the following model transaction:
</p>
<div class="smallexample">
<pre class="smallexample">$ ledger query &quot;/Book/&quot;
</pre></div>
<div class="smallexample">
<pre class="smallexample">--- Input arguments ---
(&quot;/Book/&quot;)

--- Context is first posting of the following transaction ---
2004/05/27 Book Store
    ; This note applies to all postings. :SecondTag:
    Expenses:Books                 20 BOOK @ $10
    ; Metadata: Some Value
    ; Typed:: $100 + $200
    ; :ExampleTag:
    ; Here follows a note describing the posting.
    Liabilities:MasterCard        $-200.00

--- Input expression ---
(account =~ /Book/)

--- Text as parsed ---
(account =~ /Book/)

--- Expression tree ---
0x7fd639c0da40    O_MATCH (1)
0x7fd639c10170     IDENT: account (1)
0x7fd639c10780     VALUE: /Book/ (1)

--- Compiled tree ---
0x7fd639c10520    O_MATCH (1)
0x7fd639c0d6c0     IDENT: account (1)
0x7fd639c0d680      FUNCTION (1)
0x7fd639c10780     VALUE: /Book/ (1)

--- Calculated value ---
true
</pre></div>

</dd>
<dt><code>script</code>
<a name="index-script"></a>
</dt>
<dd><p><small>UNDOCUMENTED</small>! Please help by contributing documentation for this feature.
</p>
</dd>
<dt><code>template</code>
<a name="index-template"></a>
</dt>
<dd><p>Shows the insertion template that the <code>xact</code> sub-command
generates.  This is a debugging command.
</p>
</dd>
</dl>

<hr>
<a name="Ledger-Development-Environment"></a>
<div class="header">
<p>
Previous: <a href="#Developer-Commands" accesskey="p" rel="prev">Developer Commands</a>, Up: <a href="#Ledger-for-Developers" accesskey="u" rel="up">Ledger for Developers</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Ledger-Development-Environment-1"></a>
<h3 class="section">14.4 Ledger Development Environment</h3>

<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top">&bull; <a href="#acprep-build-configuration-tool" accesskey="1"><samp>acprep</samp> build configuration tool</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Testing-Framework" accesskey="2">Testing Framework</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
</table>

<hr>
<a name="acprep-build-configuration-tool"></a>
<div class="header">
<p>
Next: <a href="#Testing-Framework" accesskey="n" rel="next">Testing Framework</a>, Previous: <a href="#Ledger-Development-Environment" accesskey="p" rel="prev">Ledger Development Environment</a>, Up: <a href="#Ledger-Development-Environment" accesskey="u" rel="up">Ledger Development Environment</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="acprep-build-configuration-tool-1"></a>
<h4 class="subsection">14.4.1 <samp>acprep</samp> build configuration tool</h4>

<hr>
<a name="Testing-Framework"></a>
<div class="header">
<p>
Previous: <a href="#acprep-build-configuration-tool" accesskey="p" rel="prev"><samp>acprep</samp> build configuration tool</a>, Up: <a href="#Ledger-Development-Environment" accesskey="u" rel="up">Ledger Development Environment</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Testing-Framework-1"></a>
<h4 class="subsection">14.4.2 Testing Framework</h4>

<p>Ledger source ships with a fairly complete set of tests to verify that
all is well, and no old errors have resurfaced.  Tests are run
individually with <samp>ctest</samp>.  All tests can be run using <code>make
check</code> or <code>ninja check</code> depending on which build tool you prefer.
</p>
<p>Once built, the ledger executable resides under the <samp>build</samp>
subdirectory in the source tree.  Tests are built and stored in the
<samp>test</samp> subdirectory for the build.  For example,
<samp>~/ledger/build/ledger/opt/test</samp>.
</p>
<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top">&bull; <a href="#Running-Tests" accesskey="1">Running Tests</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Writing-Tests" accesskey="2">Writing Tests</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
</table>

<hr>
<a name="Running-Tests"></a>
<div class="header">
<p>
Next: <a href="#Writing-Tests" accesskey="n" rel="next">Writing Tests</a>, Previous: <a href="#Testing-Framework" accesskey="p" rel="prev">Testing Framework</a>, Up: <a href="#Testing-Framework" accesskey="u" rel="up">Testing Framework</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Running-Tests-1"></a>
<h4 class="subsubsection">14.4.2.1 Running Tests</h4>

<p>The complete test suite can be run from the build directory using the
check option for the build tool you use.  For example, <code>make
check</code>.  The entire test suit lasts around a minute for the optimized
built and many times longer for the debug version.  While developing
and debugging, running individual tests can save a great deal of time.
</p>
<p>Individual tests can be run from the <samp>test</samp> subdirectory of the
build location.  To execute a single test use <code>ctest -V -R regex</code>,
where the regex matches the name of the test you want to build.
</p>
<p>There are nearly 300 tests stored under the <samp>test</samp> subdirectory
in the main source distribution.  They are broken into two broad
categories, baseline and regression.  To run the <samp>5FBF2ED8</samp> test,
for example, issue <code>ctest -V -R &quot;5FB&quot;</code>.
</p>
<hr>
<a name="Writing-Tests"></a>
<div class="header">
<p>
Previous: <a href="#Running-Tests" accesskey="p" rel="prev">Running Tests</a>, Up: <a href="#Testing-Framework" accesskey="u" rel="up">Testing Framework</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Writing-Tests-1"></a>
<h4 class="subsubsection">14.4.2.2 Writing Tests</h4>

<p>To write a new test first decide to which broad category the test belongs:
baseline or regression.  Depending on the category tests are named differently
baseline tests are prefixed with their type, e.g. &lsquo;<samp>cmd</samp>&rsquo;
(see <a href="#Baseline-Test-Types">Baseline Test Types</a> for valid types), whereas regressions are either
named after the bug id, e.g. &lsquo;<samp>1234.test</samp>&rsquo; or uuid &lsquo;<samp>91416D62.test</samp>&rsquo;.
In case several test files belong to the same bug number the files by appending
<code>_X</code> where &lsquo;<samp>X</samp>&rsquo; is the number of the test, e.g. &lsquo;<samp>1234_1.test</samp>&rsquo;,
&lsquo;<samp>1234_2.test</samp>&rsquo;.
</p>
<p>Baseline Test Types:
<a name="Baseline-Test-Types"></a></p><dl compact="compact">
<dt><code>cmd</code></dt>
<dd><p>Ledger commands like <code>register</code> or <code>balance</code>
</p></dd>
<dt><code>dir</code></dt>
<dd><p>Ledger directives like <code>account</code> or <code>alias</code>
</p></dd>
<dt><code>feat</code></dt>
<dd><p>Ledger features such as balance assertions in journal file
</p></dd>
<dt><code>opt</code></dt>
<dd><p>Ledger options such as <samp>--period</samp> or <samp>--format</samp>
</p></dd>
</dl>

<p>A ledger test file contains three sections:
</p>
<ol>
<li> the journal data used for the test, this can be empty in certain
scenarios
</li><li> the ledger command-line options used for the test
</li><li> the expected output
</li></ol>

<p>Ledger has a special command directive for tests, everything between
<code>test</code> and <code>end test</code> is treated like a comment, so every
Ledger test is automatically a valid Ledger file.
The test scripts take the remainder of the <code>test</code> line and use
it as command-line arguments for ledger, the text enclosed in <code>test</code>
and <code>end test</code> is expected output, for example:
</p>
<div class="smallexample">
<pre class="smallexample">; This is the journal data
year 2014
12/24 (C0d3) Santa Claus
  Assets:Bank          -150,00
  Expenses:Presents

; The following line specifies the ledger command-line options for this test and
; everything between the next line and `end test` specifies the expected output
test reg --payee=code
14-Dec-24 C0d3                  Assets:Bank                -150,00     -150,00
14-Dec-24 C0d3                  Expenses:Presents           150,00            0
end test
</pre></div>

<p>When it is necessary to test for errors printed to <code>stderr</code> redirect
the test output by adding <code>-&gt;</code> to the <code>test</code> line and match the
expected error text in an <code>__ERROR__</code> section:
</p>
<div class="smallexample">
<pre class="smallexample">2014/01/01 * Acme Corporation
  Assets:Bank:Checking        1.000,00
  [Fund:Vacation]               300,00
  [Fund:Studies]                600,00
  Income:Salary              -2.000,00

test reg -&gt;
__ERROR__
While parsing file &quot;$FILE&quot;, line 5:
While balancing transaction from &quot;$FILE&quot;, lines 1-5:
&gt; 2014/01/01 * Acme Corporation
&gt;   Assets:Bank:Checking        1.000,00
&gt;   [Fund:Vacation]               300,00
&gt;   [Fund:Studies]                600,00
&gt;   Income:Salary              -2.000,00
Unbalanced remainder is:
            -100,00
Amount to balance against:
           1.900,00
Error: Transaction does not balance
end test
</pre></div>

<p>A special <code>$FILE</code> variable can be used to match the journal filename
used during the test.
</p>
<p>To add new tests to the test suite use the rebuild_cache option for the
build tool you use, for example <code>make rebuild_cache</code>, now the
new tests can be run as documented in <a href="#Running-Tests">Running Tests</a>.
</p>
<hr>
<a name="Major-Changes-from-version-2_002e6"></a>
<div class="header">
<p>
Next: <a href="#Example-Journal-File" accesskey="n" rel="next">Example Journal File</a>, Previous: <a href="#Ledger-for-Developers" accesskey="p" rel="prev">Ledger for Developers</a>, Up: <a href="#Top" accesskey="u" rel="up">Top</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Major-Changes-from-version-2_002e6-1"></a>
<h2 class="chapter">15 Major Changes from version 2.6</h2>

<p>The following have been removed from Ledger 3.0:
</p>
<ul>
<li> OFX support.

</li><li> GnuCash file import.

</li><li> The option <samp>--performance (-g)</samp>.

</li><li> The balance report now defaults to showing all relevant accounts.  This
is the opposite of 2.x.  That is, <code>bal</code> in 3.0 does what &lsquo;<samp>-s
bal</samp>&rsquo; did in 2.x.  To see 2.6 behavior, use <samp>--collapse (-n)</samp>
option in 3.0, like &lsquo;<samp>bal -n</samp>&rsquo;.  The <samp>--subtotal (-s)</samp> option
no longer has any effect on balance reports.

</li></ul>

<p>The following are deprecated in Ledger 3.0:
</p>
<ul>
<li> Single character value expressions are deprecated and should be changed
to the new value expressions available in 3.0

</li><li> The following environment variables have been renamed in Ledger 3.0:
<dl compact="compact">
<dt><code>LEDGER</code></dt>
<dd><p>is now <code>LEDGER_FILE</code>,
</p></dd>
<dt><code>LEDGER_INIT</code></dt>
<dd><p>is now <code>LEDGER_INIT_FILE</code>,
</p></dd>
<dt><code>PRICE_HIST</code></dt>
<dd><p>is now <code>LEDGER_PRICE_DB</code>,
</p></dd>
<dt><code>PRICE_EXP</code></dt>
<dd><p>is now <code>LEDGER_PRICE_EXP</code>.
</p></dd>
</dl>

</li></ul>

<hr>
<a name="Example-Journal-File"></a>
<div class="header">
<p>
Next: <a href="#Miscellaneous-Notes" accesskey="n" rel="next">Miscellaneous Notes</a>, Previous: <a href="#Major-Changes-from-version-2_002e6" accesskey="p" rel="prev">Major Changes from version 2.6</a>, Up: <a href="#Top" accesskey="u" rel="up">Top</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Example-Journal-File-1"></a>
<h2 class="appendix">Appendix A Example Journal File</h2>

<p>The following journal file is included with the source distribution of
ledger.  It is called <samp>drewr3.dat</samp> and exhibits many ledger
features, include automatic and virtual transactions,
</p>
<div class="smallexample">
<pre class="smallexample">; -*- ledger -*-

= /^Income/
  (Liabilities:Tithe)                    0.12

;~ Monthly
;  Assets:Checking                     $500.00
;  Income:Salary

;~ Monthly
;   Expenses:Food  $100
;   Assets

2010/12/01 * Checking balance
  Assets:Checking                   $1,000.00
  Equity:Opening Balances

2010/12/20 * Organic Co-op
  Expenses:Food:Groceries             $ 37.50  ; [=2011/01/01]
  Expenses:Food:Groceries             $ 37.50  ; [=2011/02/01]
  Expenses:Food:Groceries             $ 37.50  ; [=2011/03/01]
  Expenses:Food:Groceries             $ 37.50  ; [=2011/04/01]
  Expenses:Food:Groceries             $ 37.50  ; [=2011/05/01]
  Expenses:Food:Groceries             $ 37.50  ; [=2011/06/01]
  Assets:Checking                   $ -225.00

2010/12/28=2011/01/01 Acme Mortgage
  Liabilities:Mortgage:Principal    $  200.00
  Expenses:Interest:Mortgage        $  500.00
  Expenses:Escrow                   $  300.00
  Assets:Checking                  $ -1000.00

2011/01/02 Grocery Store
  Expenses:Food:Groceries             $ 65.00
  Assets:Checking

2011/01/05 Employer
  Assets:Checking                   $ 2000.00
  Income:Salary

2011/01/14 Bank
  ; Regular monthly savings transfer
  Assets:Savings                     $ 300.00
  Assets:Checking

2011/01/19 Grocery Store
  Expenses:Food:Groceries             $ 44.00 ; hastag: not block
  Assets:Checking

2011/01/25 Bank
  ; Transfer to cover car purchase
  Assets:Checking                  $ 5,500.00
  Assets:Savings
  ; :nobudget:

apply tag hastag: true
apply tag nestedtag: true
2011/01/25 Tom's Used Cars
  Expenses:Auto                    $ 5,500.00
  ; :nobudget:
  Assets:Checking

2011/01/27 Book Store
  Expenses:Books                       $20.00
  Liabilities:MasterCard
end tag
2011/12/01 Sale
  Assets:Checking:Business            $ 30.00
  Income:Sales
end tag
</pre></div>

<hr>
<a name="Miscellaneous-Notes"></a>
<div class="header">
<p>
Next: <a href="#Concepts-Index" accesskey="n" rel="next">Concepts Index</a>, Previous: <a href="#Example-Journal-File" accesskey="p" rel="prev">Example Journal File</a>, Up: <a href="#Top" accesskey="u" rel="up">Top</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Miscellaneous-Notes-1"></a>
<h2 class="appendix">Appendix B Miscellaneous Notes</h2>

<p>Various notes from the discussion list that I haven&rsquo;t incorporated in
to the main body of the documentation.
</p>
<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top">&bull; <a href="#Cookbook" accesskey="1">Cookbook</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
</table>

<hr>
<a name="Cookbook"></a>
<div class="header">
<p>
Previous: <a href="#Miscellaneous-Notes" accesskey="p" rel="prev">Miscellaneous Notes</a>, Up: <a href="#Miscellaneous-Notes" accesskey="u" rel="up">Miscellaneous Notes</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Cookbook-1"></a>
<h3 class="section">B.1 Cookbook</h3>

<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top">&bull; <a href="#Invoking-Ledger" accesskey="1">Invoking Ledger</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Ledger-Files" accesskey="2">Ledger Files</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
</table>

<hr>
<a name="Invoking-Ledger"></a>
<div class="header">
<p>
Next: <a href="#Ledger-Files" accesskey="n" rel="next">Ledger Files</a>, Previous: <a href="#Cookbook" accesskey="p" rel="prev">Cookbook</a>, Up: <a href="#Cookbook" accesskey="u" rel="up">Cookbook</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Invoking-Ledger-1"></a>
<h4 class="subsection">B.1.1 Invoking Ledger</h4>


<div class="smallexample">
<pre class="smallexample">$ ledger --group-by &quot;tag('trip')&quot; bal
</pre></div>
<div class="smallexample">
<pre class="smallexample">$ ledger cleared VWCU NFCU Tithe Misentry
</pre></div>
<div class="smallexample">
<pre class="smallexample">$ ledger register Joint --uncleared
</pre></div>
<div class="smallexample">
<pre class="smallexample">$ ledger register Checking --sort d -d 'd&gt;[2011/04/01]' until 2011/05/25
</pre></div>

<hr>
<a name="Ledger-Files"></a>
<div class="header">
<p>
Previous: <a href="#Invoking-Ledger" accesskey="p" rel="prev">Invoking Ledger</a>, Up: <a href="#Cookbook" accesskey="u" rel="up">Cookbook</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Ledger-Files-1"></a>
<h4 class="subsection">B.1.2 Ledger Files</h4>

<div class="smallexample">
<pre class="smallexample">= /^Income:Taxable/
  (Liabilities:Tithe Owed)    -0.1
= /Noah/
  (Liabilities:Tithe Owed)    -0.1
= /Jonah/
  (Liabilities:Tithe Owed)    -0.1
= /Tithe/
  (Liabilities:Tithe Owed)    -1.0
</pre></div>

<hr>
<a name="Concepts-Index"></a>
<div class="header">
<p>
Next: <a href="#Commands-_0026-Options-Index" accesskey="n" rel="next">Commands &amp; Options Index</a>, Previous: <a href="#Miscellaneous-Notes" accesskey="p" rel="prev">Miscellaneous Notes</a>, Up: <a href="#Top" accesskey="u" rel="up">Top</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Concepts-Index-1"></a>
<h2 class="unnumbered">Concepts Index</h2>

<table><tr><th valign="top">Jump to: &nbsp; </th><td><a class="summary-letter" href="#Concepts-Index_cp_letter-A"><b>A</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concepts-Index_cp_letter-B"><b>B</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concepts-Index_cp_letter-C"><b>C</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concepts-Index_cp_letter-D"><b>D</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concepts-Index_cp_letter-E"><b>E</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concepts-Index_cp_letter-F"><b>F</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concepts-Index_cp_letter-G"><b>G</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concepts-Index_cp_letter-H"><b>H</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concepts-Index_cp_letter-I"><b>I</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concepts-Index_cp_letter-J"><b>J</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concepts-Index_cp_letter-L"><b>L</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concepts-Index_cp_letter-M"><b>M</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concepts-Index_cp_letter-N"><b>N</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concepts-Index_cp_letter-O"><b>O</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concepts-Index_cp_letter-P"><b>P</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concepts-Index_cp_letter-R"><b>R</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concepts-Index_cp_letter-S"><b>S</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concepts-Index_cp_letter-T"><b>T</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concepts-Index_cp_letter-U"><b>U</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concepts-Index_cp_letter-W"><b>W</b></a>
 &nbsp; 
</td></tr></table>
<table class="index-cp" border="0">
<tr><td></td><th align="left">Index Entry</th><td>&nbsp;</td><th align="left"> Section</th></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="Concepts-Index_cp_letter-A">A</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-account_002c-alias">account, alias</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Command-Directives">Command Directives</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-account_002c-meaning-of">account, meaning of</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Fat_002dfree-Accounting">Fat-free Accounting</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-accounts_002c-limiting-by">accounts, limiting by</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Register-Report">Register Report</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-accounts_002c-naming">accounts, naming</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Structuring-your-Accounts">Structuring your Accounts</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-adorned-commodity">adorned commodity</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Commodity-reporting">Commodity reporting</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-amounts">amounts</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Specifying-Amounts">Specifying Amounts</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-assertions">assertions</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Command-Directives">Command Directives</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-assertions-1">assertions</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Command-Directives">Command Directives</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-assets-and-liabilities">assets and liabilities</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Assets-and-Liabilities">Assets and Liabilities</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-automated-transaction">automated transaction</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Transactions-and-Comments">Transactions and Comments</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="Concepts-Index_cp_letter-B">B</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-balance-report">balance report</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Balance-Report">Balance Report</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-beginning-ledger">beginning ledger</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Starting-up">Starting up</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-block-comments">block comments</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Commenting-on-your-Journal">Commenting on your Journal</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-bucket">bucket</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Command-Directives">Command Directives</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-buying-stock">buying stock</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Buying-and-Selling-Stock">Buying and Selling Stock</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="Concepts-Index_cp_letter-C">C</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-cleared-report">cleared report</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Cleared-Report">Cleared Report</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-comma-separated-variable-file-reading">comma separated variable file reading</a>:</td><td>&nbsp;</td><td valign="top"><a href="#The-convert-command">The <code>convert</code> command</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-comments">comments</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Transactions-and-Comments">Transactions and Comments</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-comments-1">comments</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Command-Directives">Command Directives</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-comments-2">comments</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Command-Directives">Command Directives</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-comments_002c-block">comments, block</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Commenting-on-your-Journal">Commenting on your Journal</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-comments_002c-characters">comments, characters</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Commenting-on-your-Journal">Commenting on your Journal</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-commodity">commodity</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Currency-and-Commodities">Currency and Commodities</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-consumable-commodity-pricing">consumable commodity pricing</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Fixing-Lot-Prices">Fixing Lot Prices</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-credits-and-debits">credits and debits</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Stating-where-money-goes">Stating where money goes</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-csv-exporting">csv exporting</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Basic-Reporting-Commands">Basic Reporting Commands</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-csv-importing">csv importing</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Converting-from-other-formats">Converting from other formats</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-csv-importing-1">csv importing</a>:</td><td>&nbsp;</td><td valign="top"><a href="#The-convert-command">The <code>convert</code> command</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-currency">currency</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Currency-and-Commodities">Currency and Commodities</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-currency-symbol-display-on-windows">currency symbol display on windows</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Using-the-Windows-Command_002dLine">Using the Windows Command-Line</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="Concepts-Index_cp_letter-D">D</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-debts-are-liabilities">debts are liabilities</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Assets-and-Liabilities">Assets and Liabilities</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-depth_005fspacer">depth_spacer</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Asset-Allocation">Asset Allocation</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-display_005ftotal">display_total</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Asset-Allocation">Asset Allocation</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-double_002dentry-accounting">double-entry accounting</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Accounting-with-Ledger">Accounting with Ledger</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="Concepts-Index_cp_letter-E">E</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-effective-date-of-invoice">effective date of invoice</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Effective-Dates">Effective Dates</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-effective-dates">effective dates</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Effective-Dates">Effective Dates</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Euro-conversion">Euro conversion</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Commodity-reporting">Commodity reporting</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="Concepts-Index_cp_letter-F">F</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-FIFO_002fLIFO">FIFO/LIFO</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Commodity-reporting">Commodity reporting</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-fixated-prices">fixated prices</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Command-Directives">Command Directives</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-fixing-lot-prices">fixing lot prices</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Fixing-Lot-Prices">Fixing Lot Prices</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="Concepts-Index_cp_letter-G">G</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-Gnuplot">Gnuplot</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Visualizing-with-Gnuplot">Visualizing with Gnuplot</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="Concepts-Index_cp_letter-H">H</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-historical-prices">historical prices</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Transactions-and-Comments">Transactions and Comments</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="Concepts-Index_cp_letter-I">I</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-income-is-negative">income is negative</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Stating-where-money-goes">Stating where money goes</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-initial-equity">initial equity</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Starting-up">Starting up</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="Concepts-Index_cp_letter-J">J</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-journals">journals</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Start-a-Journal-File">Start a Journal File</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="Concepts-Index_cp_letter-L">L</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-LIFO_002fFIFO">LIFO/FIFO</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Commodity-reporting">Commodity reporting</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-limit-by-payees">limit by payees</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Controlling-the-Accounts-and-Payees">Controlling the Accounts and Payees</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-limiting-by-accounts">limiting by accounts</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Register-Report">Register Report</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="Concepts-Index_cp_letter-M">M</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-meaning-of-account">meaning of account</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Fat_002dfree-Accounting">Fat-free Accounting</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="Concepts-Index_cp_letter-N">N</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-naming-accounts">naming accounts</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Structuring-your-Accounts">Structuring your Accounts</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="Concepts-Index_cp_letter-O">O</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-opening-balance">opening balance</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Starting-up">Starting up</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="Concepts-Index_cp_letter-P">P</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-parent_002etotal">parent.total</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Asset-Allocation">Asset Allocation</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Payee-metadata-tag">Payee metadata tag</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Payee-metadata-tag">Payee metadata tag</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-periodic-transaction">periodic transaction</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Transactions-and-Comments">Transactions and Comments</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-plotting">plotting</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Visualizing-with-Gnuplot">Visualizing with Gnuplot</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-posting-format-details">posting format details</a>:</td><td>&nbsp;</td><td valign="top"><a href="#The-Most-Basic-Entry">The Most Basic Entry</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-postings">postings</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Fat_002dfree-Accounting">Fat-free Accounting</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-pre_002dcommands">pre-commands</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Pre_002dCommands">Pre-Commands</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-pre_002ddeclare-account">pre-declare account</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Command-Directives">Command Directives</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-pre_002ddeclare-commodity">pre-declare commodity</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Command-Directives">Command Directives</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-pre_002ddeclare-tag">pre-declare tag</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Command-Directives">Command Directives</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="Concepts-Index_cp_letter-R">R</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-register-report">register report</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Register-Report">Register Report</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-reimbursable-expense-tracking">reimbursable expense tracking</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Tracking-reimbursable-expenses">Tracking reimbursable expenses</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="Concepts-Index_cp_letter-S">S</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-spaces-in-postings">spaces in postings</a>:</td><td>&nbsp;</td><td valign="top"><a href="#The-Most-Basic-Entry">The Most Basic Entry</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="Concepts-Index_cp_letter-T">T</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-tags">tags</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Transactions-and-Comments">Transactions and Comments</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-transaction_002c-automated">transaction, automated</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Transactions-and-Comments">Transactions and Comments</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-transaction_002c-periodic">transaction, periodic</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Transactions-and-Comments">Transactions and Comments</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-tutorial">tutorial</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Ledger-Tutorial">Ledger Tutorial</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="Concepts-Index_cp_letter-U">U</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-uncommoditized-amounts">uncommoditized amounts</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Integer-Amounts">Integer Amounts</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="Concepts-Index_cp_letter-W">W</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-why-is-income-negative">why is income negative</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Stating-where-money-goes">Stating where money goes</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-windows-cmd_002eexe">windows cmd.exe</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Using-the-Windows-Command_002dLine">Using the Windows Command-Line</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
</table>
<table><tr><th valign="top">Jump to: &nbsp; </th><td><a class="summary-letter" href="#Concepts-Index_cp_letter-A"><b>A</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concepts-Index_cp_letter-B"><b>B</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concepts-Index_cp_letter-C"><b>C</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concepts-Index_cp_letter-D"><b>D</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concepts-Index_cp_letter-E"><b>E</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concepts-Index_cp_letter-F"><b>F</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concepts-Index_cp_letter-G"><b>G</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concepts-Index_cp_letter-H"><b>H</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concepts-Index_cp_letter-I"><b>I</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concepts-Index_cp_letter-J"><b>J</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concepts-Index_cp_letter-L"><b>L</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concepts-Index_cp_letter-M"><b>M</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concepts-Index_cp_letter-N"><b>N</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concepts-Index_cp_letter-O"><b>O</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concepts-Index_cp_letter-P"><b>P</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concepts-Index_cp_letter-R"><b>R</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concepts-Index_cp_letter-S"><b>S</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concepts-Index_cp_letter-T"><b>T</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concepts-Index_cp_letter-U"><b>U</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concepts-Index_cp_letter-W"><b>W</b></a>
 &nbsp; 
</td></tr></table>

<hr>
<a name="Commands-_0026-Options-Index"></a>
<div class="header">
<p>
Previous: <a href="#Concepts-Index" accesskey="p" rel="prev">Concepts Index</a>, Up: <a href="#Top" accesskey="u" rel="up">Top</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concepts-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Commands-_0026-Options-Index-1"></a>
<h2 class="unnumbered">Commands &amp; Options Index</h2>

<table><tr><th valign="top">Jump to: &nbsp; </th><td><a class="summary-letter" href="#Commands-_0026-Options-Index_fn_symbol-1"><b>-</b></a>
 &nbsp; 
<a class="summary-letter" href="#Commands-_0026-Options-Index_fn_symbol-2"><b>=</b></a>
 &nbsp; 
<a class="summary-letter" href="#Commands-_0026-Options-Index_fn_symbol-3"><b>~</b></a>
 &nbsp; 
<br>
<a class="summary-letter" href="#Commands-_0026-Options-Index_fn_letter-A"><b>A</b></a>
 &nbsp; 
<a class="summary-letter" href="#Commands-_0026-Options-Index_fn_letter-B"><b>B</b></a>
 &nbsp; 
<a class="summary-letter" href="#Commands-_0026-Options-Index_fn_letter-C"><b>C</b></a>
 &nbsp; 
<a class="summary-letter" href="#Commands-_0026-Options-Index_fn_letter-D"><b>D</b></a>
 &nbsp; 
<a class="summary-letter" href="#Commands-_0026-Options-Index_fn_letter-E"><b>E</b></a>
 &nbsp; 
<a class="summary-letter" href="#Commands-_0026-Options-Index_fn_letter-F"><b>F</b></a>
 &nbsp; 
<a class="summary-letter" href="#Commands-_0026-Options-Index_fn_letter-G"><b>G</b></a>
 &nbsp; 
<a class="summary-letter" href="#Commands-_0026-Options-Index_fn_letter-H"><b>H</b></a>
 &nbsp; 
<a class="summary-letter" href="#Commands-_0026-Options-Index_fn_letter-I"><b>I</b></a>
 &nbsp; 
<a class="summary-letter" href="#Commands-_0026-Options-Index_fn_letter-J"><b>J</b></a>
 &nbsp; 
<a class="summary-letter" href="#Commands-_0026-Options-Index_fn_letter-L"><b>L</b></a>
 &nbsp; 
<a class="summary-letter" href="#Commands-_0026-Options-Index_fn_letter-M"><b>M</b></a>
 &nbsp; 
<a class="summary-letter" href="#Commands-_0026-Options-Index_fn_letter-N"><b>N</b></a>
 &nbsp; 
<a class="summary-letter" href="#Commands-_0026-Options-Index_fn_letter-O"><b>O</b></a>
 &nbsp; 
<a class="summary-letter" href="#Commands-_0026-Options-Index_fn_letter-P"><b>P</b></a>
 &nbsp; 
<a class="summary-letter" href="#Commands-_0026-Options-Index_fn_letter-Q"><b>Q</b></a>
 &nbsp; 
<a class="summary-letter" href="#Commands-_0026-Options-Index_fn_letter-R"><b>R</b></a>
 &nbsp; 
<a class="summary-letter" href="#Commands-_0026-Options-Index_fn_letter-S"><b>S</b></a>
 &nbsp; 
<a class="summary-letter" href="#Commands-_0026-Options-Index_fn_letter-T"><b>T</b></a>
 &nbsp; 
<a class="summary-letter" href="#Commands-_0026-Options-Index_fn_letter-U"><b>U</b></a>
 &nbsp; 
<a class="summary-letter" href="#Commands-_0026-Options-Index_fn_letter-V"><b>V</b></a>
 &nbsp; 
<a class="summary-letter" href="#Commands-_0026-Options-Index_fn_letter-X"><b>X</b></a>
 &nbsp; 
<a class="summary-letter" href="#Commands-_0026-Options-Index_fn_letter-Y"><b>Y</b></a>
 &nbsp; 
</td></tr></table>
<table class="index-fn" border="0">
<tr><td></td><th align="left">Index Entry</th><td>&nbsp;</td><th align="left"> Section</th></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="Commands-_0026-Options-Index_fn_symbol-1">-</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_0025"><code>-%</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Output-Customization">Output Customization</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_0025-1"><code>-%</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_0025-2"><code>-%</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Output-customization">Output customization</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dabbrev_002dlen-INT"><code>--abbrev-len <var>INT</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002daccount-STR"><code>--account <var>STR</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#The-convert-command">The <code>convert</code> command</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002daccount-STR-1"><code>--account <var>STR</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Basic-Options">Basic Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002daccount-STR-2"><code>--account <var>STR</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002daccount-STR-3"><code>--account <var>STR</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Basic-options">Basic options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002daccount_002dwidth-INT"><code>--account-width <var>INT</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dactual"><code>--actual</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Filtering">Report Filtering</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dactual-1"><code>--actual</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dactual-2"><code>--actual</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-filtering">Report filtering</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dactual_002ddates"><code>--actual-dates</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dadd_002dbudget"><code>--add-budget</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Filtering">Report Filtering</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dadd_002dbudget-1"><code>--add-budget</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dadd_002dbudget-2"><code>--add-budget</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Budgeting">Budgeting</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002damount-EXPR"><code>--amount <var>EXPR</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Filtering">Report Filtering</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002damount-EXPR-1"><code>--amount <var>EXPR</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002damount-EXPR-2"><code>--amount <var>EXPR</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-filtering">Report filtering</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002damount-EXPR-3"><code>--amount <var>EXPR</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Variables">Variables</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002damount-EXPR-4"><code>--amount <var>EXPR</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Format-Expressions">Format Expressions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002damount_002ddata"><code>--amount-data</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Visualizing-with-Gnuplot">Visualizing with Gnuplot</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002damount_002ddata-1"><code>--amount-data</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#The-register-command">The <code>register</code> command</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002damount_002ddata-2"><code>--amount-data</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Output-Customization">Output Customization</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002damount_002ddata-3"><code>--amount-data</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002damount_002ddata-4"><code>--amount-data</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Output-customization">Output customization</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002damount_002dwidth-INT"><code>--amount-width <var>INT</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002danon"><code>--anon</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Output-Customization">Output Customization</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002danon-1"><code>--anon</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dansi"><code>--ansi</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dargs_002donly"><code>--args-only</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Global-Options">Global Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dargs_002donly-1"><code>--args-only</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Debug-Options">Debug Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dauto_002dmatch"><code>--auto-match</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#The-convert-command">The <code>convert</code> command</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dauto_002dmatch-1"><code>--auto-match</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002daux_002ddate"><code>--aux-date</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Auxiliary-dates">Auxiliary dates</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002daux_002ddate-1"><code>--aux-date</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002daverage"><code>--average</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#prices-and-pricedb-commands"><code>prices</code> and <code>pricedb</code> commands</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002daverage-1"><code>--average</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Output-Customization">Output Customization</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002daverage-2"><code>--average</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002daverage-3"><code>--average</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Output-customization">Output customization</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dbalance_002dformat-FORMAT_005fSTRING"><code>--balance-format <var>FORMAT_STRING</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Output-Customization">Output Customization</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dbalance_002dformat-FORMAT_005fSTRING-1"><code>--balance-format <var>FORMAT_STRING</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dbalance_002dformat-FORMAT_005fSTRING-2"><code>--balance-format <var>FORMAT_STRING</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Output-customization">Output customization</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dbalance_002dformat-FORMAT_005fSTRING-3"><code>--balance-format <var>FORMAT_STRING</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Format-String-Basics">Format String Basics</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dbalance_002dformat-FORMAT_005fSTRING-4"><code>--balance-format <var>FORMAT_STRING</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Balance-format">Balance format</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dbase"><code>--base</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dbasis"><code>--basis</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Commodity-Reporting">Commodity Reporting</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dbasis-1"><code>--basis</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dbasis-2"><code>--basis</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Commodity-reporting">Commodity reporting</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dbasis-3"><code>--basis</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Commodity-reporting">Commodity reporting</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dbasis-4"><code>--basis</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Primary-commodities">Primary commodities</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dbegin-DATE"><code>--begin <var>DATE</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Filtering">Report Filtering</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dbegin-DATE-1"><code>--begin <var>DATE</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dbegin-DATE-2"><code>--begin <var>DATE</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-filtering">Report filtering</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dbold_002dif-VEXPR"><code>--bold-if <var>VEXPR</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dbudget"><code>--budget</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Periodic-Transactions">Periodic Transactions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dbudget-1"><code>--budget</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Filtering">Report Filtering</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dbudget-2"><code>--budget</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dbudget-3"><code>--budget</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-filtering">Report filtering</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dbudget-4"><code>--budget</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Budgeting">Budgeting</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dbudget_002dformat-FORMAT_005fSTRING"><code>--budget-format <var>FORMAT_STRING</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dbudget_002dformat-FORMAT_005fSTRING-1"><code>--budget-format <var>FORMAT_STRING</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Format-String-Basics">Format String Basics</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dby_002dpayee"><code>--by-payee</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Working-with-multiple-funds-and-accounts">Working with multiple funds and accounts</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dby_002dpayee-1"><code>--by-payee</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Payee-metadata-tag">Payee metadata tag</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dby_002dpayee-2"><code>--by-payee</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Output-Customization">Output Customization</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dby_002dpayee-3"><code>--by-payee</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Grouping-Options">Grouping Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dby_002dpayee-4"><code>--by-payee</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dby_002dpayee-5"><code>--by-payee</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Output-customization">Output customization</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dchange"><code>--change</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dcheck_002dpayees"><code>--check-payees</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Error-Checking-and-Calculation-Options">Error Checking and Calculation Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dcheck_002dpayees-1"><code>--check-payees</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Session-Options">Session Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dcleared"><code>--cleared</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Transaction-state">Transaction state</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dcleared-1"><code>--cleared</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Filtering">Report Filtering</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dcleared-2"><code>--cleared</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dcleared-3"><code>--cleared</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-filtering">Report filtering</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dcleared_002dformat-FORMAT_005fSTRING"><code>--cleared-format <var>FORMAT_STRING</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dcleared_002dformat-FORMAT_005fSTRING-1"><code>--cleared-format <var>FORMAT_STRING</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Output-customization">Output customization</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dcleared_002dformat-FORMAT_005fSTRING-2"><code>--cleared-format <var>FORMAT_STRING</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Format-String-Basics">Format String Basics</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dcollapse"><code>--collapse</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Output-Customization">Output Customization</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dcollapse-1"><code>--collapse</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dcollapse-2"><code>--collapse</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Output-customization">Output customization</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dcollapse_002dif_002dzero"><code>--collapse-if-zero</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dcolor"><code>--color</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dcolumns-INT"><code>--columns <var>INT</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dcost"><code>--cost</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dcount"><code>--count</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Reports-about-your-Journals">Reports about your Journals</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dcount-1"><code>--count</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dcsv_002dformat-FORMAT_005fSTRING"><code>--csv-format <var>FORMAT_STRING</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dcsv_002dformat-FORMAT_005fSTRING-1"><code>--csv-format <var>FORMAT_STRING</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Output-customization">Output customization</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dcsv_002dformat-FORMAT_005fSTRING-2"><code>--csv-format <var>FORMAT_STRING</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Format-String-Basics">Format String Basics</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dcurrent"><code>--current</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Filtering">Report Filtering</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dcurrent-1"><code>--current</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dcurrent-2"><code>--current</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-filtering">Report filtering</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002ddaily"><code>--daily</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Grouping-Options">Grouping Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002ddaily-1"><code>--daily</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002ddate-EXPR"><code>--date <var>EXPR</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002ddate_002dformat-DATE_005fFORMAT"><code>--date-format <var>DATE_FORMAT</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Output-Customization">Output Customization</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002ddate_002dformat-DATE_005fFORMAT-1"><code>--date-format <var>DATE_FORMAT</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002ddate_002dformat-DATE_005fFORMAT-2"><code>--date-format <var>DATE_FORMAT</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Output-customization">Output customization</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002ddate_002dwidth-INT"><code>--date-width <var>INT</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002ddatetime_002dformat-DATETIME_005fFORMAT"><code>--datetime-format <var>DATETIME_FORMAT</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dday_002dbreak"><code>--day-break</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Session-Options">Session Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dday_002dbreak-1"><code>--day-break</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Time-Keeping">Time Keeping</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002ddays_002dof_002dweek"><code>--days-of-week</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002ddc"><code>--dc</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Filtering">Report Filtering</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002ddc-1"><code>--dc</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002ddebug-CODE"><code>--debug <var>CODE</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Global-Options">Global Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002ddebug-CODE-1"><code>--debug <var>CODE</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Debug-Options">Debug Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002ddecimal_002dcomma"><code>--decimal-comma</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Session-Options">Session Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002ddepth-INT"><code>--depth <var>INT</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002ddetail"><code>--detail</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002ddeviation"><code>--deviation</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Output-Customization">Output Customization</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002ddeviation-1"><code>--deviation</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002ddeviation-2"><code>--deviation</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Output-customization">Output customization</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002ddisplay-EXPR"><code>--display <var>EXPR</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Reporting-monthly-expenses">Reporting monthly expenses</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002ddisplay-EXPR-1"><code>--display <var>EXPR</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Visualizing-with-Gnuplot">Visualizing with Gnuplot</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002ddisplay-EXPR-2"><code>--display <var>EXPR</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Output-Customization">Output Customization</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002ddisplay-EXPR-3"><code>--display <var>EXPR</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002ddisplay-EXPR-4"><code>--display <var>EXPR</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Output-customization">Output customization</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002ddisplay-EXPR-5"><code>--display <var>EXPR</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Value-Expressions">Value Expressions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002ddisplay_002damount-EXPR"><code>--display-amount <var>EXPR</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002ddisplay_002dtotal-EXPR"><code>--display-total <var>EXPR</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002ddow"><code>--dow</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Output-Customization">Output Customization</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002ddow-1"><code>--dow</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Grouping-Options">Grouping Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002ddow-2"><code>--dow</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002ddow-3"><code>--dow</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Output-customization">Output customization</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002ddownload"><code>--download</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Transactions-and-Comments">Transactions and Comments</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002ddownload-1"><code>--download</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Commodity-Reporting">Commodity Reporting</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002ddownload-2"><code>--download</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Session-Options">Session Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002ddownload-3"><code>--download</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Commodity-reporting">Commodity reporting</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002deffective"><code>--effective</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Effective-Dates">Effective Dates</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002deffective-1"><code>--effective</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dempty"><code>--empty</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Balancing-transactions">Balancing transactions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dempty-1"><code>--empty</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Output-Customization">Output Customization</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dempty-2"><code>--empty</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dempty-3"><code>--empty</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Output-customization">Output customization</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dend-DATE"><code>--end <var>DATE</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Filtering">Report Filtering</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dend-DATE-1"><code>--end <var>DATE</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dend-DATE-2"><code>--end <var>DATE</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-filtering">Report filtering</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dequity"><code>--equity</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dexact"><code>--exact</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dexchange-COMMODITY"><code>--exchange <var>COMMODITY</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Complete-control-over-commodity-pricing">Complete control over commodity pricing</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dexchange-COMMODITY-1"><code>--exchange <var>COMMODITY</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Primary-and-secondary-commodities">Primary and secondary commodities</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dexchange-COMMODITY-2"><code>--exchange <var>COMMODITY</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dexchange-COMMODITY-3"><code>--exchange <var>COMMODITY</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Commodity-reporting">Commodity reporting</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dexchange-COMMODITY-4"><code>--exchange <var>COMMODITY</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Commodity-reporting">Commodity reporting</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dexplicit"><code>--explicit</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Session-Options">Session Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dfile-FILE"><code>--file <var>FILE</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Basic-Options">Basic Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dfile-FILE-1"><code>--file <var>FILE</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Session-Options">Session Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dfile-FILE-2"><code>--file <var>FILE</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Basic-options">Basic options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dfirst-INT"><code>--first <var>INT</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dflat"><code>--flat</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dforce_002dcolor"><code>--force-color</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dforce_002dpager"><code>--force-pager</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dforecast-VEXPR"><code>--forecast <var>VEXPR</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Filtering">Report Filtering</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dforecast-VEXPR-1"><code>--forecast <var>VEXPR</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dforecast-VEXPR-2"><code>--forecast <var>VEXPR</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Forecasting">Forecasting</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dforecast_002dwhile-VEXPR"><code>--forecast-while <var>VEXPR</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Filtering">Report Filtering</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dforecast_002dwhile-VEXPR-1"><code>--forecast-while <var>VEXPR</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dforecast_002dyears-INT"><code>--forecast-years <var>INT</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dformat-FORMAT_005fSTRING"><code>--format <var>FORMAT_STRING</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Output-Customization">Output Customization</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dformat-FORMAT_005fSTRING-1"><code>--format <var>FORMAT_STRING</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dformat-FORMAT_005fSTRING-2"><code>--format <var>FORMAT_STRING</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Output-customization">Output customization</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dformat-FORMAT_005fSTRING-3"><code>--format <var>FORMAT_STRING</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Format-String-Basics">Format String Basics</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dformat-FORMAT_005fSTRING-4"><code>--format <var>FORMAT_STRING</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Balance-format">Balance format</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dgain"><code>--gain</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Commodity-Reporting">Commodity Reporting</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dgain-1"><code>--gain</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dgain-2"><code>--gain</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Commodity-reporting">Commodity reporting</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dgenerated"><code>--generated</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dgroup_002dby-EXPR"><code>--group-by <var>EXPR</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dgroup_002dtitle_002dformat-FORMAT_005fSTRING"><code>--group-title-format <var>FORMAT_STRING</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dhead-INT"><code>--head <var>INT</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Output-Customization">Output Customization</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dhead-INT-1"><code>--head <var>INT</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dhead-INT-2"><code>--head <var>INT</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Output-customization">Output customization</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dhelp"><code>--help</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Basic-Options">Basic Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dhelp-1"><code>--help</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Global-Options">Global Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dhelp-2"><code>--help</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Basic-options">Basic options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dhistorical"><code>--historical</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dhistorical-1"><code>--historical</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Commodity-reporting">Commodity reporting</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dimmediate"><code>--immediate</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Error-Checking-and-Calculation-Options">Error Checking and Calculation Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dimmediate-1"><code>--immediate</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dimport-FILE"><code>--import <var>FILE</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Basic-Options">Basic Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dinit_002dfile-FILE"><code>--init-file <var>FILE</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Basic-Options">Basic Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dinit_002dfile-FILE-1"><code>--init-file <var>FILE</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Global-Options">Global Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dinit_002dfile-FILE-2"><code>--init-file <var>FILE</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Basic-options">Basic options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dinject"><code>--inject</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dinput_002ddate_002dformat-DATE_005fFORMAT"><code>--input-date-format <var>DATE_FORMAT</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#The-convert-command">The <code>convert</code> command</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dinput_002ddate_002dformat-DATE_005fFORMAT-1"><code>--input-date-format <var>DATE_FORMAT</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Session-Options">Session Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dinvert"><code>--invert</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#The-convert-command">The <code>convert</code> command</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dinvert-1"><code>--invert</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dlast-INT"><code>--last <var>INT</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dleeway-INT"><code>--leeway <var>INT</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Commodity-Reporting">Commodity Reporting</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dleeway-INT-1"><code>--leeway <var>INT</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Session-Options">Session Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dleeway-INT-2"><code>--leeway <var>INT</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Commodity-reporting">Commodity reporting</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dlimit-EXPR"><code>--limit <var>EXPR</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Controlling-the-Accounts-and-Payees">Controlling the Accounts and Payees</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dlimit-EXPR-1"><code>--limit <var>EXPR</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Visualizing-with-Gnuplot">Visualizing with Gnuplot</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dlimit-EXPR-2"><code>--limit <var>EXPR</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Filtering">Report Filtering</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dlimit-EXPR-3"><code>--limit <var>EXPR</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dlimit-EXPR-4"><code>--limit <var>EXPR</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-filtering">Report filtering</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dlimit-EXPR-5"><code>--limit <var>EXPR</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Value-Expressions">Value Expressions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dlot_002ddates"><code>--lot-dates</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Lot-dates">Lot dates</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dlot_002ddates-1"><code>--lot-dates</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dlot_002dnotes"><code>--lot-notes</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Lot-notes">Lot notes</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dlot_002dnotes-1"><code>--lot-notes</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dlot_002dprices"><code>--lot-prices</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Commodity-prices">Commodity prices</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dlot_002dprices-1"><code>--lot-prices</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dlot_002dprices-2"><code>--lot-prices</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Commodity-reporting">Commodity reporting</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dlot_002dprices-3"><code>--lot-prices</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Commodity-reporting">Commodity reporting</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dlot_002dtags"><code>--lot-tags</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dlots"><code>--lots</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Lot-notes">Lot notes</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dlots-1"><code>--lots</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dlots-2"><code>--lots</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Commodity-reporting">Commodity reporting</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dlots_002dactual"><code>--lots-actual</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dmarket"><code>--market</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Commodities-and-Currencies">Commodities and Currencies</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dmarket-1"><code>--market</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Complete-control-over-commodity-pricing">Complete control over commodity pricing</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dmarket-2"><code>--market</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Primary-and-secondary-commodities">Primary and secondary commodities</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dmarket-3"><code>--market</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Commodity-Reporting">Commodity Reporting</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dmarket-4"><code>--market</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dmarket-5"><code>--market</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Commodity-reporting">Commodity reporting</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dmarket-6"><code>--market</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Commodity-reporting">Commodity reporting</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dmarket-7"><code>--market</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Primary-commodities">Primary commodities</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dmaster_002daccount-STR"><code>--master-account <var>STR</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Session-Options">Session Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dmeta-TAG"><code>--meta <var>TAG</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dmeta_002dwidth-INT"><code>--meta-width <var>INT</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dmonthly"><code>--monthly</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Reporting-monthly-expenses">Reporting monthly expenses</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dmonthly-1"><code>--monthly</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Generating-a-monthly-register">Generating a monthly register</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dmonthly-2"><code>--monthly</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Grouping-Options">Grouping Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dmonthly-3"><code>--monthly</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dmonthly-4"><code>--monthly</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Output-customization">Output customization</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dmonthly-5"><code>--monthly</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Budgeting">Budgeting</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dno_002daliases"><code>--no-aliases</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Session-Options">Session Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dno_002daliases-1"><code>--no-aliases</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dno_002dcolor"><code>--no-color</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dno_002dpager"><code>--no-pager</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Output-Customization">Output Customization</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dno_002dpager-1"><code>--no-pager</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dno_002dpager-2"><code>--no-pager</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Output-customization">Output customization</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dno_002drevalued"><code>--no-revalued</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dno_002drounding"><code>--no-rounding</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dno_002dtitles"><code>--no-titles</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dno_002dtotal"><code>--no-total</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dnow-DATE"><code>--now <var>DATE</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dnow-DATE-1"><code>--now <var>DATE</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Commodity-reporting">Commodity reporting</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dnow-DATE-2"><code>--now <var>DATE</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Date-Functions">Date Functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002donly-FIXME"><code>--only <var>FIXME</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002doptions"><code>--options</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Global-Options">Global Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002doutput-FILE"><code>--output <var>FILE</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Basic-Options">Basic Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002doutput-FILE-1"><code>--output <var>FILE</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002doutput-FILE-2"><code>--output <var>FILE</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Basic-options">Basic options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dpager-FILE"><code>--pager <var>FILE</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Output-Customization">Output Customization</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dpager-FILE-1"><code>--pager <var>FILE</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dpager-FILE-2"><code>--pager <var>FILE</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Output-customization">Output customization</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dpayee-VEXPR"><code>--payee <var>VEXPR</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dpayee_002dwidth-INT"><code>--payee-width <var>INT</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dpayee_003dcode"><code>--payee=code</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Working-with-multiple-funds-and-accounts">Working with multiple funds and accounts</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dpedantic"><code>--pedantic</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Command-Directives">Command Directives</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dpedantic-1"><code>--pedantic</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Error-Checking-and-Calculation-Options">Error Checking and Calculation Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dpedantic-2"><code>--pedantic</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Session-Options">Session Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dpending"><code>--pending</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Transaction-state">Transaction state</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dpending-1"><code>--pending</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dpercent"><code>--percent</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Output-Customization">Output Customization</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dpercent-1"><code>--percent</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dpercent-2"><code>--percent</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Output-customization">Output customization</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dperiod-PERIOD_005fEXPRESSION"><code>--period <var>PERIOD_EXPRESSION</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Filtering">Report Filtering</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dperiod-PERIOD_005fEXPRESSION-1"><code>--period <var>PERIOD_EXPRESSION</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dperiod-PERIOD_005fEXPRESSION-2"><code>--period <var>PERIOD_EXPRESSION</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-filtering">Report filtering</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dperiod-PERIOD_005fEXPRESSION-3"><code>--period <var>PERIOD_EXPRESSION</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Output-customization">Output customization</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dperiod_002dsort-VEXPR"><code>--period-sort <var>VEXPR</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Reporting-monthly-expenses">Reporting monthly expenses</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dperiod_002dsort-VEXPR-1"><code>--period-sort <var>VEXPR</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Filtering">Report Filtering</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dperiod_002dsort-VEXPR-2"><code>--period-sort <var>VEXPR</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dperiod_002dsort-VEXPR-3"><code>--period-sort <var>VEXPR</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-filtering">Report filtering</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dpermissive"><code>--permissive</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Balance-verification">Balance verification</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dpermissive-1"><code>--permissive</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Session-Options">Session Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dpivot-TAG"><code>--pivot <var>TAG</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Output-Customization">Output Customization</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dpivot-TAG-1"><code>--pivot <var>TAG</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dpivot-TAG-2"><code>--pivot <var>TAG</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Output-customization">Output customization</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dplot_002damount_002dformat-FORMAT_005fSTRING"><code>--plot-amount-format <var>FORMAT_STRING</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Output-Customization">Output Customization</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dplot_002damount_002dformat-FORMAT_005fSTRING-1"><code>--plot-amount-format <var>FORMAT_STRING</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dplot_002damount_002dformat-FORMAT_005fSTRING-2"><code>--plot-amount-format <var>FORMAT_STRING</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Output-customization">Output customization</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dplot_002damount_002dformat-FORMAT_005fSTRING-3"><code>--plot-amount-format <var>FORMAT_STRING</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Format-String-Basics">Format String Basics</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dplot_002dtotal_002dformat-FORMAT_005fSTRING"><code>--plot-total-format <var>FORMAT_STRING</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Output-Customization">Output Customization</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dplot_002dtotal_002dformat-FORMAT_005fSTRING-1"><code>--plot-total-format <var>FORMAT_STRING</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dplot_002dtotal_002dformat-FORMAT_005fSTRING-2"><code>--plot-total-format <var>FORMAT_STRING</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Output-customization">Output customization</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dplot_002dtotal_002dformat-FORMAT_005fSTRING-3"><code>--plot-total-format <var>FORMAT_STRING</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Format-String-Basics">Format String Basics</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dprepend_002dformat-FORMAT_005fSTRING"><code>--prepend-format <var>FORMAT_STRING</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dprepend_002dwidth-INT"><code>--prepend-width <var>INT</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dprice"><code>--price</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dprice-1"><code>--price</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Commodity-reporting">Commodity reporting</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dprice_002ddb-FILE"><code>--price-db <var>FILE</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Commodities-and-Currencies">Commodities and Currencies</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dprice_002ddb-FILE-1"><code>--price-db <var>FILE</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Commodity-Reporting">Commodity Reporting</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dprice_002ddb-FILE-2"><code>--price-db <var>FILE</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Session-Options">Session Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dprice_002ddb-FILE-3"><code>--price-db <var>FILE</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Commodity-reporting">Commodity reporting</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dprice_002dexp-INT"><code>--price-exp <var>INT</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Commodity-Reporting">Commodity Reporting</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dprice_002dexp-INT-1"><code>--price-exp <var>INT</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Session-Options">Session Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dprice_002dexp-INT-2"><code>--price-exp <var>INT</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Commodity-reporting">Commodity reporting</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dpricedb_002dformat-FORMAT_005fSTRING"><code>--pricedb-format <var>FORMAT_STRING</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dpricedb_002dformat-FORMAT_005fSTRING-1"><code>--pricedb-format <var>FORMAT_STRING</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Output-customization">Output customization</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dpricedb_002dformat-FORMAT_005fSTRING-2"><code>--pricedb-format <var>FORMAT_STRING</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Format-String-Basics">Format String Basics</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dprices_002dformat-FORMAT_005fSTRING"><code>--prices-format <var>FORMAT_STRING</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Output-Customization">Output Customization</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dprices_002dformat-FORMAT_005fSTRING-1"><code>--prices-format <var>FORMAT_STRING</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dprices_002dformat-FORMAT_005fSTRING-2"><code>--prices-format <var>FORMAT_STRING</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Output-customization">Output customization</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dprices_002dformat-FORMAT_005fSTRING-3"><code>--prices-format <var>FORMAT_STRING</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Format-String-Basics">Format String Basics</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dprimary_002ddate"><code>--primary-date</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dquantity"><code>--quantity</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Commodity-Reporting">Commodity Reporting</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dquantity-1"><code>--quantity</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dquantity-2"><code>--quantity</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Commodity-reporting">Commodity reporting</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dquarterly"><code>--quarterly</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Output-Customization">Output Customization</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dquarterly-1"><code>--quarterly</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Grouping-Options">Grouping Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dquarterly-2"><code>--quarterly</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002draw"><code>--raw</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dreal"><code>--real</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Working-with-multiple-funds-and-accounts">Working with multiple funds and accounts</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dreal-1"><code>--real</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Virtual-postings">Virtual postings</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dreal-2"><code>--real</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Filtering">Report Filtering</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dreal-3"><code>--real</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dreal-4"><code>--real</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-filtering">Report filtering</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002drecursive_002daliases"><code>--recursive-aliases</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Session-Options">Session Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dregister_002dformat-FORMAT_005fSTRING"><code>--register-format <var>FORMAT_STRING</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Output-Customization">Output Customization</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dregister_002dformat-FORMAT_005fSTRING-1"><code>--register-format <var>FORMAT_STRING</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dregister_002dformat-FORMAT_005fSTRING-2"><code>--register-format <var>FORMAT_STRING</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Output-customization">Output customization</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dregister_002dformat-FORMAT_005fSTRING-3"><code>--register-format <var>FORMAT_STRING</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Format-String-Basics">Format String Basics</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002drelated"><code>--related</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Reporting-monthly-expenses">Reporting monthly expenses</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002drelated-1"><code>--related</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Filtering">Report Filtering</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002drelated-2"><code>--related</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002drelated-3"><code>--related</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-filtering">Report filtering</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002drelated_002dall"><code>--related-all</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002drevalued"><code>--revalued</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002drevalued_002donly"><code>--revalued-only</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002drevalued_002dtotal-FIXME"><code>--revalued-total <var>FIXME</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002drich_002ddata"><code>--rich-data</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#The-convert-command">The <code>convert</code> command</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002drich_002ddata-1"><code>--rich-data</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dscript-FILE"><code>--script <var>FILE</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Global-Options">Global Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dseed-INT"><code>--seed <var>INT</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dsort-VEXPR"><code>--sort <var>VEXPR</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Output-Customization">Output Customization</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dsort-VEXPR-1"><code>--sort <var>VEXPR</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dsort-VEXPR-2"><code>--sort <var>VEXPR</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Output-customization">Output customization</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dsort_002dall-FIXME"><code>--sort-all <var>FIXME</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dsort_002dxacts-VEXPR"><code>--sort-xacts <var>VEXPR</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dstart_002dof_002dweek-INT"><code>--start-of-week <var>INT</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dstrict"><code>--strict</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Keeping-it-Consistent">Keeping it Consistent</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dstrict-1"><code>--strict</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Command-Directives">Command Directives</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dstrict-2"><code>--strict</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Error-Checking-and-Calculation-Options">Error Checking and Calculation Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dstrict-3"><code>--strict</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Session-Options">Session Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dsubtotal"><code>--subtotal</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Reporting-monthly-expenses">Reporting monthly expenses</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dsubtotal-1"><code>--subtotal</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#An-overall-balance-summary">An overall balance summary</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dsubtotal-2"><code>--subtotal</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Output-Customization">Output Customization</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dsubtotal-3"><code>--subtotal</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Grouping-Options">Grouping Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dsubtotal-4"><code>--subtotal</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dsubtotal-5"><code>--subtotal</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Output-customization">Output customization</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dtail-INT"><code>--tail <var>INT</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Output-Customization">Output Customization</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dtail-INT-1"><code>--tail <var>INT</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dtime_002dcolon"><code>--time-colon</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Session-Options">Session Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dtime_002dreport"><code>--time-report</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dtotal-VEXPR"><code>--total <var>VEXPR</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Filtering">Report Filtering</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dtotal-VEXPR-1"><code>--total <var>VEXPR</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dtotal-VEXPR-2"><code>--total <var>VEXPR</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-filtering">Report filtering</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dtotal-VEXPR-3"><code>--total <var>VEXPR</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Variables">Variables</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dtotal-VEXPR-4"><code>--total <var>VEXPR</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Format-Expressions">Format Expressions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dtotal_002ddata"><code>--total-data</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Visualizing-with-Gnuplot">Visualizing with Gnuplot</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dtotal_002ddata-1"><code>--total-data</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#The-register-command">The <code>register</code> command</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dtotal_002ddata-2"><code>--total-data</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Output-Customization">Output Customization</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dtotal_002ddata-3"><code>--total-data</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dtotal_002ddata-4"><code>--total-data</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Output-customization">Output customization</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dtotal_002dwidth-INT"><code>--total-width <var>INT</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dtrace-INT"><code>--trace <var>INT</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Global-Options">Global Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dtrace-INT-1"><code>--trace <var>INT</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Debug-Options">Debug Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dtruncate-CODE"><code>--truncate <var>CODE</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dunbudgeted"><code>--unbudgeted</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Filtering">Report Filtering</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dunbudgeted-1"><code>--unbudgeted</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dunbudgeted-2"><code>--unbudgeted</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Budgeting">Budgeting</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002duncleared"><code>--uncleared</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Transaction-state">Transaction state</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002duncleared-1"><code>--uncleared</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Filtering">Report Filtering</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002duncleared-2"><code>--uncleared</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002duncleared-3"><code>--uncleared</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-filtering">Report filtering</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dunrealized"><code>--unrealized</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dunrealized_002dgains-STR"><code>--unrealized-gains <var>STR</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dunrealized_002dlosses-STR"><code>--unrealized-losses <var>STR</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dunround"><code>--unround</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dvalue_002dexpr-VEXPR"><code>--value-expr <var>VEXPR</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Session-Options">Session Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dvalues"><code>--values</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#tags"><code>tags</code></a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dvalues-1"><code>--values</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dverbose"><code>--verbose</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Global-Options">Global Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dverbose-1"><code>--verbose</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Debug-Options">Debug Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dverify"><code>--verify</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Global-Options">Global Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dverify-1"><code>--verify</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Debug-Options">Debug Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dverify_002dmemory"><code>--verify-memory</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Global-Options">Global Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dverify_002dmemory-1"><code>--verify-memory</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Debug-Options">Debug Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dversion"><code>--version</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Basic-Options">Basic Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dversion-1"><code>--version</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Global-Options">Global Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dversion-2"><code>--version</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Basic-options">Basic options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dversion-3"><code>--version</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Debug-Options">Debug Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dweekly"><code>--weekly</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Output-Customization">Output Customization</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dweekly-1"><code>--weekly</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Grouping-Options">Grouping Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dweekly-2"><code>--weekly</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dweekly-3"><code>--weekly</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Output-customization">Output customization</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dwide"><code>--wide</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Output-Customization">Output Customization</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dwide-1"><code>--wide</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dwide-2"><code>--wide</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Output-customization">Output customization</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dyearly"><code>--yearly</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Output-Customization">Output Customization</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dyearly-1"><code>--yearly</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Grouping-Options">Grouping Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dyearly-2"><code>--yearly</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dyearly-3"><code>--yearly</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Output-customization">Output customization</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002dA"><code>-A</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Output-Customization">Output Customization</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002dA-1"><code>-A</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002dA-2"><code>-A</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Output-customization">Output customization</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002da-STR"><code>-a <var>STR</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Basic-Options">Basic Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002da-STR-1"><code>-a <var>STR</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Basic-options">Basic options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002dB"><code>-B</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Commodity-Reporting">Commodity Reporting</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002dB-1"><code>-B</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002dB-2"><code>-B</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Commodity-reporting">Commodity reporting</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002db-DATE"><code>-b <var>DATE</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Filtering">Report Filtering</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002db-DATE-1"><code>-b <var>DATE</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-filtering">Report filtering</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002dc"><code>-c</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Filtering">Report Filtering</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002dC"><code>-C</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Filtering">Report Filtering</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002dC-1"><code>-C</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002dc-1"><code>-c</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-filtering">Report filtering</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002dC-2"><code>-C</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-filtering">Report filtering</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002dD"><code>-D</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Output-Customization">Output Customization</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002dD-1"><code>-D</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Grouping-Options">Grouping Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002dD-2"><code>-D</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002dD-3"><code>-D</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Output-customization">Output customization</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002dd-EXPR"><code>-d <var>EXPR</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Output-Customization">Output Customization</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002dd-EXPR-1"><code>-d <var>EXPR</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Output-customization">Output customization</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002dE"><code>-E</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Output-Customization">Output Customization</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002dE-1"><code>-E</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002dE-2"><code>-E</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Output-customization">Output customization</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002de-DATE"><code>-e <var>DATE</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Filtering">Report Filtering</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002de-DATE-1"><code>-e <var>DATE</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-filtering">Report filtering</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002df-FILE"><code>-f <var>FILE</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Basic-Options">Basic Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002df-FILE-1"><code>-f <var>FILE</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Session-Options">Session Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002df-FILE-2"><code>-f <var>FILE</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Basic-options">Basic options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002dF-FORMAT_005fSTRING"><code>-F <var>FORMAT_STRING</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Output-Customization">Output Customization</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002dF-FORMAT_005fSTRING-1"><code>-F <var>FORMAT_STRING</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002dF-FORMAT_005fSTRING-2"><code>-F <var>FORMAT_STRING</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Output-customization">Output customization</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002dG"><code>-G</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Commodity-Reporting">Commodity Reporting</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002dG-1"><code>-G</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002dG-2"><code>-G</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Commodity-reporting">Commodity reporting</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002dh"><code>-h</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Basic-Options">Basic Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002dh-1"><code>-h</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Global-Options">Global Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002dH"><code>-H</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002dh-2"><code>-h</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Basic-options">Basic options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002dI"><code>-I</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002di-FILE"><code>-i <var>FILE</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Basic-Options">Basic Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002di-FILE-1"><code>-i <var>FILE</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Basic-options">Basic options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002dj"><code>-j</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Output-Customization">Output Customization</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002dJ"><code>-J</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Output-Customization">Output Customization</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002dj-1"><code>-j</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002dJ-1"><code>-J</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002dj-2"><code>-j</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Output-customization">Output customization</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002dJ-2"><code>-J</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Output-customization">Output customization</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002dL"><code>-L</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Filtering">Report Filtering</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002dL-1"><code>-L</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002dL-2"><code>-L</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-filtering">Report filtering</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002dl-EXPR"><code>-l <var>EXPR</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Filtering">Report Filtering</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002dl-EXPR-1"><code>-l <var>EXPR</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002dl-EXPR-2"><code>-l <var>EXPR</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-filtering">Report filtering</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002dM"><code>-M</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Grouping-Options">Grouping Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002dM-1"><code>-M</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002dM-2"><code>-M</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Output-customization">Output customization</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002dn"><code>-n</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Output-Customization">Output Customization</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002dn-1"><code>-n</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002dn-2"><code>-n</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Output-customization">Output customization</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002dO"><code>-O</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Commodity-Reporting">Commodity Reporting</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002dO-1"><code>-O</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002dO-2"><code>-O</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Commodity-reporting">Commodity reporting</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002do-FILE"><code>-o <var>FILE</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Basic-Options">Basic Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002do-FILE-1"><code>-o <var>FILE</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Basic-options">Basic options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002dP"><code>-P</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Output-Customization">Output Customization</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002dP-1"><code>-P</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Grouping-Options">Grouping Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002dP-2"><code>-P</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002dP-3"><code>-P</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Output-customization">Output customization</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002dp-PERIOD_005fEXPRESSION"><code>-p <var>PERIOD_EXPRESSION</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Filtering">Report Filtering</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002dp-PERIOD_005fEXPRESSION-1"><code>-p <var>PERIOD_EXPRESSION</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-filtering">Report filtering</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002dQ"><code>-Q</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Commodity-Reporting">Commodity Reporting</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002dQ-1"><code>-Q</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Session-Options">Session Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002dQ-2"><code>-Q</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Commodity-reporting">Commodity reporting</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002dR"><code>-R</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Filtering">Report Filtering</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002dr"><code>-r</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Filtering">Report Filtering</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002dR-1"><code>-R</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002dR-2"><code>-R</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-filtering">Report filtering</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002dr-1"><code>-r</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-filtering">Report filtering</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002ds"><code>-s</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Output-Customization">Output Customization</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002ds-1"><code>-s</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Grouping-Options">Grouping Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002ds-2"><code>-s</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002ds-3"><code>-s</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Output-customization">Output customization</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002dS-VEXPR"><code>-S <var>VEXPR</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Output-Customization">Output Customization</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002dS-VEXPR-1"><code>-S <var>VEXPR</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002dS-VEXPR-2"><code>-S <var>VEXPR</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Output-customization">Output customization</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002dt-EXPR"><code>-t <var>EXPR</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Filtering">Report Filtering</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002dt-EXPR-1"><code>-t <var>EXPR</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002dt-EXPR-2"><code>-t <var>EXPR</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-filtering">Report filtering</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002dT-VEXPR"><code>-T <var>VEXPR</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Filtering">Report Filtering</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002dT-VEXPR-1"><code>-T <var>VEXPR</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002dT-VEXPR-2"><code>-T <var>VEXPR</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-filtering">Report filtering</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002dU"><code>-U</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Filtering">Report Filtering</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002dU-1"><code>-U</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002dU-2"><code>-U</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-filtering">Report filtering</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002dV"><code>-V</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Commodity-Reporting">Commodity Reporting</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002dv"><code>-v</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Global-Options">Global Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002dV-1"><code>-V</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002dV-2"><code>-V</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Commodity-reporting">Commodity reporting</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002dv-1"><code>-v</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Debug-Options">Debug Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002dW"><code>-W</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Output-Customization">Output Customization</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002dw"><code>-w</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Output-Customization">Output Customization</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002dW-1"><code>-W</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Grouping-Options">Grouping Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002dW-2"><code>-W</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002dW-3"><code>-W</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Output-customization">Output customization</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002dw-1"><code>-w</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Output-customization">Output customization</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002dX-COMMODITY"><code>-X <var>COMMODITY</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002dY"><code>-Y</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Output-Customization">Output Customization</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002dY-1"><code>-Y</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Grouping-Options">Grouping Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002dY-2"><code>-Y</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002dY-3"><code>-Y</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Output-customization">Output customization</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002dy-DATE_005fFORMAT"><code>-y <var>DATE_FORMAT</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Output-Customization">Output Customization</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002dy-DATE_005fFORMAT-1"><code>-y <var>DATE_FORMAT</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Report-Options">Report Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002dy-DATE_005fFORMAT-2"><code>-y <var>DATE_FORMAT</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Output-customization">Output customization</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002dZ-INT"><code>-Z <var>INT</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Commodity-Reporting">Commodity Reporting</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002dZ-INT-1"><code>-Z <var>INT</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Session-Options">Session Options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002dZ-INT-2"><code>-Z <var>INT</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Commodity-reporting">Commodity reporting</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="Commands-_0026-Options-Index_fn_symbol-2">=</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-_003d"><code>=</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Transactions-and-Comments">Transactions and Comments</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="Commands-_0026-Options-Index_fn_symbol-3">~</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-_007e"><code>~</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Transactions-and-Comments">Transactions and Comments</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="Commands-_0026-Options-Index_fn_letter-A">A</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-A"><code>A</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Command-Directives">Command Directives</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-abs"><code>abs</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Miscellaneous">Miscellaneous</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-account"><code>account</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Command-Directives">Command Directives</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-accounts"><code>accounts</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Keeping-it-Consistent">Keeping it Consistent</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-accounts-1"><code>accounts</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#accounts"><code>accounts</code></a></td></tr>
<tr><td></td><td valign="top"><a href="#index-alias"><code>alias</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Command-Directives">Command Directives</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-amount_005fexpr"><code>amount_expr</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Miscellaneous">Miscellaneous</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-ansify_005fif"><code>ansify_if</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Miscellaneous">Miscellaneous</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-apply-account"><code>apply account</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Command-Directives">Command Directives</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-apply-tag"><code>apply tag</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Command-Directives">Command Directives</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-args"><code>args</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Pre_002dCommands">Pre-Commands</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-assert"><code>assert</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Command-Directives">Command Directives</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="Commands-_0026-Options-Index_fn_letter-B">B</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-b"><code>b</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Command-Directives">Command Directives</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-bal"><code>bal</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Basic-Reporting-Commands">Basic Reporting Commands</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-balance"><code>balance</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Balance-Report">Balance Report</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-balance-1"><code>balance</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#The-balance-command">The <code>balance</code> command</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-balance-2"><code>balance</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Basic-Reporting-Commands">Basic Reporting Commands</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-bucket-1"><code>bucket</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Command-Directives">Command Directives</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-bucket-2"><code>bucket</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Command-Directives">Command Directives</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="Commands-_0026-Options-Index_fn_letter-C">C</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-C"><code>C</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Commodity-equivalences">Commodity equivalences</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-C-1"><code>C</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Command-Directives">Command Directives</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-capture"><code>capture</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Command-Directives">Command Directives</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-ceiling"><code>ceiling</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Miscellaneous">Miscellaneous</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-check"><code>check</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Command-Directives">Command Directives</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-cleared"><code>cleared</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Cleared-Report">Cleared Report</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-comment"><code>comment</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Transactions-and-Comments">Transactions and Comments</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-comment-1"><code>comment</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Command-Directives">Command Directives</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-commodities"><code>commodities</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#commodities"><code>commodities</code></a></td></tr>
<tr><td></td><td valign="top"><a href="#index-commodity-1"><code>commodity</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Command-Directives">Command Directives</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-convert"><code>convert</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#The-convert-command">The <code>convert</code> command</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-csv"><code>csv</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#The-csv-command">The <code>csv</code> command</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-csv-1"><code>csv</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Basic-Reporting-Commands">Basic Reporting Commands</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="Commands-_0026-Options-Index_fn_letter-D">D</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-D"><code>D</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Command-Directives">Command Directives</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-define"><code>define</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Command-Directives">Command Directives</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-draft"><code>draft</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#xact"><code>xact</code></a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="Commands-_0026-Options-Index_fn_letter-E">E</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-echo"><code>echo</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#echo"><code>echo</code></a></td></tr>
<tr><td></td><td valign="top"><a href="#index-emacs"><code>emacs</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#The-lisp-command">The <code>lisp</code> command</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-emacs-1"><code>emacs</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Basic-Reporting-Commands">Basic Reporting Commands</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-end"><code>end</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Command-Directives">Command Directives</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-entry"><code>entry</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#xact"><code>xact</code></a></td></tr>
<tr><td></td><td valign="top"><a href="#index-equity"><code>equity</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Archiving-Previous-Years">Archiving Previous Years</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-equity-1"><code>equity</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#The-equity-command">The <code>equity</code> command</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-equity-2"><code>equity</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Basic-Reporting-Commands">Basic Reporting Commands</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-eval-VEXPR"><code>eval <var>VEXPR</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Pre_002dCommands">Pre-Commands</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-expr"><code>expr</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Command-Directives">Command Directives</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-expr-VEXPR"><code>expr <var>VEXPR</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Pre_002dCommands">Pre-Commands</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="Commands-_0026-Options-Index_fn_letter-F">F</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-fixed"><code>fixed</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Command-Directives">Command Directives</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-floor"><code>floor</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Miscellaneous">Miscellaneous</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-format"><code>format</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Miscellaneous">Miscellaneous</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-format-FORMAT_005fSTRING"><code>format <var>FORMAT_STRING</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Pre_002dCommands">Pre-Commands</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-format_005fdate"><code>format_date</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Miscellaneous">Miscellaneous</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-format_005fdatetime"><code>format_datetime</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Miscellaneous">Miscellaneous</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="Commands-_0026-Options-Index_fn_letter-G">G</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-generate"><code>generate</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Pre_002dCommands">Pre-Commands</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-get_005fat"><code>get_at</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Miscellaneous">Miscellaneous</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="Commands-_0026-Options-Index_fn_letter-H">H</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-h"><code>h</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Command-Directives">Command Directives</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-help"><code>help</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Getting-help">Getting help</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="Commands-_0026-Options-Index_fn_letter-I">I</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-I"><code>I</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Command-Directives">Command Directives</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-i"><code>i</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Command-Directives">Command Directives</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-include"><code>include</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Command-Directives">Command Directives</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-int"><code>int</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Miscellaneous">Miscellaneous</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-is_005fseq"><code>is_seq</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Miscellaneous">Miscellaneous</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="Commands-_0026-Options-Index_fn_letter-J">J</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-join"><code>join</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Miscellaneous">Miscellaneous</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-justify"><code>justify</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Miscellaneous">Miscellaneous</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="Commands-_0026-Options-Index_fn_letter-L">L</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-lisp"><code>lisp</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#The-lisp-command">The <code>lisp</code> command</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-lisp-1"><code>lisp</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Basic-Reporting-Commands">Basic Reporting Commands</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="Commands-_0026-Options-Index_fn_letter-M">M</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-market"><code>market</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Miscellaneous">Miscellaneous</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="Commands-_0026-Options-Index_fn_letter-N">N</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-N"><code>N</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Command-Directives">Command Directives</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-nail_005fdown"><code>nail_down</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Miscellaneous">Miscellaneous</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="Commands-_0026-Options-Index_fn_letter-O">O</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-O"><code>O</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Command-Directives">Command Directives</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-o"><code>o</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Command-Directives">Command Directives</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-org"><code>org</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Emacs-org-Mode">Emacs <code>org</code> Mode</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="Commands-_0026-Options-Index_fn_letter-P">P</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-P"><code>P</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Transactions-and-Comments">Transactions and Comments</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-P-1"><code>P</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Miscellaneous">Miscellaneous</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-parse-VEXPR"><code>parse <var>VEXPR</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Pre_002dCommands">Pre-Commands</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-payee"><code>payee</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Command-Directives">Command Directives</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-payees"><code>payees</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Payee-metadata-tag">Payee metadata tag</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-payees-1"><code>payees</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#payees"><code>payees</code></a></td></tr>
<tr><td></td><td valign="top"><a href="#index-percent"><code>percent</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Miscellaneous">Miscellaneous</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-period-PERIOD_005fEXPRESSION"><code>period <var>PERIOD_EXPRESSION</var></code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Pre_002dCommands">Pre-Commands</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-pricedb"><code>pricedb</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#prices-and-pricedb-commands"><code>prices</code> and <code>pricedb</code> commands</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-pricedb-1"><code>pricedb</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Basic-Reporting-Commands">Basic Reporting Commands</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-pricemap"><code>pricemap</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#The-pricemap-command">The <code>pricemap</code> command</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-prices"><code>prices</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#prices-and-pricedb-commands"><code>prices</code> and <code>pricedb</code> commands</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-prices-1"><code>prices</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Basic-Reporting-Commands">Basic Reporting Commands</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-print"><code>print</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Command-Directives">Command Directives</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-print-1"><code>print</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Command-Directives">Command Directives</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-print-2"><code>print</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Archiving-Previous-Years">Archiving Previous Years</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-print-3"><code>print</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#The-print-command">The <code>print</code> command</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-print-4"><code>print</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Basic-Reporting-Commands">Basic Reporting Commands</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-print-5"><code>print</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Miscellaneous">Miscellaneous</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="Commands-_0026-Options-Index_fn_letter-Q">Q</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-quantity"><code>quantity</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Miscellaneous">Miscellaneous</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-query"><code>query</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Pre_002dCommands">Pre-Commands</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-quoted"><code>quoted</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Miscellaneous">Miscellaneous</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="Commands-_0026-Options-Index_fn_letter-R">R</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-reg"><code>reg</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Basic-Reporting-Commands">Basic Reporting Commands</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-register"><code>register</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Register-Report">Register Report</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-register-1"><code>register</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Command-Directives">Command Directives</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-register-2"><code>register</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Command-Directives">Command Directives</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-register-3"><code>register</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Payee-metadata-tag">Payee metadata tag</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-register-4"><code>register</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#The-register-command">The <code>register</code> command</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-register-5"><code>register</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Generating-a-monthly-register">Generating a monthly register</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-register-6"><code>register</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Basic-Reporting-Commands">Basic Reporting Commands</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-reload"><code>reload</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#reload"><code>reload</code></a></td></tr>
<tr><td></td><td valign="top"><a href="#index-round"><code>round</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Miscellaneous">Miscellaneous</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-rounded"><code>rounded</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Miscellaneous">Miscellaneous</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-roundto"><code>roundto</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Miscellaneous">Miscellaneous</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="Commands-_0026-Options-Index_fn_letter-S">S</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-S"><code>S</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Miscellaneous">Miscellaneous</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-script"><code>script</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Pre_002dCommands">Pre-Commands</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-scrub"><code>scrub</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Miscellaneous">Miscellaneous</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-select"><code>select</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#select"><code>select</code></a></td></tr>
<tr><td></td><td valign="top"><a href="#index-should_005fbold"><code>should_bold</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Miscellaneous">Miscellaneous</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-source"><code>source</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#source"><code>source</code></a></td></tr>
<tr><td></td><td valign="top"><a href="#index-stat"><code>stat</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#stats"><code>stats</code></a></td></tr>
<tr><td></td><td valign="top"><a href="#index-stats"><code>stats</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#stats"><code>stats</code></a></td></tr>
<tr><td></td><td valign="top"><a href="#index-str"><code>str</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Miscellaneous">Miscellaneous</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-strip"><code>strip</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Miscellaneous">Miscellaneous</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="Commands-_0026-Options-Index_fn_letter-T">T</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-tag"><code>tag</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Command-Directives">Command Directives</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-tags-1"><code>tags</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#tags"><code>tags</code></a></td></tr>
<tr><td></td><td valign="top"><a href="#index-template"><code>template</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Pre_002dCommands">Pre-Commands</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-test"><code>test</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Command-Directives">Command Directives</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-top_005famount"><code>top_amount</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Miscellaneous">Miscellaneous</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-total_005fexpr"><code>total_expr</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Miscellaneous">Miscellaneous</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-to_005famount"><code>to_amount</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Miscellaneous">Miscellaneous</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-to_005fbalance"><code>to_balance</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Miscellaneous">Miscellaneous</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-to_005fboolean"><code>to_boolean</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Miscellaneous">Miscellaneous</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-to_005fdate"><code>to_date</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Miscellaneous">Miscellaneous</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-to_005fdatetime"><code>to_datetime</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Miscellaneous">Miscellaneous</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-to_005fint"><code>to_int</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Miscellaneous">Miscellaneous</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-to_005fmask"><code>to_mask</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Miscellaneous">Miscellaneous</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-to_005fsequence"><code>to_sequence</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Miscellaneous">Miscellaneous</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-to_005fstring"><code>to_string</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Miscellaneous">Miscellaneous</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-trim"><code>trim</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Miscellaneous">Miscellaneous</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-truncatedstring"><code>truncatedstring</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Miscellaneous">Miscellaneous</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="Commands-_0026-Options-Index_fn_letter-U">U</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-U"><code>U</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Miscellaneous">Miscellaneous</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-unround"><code>unround</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Miscellaneous">Miscellaneous</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-unrounded"><code>unrounded</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Miscellaneous">Miscellaneous</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="Commands-_0026-Options-Index_fn_letter-V">V</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-value_005fdate"><code>value_date</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Miscellaneous">Miscellaneous</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="Commands-_0026-Options-Index_fn_letter-X">X</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-xact"><code>xact</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Command-Directives">Command Directives</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-xact-1"><code>xact</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#xact"><code>xact</code></a></td></tr>
<tr><td></td><td valign="top"><a href="#index-xact-2"><code>xact</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Basic-Reporting-Commands">Basic Reporting Commands</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-xml"><code>xml</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#The-xml-command">The <code>xml</code> command</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-xml-1"><code>xml</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Basic-Reporting-Commands">Basic Reporting Commands</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="Commands-_0026-Options-Index_fn_letter-Y">Y</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-Y"><code>Y</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Command-Directives">Command Directives</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-year"><code>year</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Command-Directives">Command Directives</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-year-1"><code>year</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Command-Directives">Command Directives</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
</table>
<table><tr><th valign="top">Jump to: &nbsp; </th><td><a class="summary-letter" href="#Commands-_0026-Options-Index_fn_symbol-1"><b>-</b></a>
 &nbsp; 
<a class="summary-letter" href="#Commands-_0026-Options-Index_fn_symbol-2"><b>=</b></a>
 &nbsp; 
<a class="summary-letter" href="#Commands-_0026-Options-Index_fn_symbol-3"><b>~</b></a>
 &nbsp; 
<br>
<a class="summary-letter" href="#Commands-_0026-Options-Index_fn_letter-A"><b>A</b></a>
 &nbsp; 
<a class="summary-letter" href="#Commands-_0026-Options-Index_fn_letter-B"><b>B</b></a>
 &nbsp; 
<a class="summary-letter" href="#Commands-_0026-Options-Index_fn_letter-C"><b>C</b></a>
 &nbsp; 
<a class="summary-letter" href="#Commands-_0026-Options-Index_fn_letter-D"><b>D</b></a>
 &nbsp; 
<a class="summary-letter" href="#Commands-_0026-Options-Index_fn_letter-E"><b>E</b></a>
 &nbsp; 
<a class="summary-letter" href="#Commands-_0026-Options-Index_fn_letter-F"><b>F</b></a>
 &nbsp; 
<a class="summary-letter" href="#Commands-_0026-Options-Index_fn_letter-G"><b>G</b></a>
 &nbsp; 
<a class="summary-letter" href="#Commands-_0026-Options-Index_fn_letter-H"><b>H</b></a>
 &nbsp; 
<a class="summary-letter" href="#Commands-_0026-Options-Index_fn_letter-I"><b>I</b></a>
 &nbsp; 
<a class="summary-letter" href="#Commands-_0026-Options-Index_fn_letter-J"><b>J</b></a>
 &nbsp; 
<a class="summary-letter" href="#Commands-_0026-Options-Index_fn_letter-L"><b>L</b></a>
 &nbsp; 
<a class="summary-letter" href="#Commands-_0026-Options-Index_fn_letter-M"><b>M</b></a>
 &nbsp; 
<a class="summary-letter" href="#Commands-_0026-Options-Index_fn_letter-N"><b>N</b></a>
 &nbsp; 
<a class="summary-letter" href="#Commands-_0026-Options-Index_fn_letter-O"><b>O</b></a>
 &nbsp; 
<a class="summary-letter" href="#Commands-_0026-Options-Index_fn_letter-P"><b>P</b></a>
 &nbsp; 
<a class="summary-letter" href="#Commands-_0026-Options-Index_fn_letter-Q"><b>Q</b></a>
 &nbsp; 
<a class="summary-letter" href="#Commands-_0026-Options-Index_fn_letter-R"><b>R</b></a>
 &nbsp; 
<a class="summary-letter" href="#Commands-_0026-Options-Index_fn_letter-S"><b>S</b></a>
 &nbsp; 
<a class="summary-letter" href="#Commands-_0026-Options-Index_fn_letter-T"><b>T</b></a>
 &nbsp; 
<a class="summary-letter" href="#Commands-_0026-Options-Index_fn_letter-U"><b>U</b></a>
 &nbsp; 
<a class="summary-letter" href="#Commands-_0026-Options-Index_fn_letter-V"><b>V</b></a>
 &nbsp; 
<a class="summary-letter" href="#Commands-_0026-Options-Index_fn_letter-X"><b>X</b></a>
 &nbsp; 
<a class="summary-letter" href="#Commands-_0026-Options-Index_fn_letter-Y"><b>Y</b></a>
 &nbsp; 
</td></tr></table>

<div class="footnote">
<hr>
<h4 class="footnotes-heading">Footnotes</h4>

<h3><a name="FOOT1" href="#DOCF1">(1)</a></h3>
<p>In some special
cases, it automatically balances this transaction for you.</p>
<h3><a name="FOOT2" href="#DOCF2">(2)</a></h3>
<p>This also means if you
misspell an account it will end up getting counted separately from
what you intended.  An Emacs major mode
<a href="https://github.com/ledger/ledger-mode/">ledger-mode</a> provides
tab completion for automatically filling in account names.</p>
<h3><a name="FOOT3" href="#DOCF3">(3)</a></h3>
<p>You
can track <em>anything</em>, even time or distance traveled.  As long as
it cannot be created or destroyed inside your accounting system.</p>
</div>
<hr>



</body>
</html>
